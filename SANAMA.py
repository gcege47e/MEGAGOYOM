from flask import Flask, request, jsonify, send_from_directory
import json
import os
import uuid
from datetime import datetime
import re

app = Flask(__name__)

# ุชูุธู ุฏุงุฑฺฉุชูุฑ ุจุฑุง ุฐุฎุฑู ุฏุงุฏูโูุง
DATA_DIR = 'data'
USERS_FILE = os.path.join(DATA_DIR, 'users.json')
LOCATIONS_FILE = os.path.join(DATA_DIR, 'locations.json')
COMMENTS_FILE = os.path.join(DATA_DIR, 'comments.json')
CHAT_FILE = os.path.join(DATA_DIR, 'chat.json')
NOTIFICATIONS_FILE = os.path.join(DATA_DIR, 'notifications.json')

# ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ ุงฺฏุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ
os.makedirs(DATA_DIR, exist_ok=True)
for file in [USERS_FILE, LOCATIONS_FILE, COMMENTS_FILE, CHAT_FILE, NOTIFICATIONS_FILE]:
    if not os.path.exists(file):
        with open(file, 'w', encoding='utf-8') as f:
            json.dump([], f, ensure_ascii=False, indent=4)

# ุฏุงุฑฺฉุชูุฑ ุจุฑุง ุฐุฎุฑู ุนฺฉุณโูุง
UPLOAD_FOLDER = 'uploads'
if not os.path.exists(UPLOAD_FOLDER):
    os.makedirs(UPLOAD_FOLDER)

app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER

# ูุณุช ุดูุฑูุง/ุดูุฑฺฉโูุง
CITIES = [
    "ุดูุฑฺฉ ุตุฏุฑุง", "ุดูุฑฺฉ ฺฏูุณุชุงู", "ูุนุงู ุขุจุงุฏ", "ุดูุฑฺฉ ฺฉุดู", "ุดูุฑฺฉ ููุฏู",
    "ุดูุฑฺฉ ุฒูุจู", "ุดูุฑฺฉ ุจุนุซุช", "ุดูุฑฺฉ ูุงููุฌุฑ", "ุดูุฑฺฉ ุตูุนุช ุนูู ุขุจุงุฏ",
    "ฺฉู ุงูุงู ุฑุถุง", "ุดูุฑฺฉ ฺฏูู", "ุดูุฑฺฉ ุจุฒู", "ุดูุฑฺฉ ุฑุญูุช ุขุจุงุฏ", "ุดูุฑฺฉ ุฎูุฑุดุฏ",
    "ุดูุฑฺฉ ุณูุงูุช", "ุดูุฑฺฉ ูุฑููฺฏุงู", "ฺฉู ุฒุงฺฏุฑุณ", "ฺฉู ูพุงุณุฏุงุฑุงู", "ุดูุฑฺฉ ุนุฑูุงู",
    "ุดูุฑฺฉ ููุฑุณุชุงู"
]

# ุฏุณุชูโุจูุฏโูุง ู ุฒุฑ ุฏุณุชูโูุง
CATEGORIES = {
    "๐ฝ๏ธ ุฎูุฑุงฺฉ ู ููุดุฏู": [
        "ุฑุณุชูุฑุงูโูุง (ุณูุชุ ูุณุช ููุฏุ ุจูโุงููููุ ุฏุฑุงุ ฺฏุงูุฎูุงุฑ)",
        "ฺฉุงูู ู ฺฉุงูโุดุงูพ (ฺฉุงููโุฑุณุชูุฑุงูุ ูููู ุชุฎุตุต)",
        "ุจุณุชูโูุฑูุด ู ุขุจูููโูุฑูุด (ุจุณุชู ุณูุชุ ุจุณุชู ุงุชุงูุง)",
        "ุดุฑูโูพุฒ ู ูุงููุง (ูุงููุง ุณูุชุ ุดุฑูโูพุฒ ููุงุฏ)",
        "ุณูุฑูโุฎุงูู ู ฺุงุฎุงูู (ูููู ุฎุงูู ุณูุชุ ฺุงุฎุงูู ูุฏุฑู)",
        "ููุฏฺฉูุฑุช ู ูุฑุงฺฉุฒ ุบุฐุงุฎูุฑ",
        "ฺฉุจุงุจ ู ุฌฺฏุฑฺฉ (ฺฉุจุงุจโูุฑูุดุ ุฌฺฏุฑฺฉุ ุฏุฒโุณุฑุง)",
        "ุณุงูุฏูฺโูุฑูุด ู ูพุชุฒุงูุฑูุด (ูพุชุฒุงูุฑูุดุ ุณุงูุฏูฺโูุฑูุด ูุญู)",
        "ููุงุฏ ู ุดฺฉูุงุชโูุฑูุด (ุดฺฉูุงุชโูุฑูุด ุชุฎุตุตุ ุขุจูุจุงุชโูุฑูุด)",
        "ุขุฌูโูุฑูุด ู ุฎุดฺฉุจุงุฑ (ุขุฌูโูุฑูุดุ ุฎุดฺฉุจุงุฑูุฑูุด)",
        "ุณููพุฑูุงุฑฺฉุช ูุญู ู ูุงูพุฑ",
        "ูุตุงุจ ู ูุฑุบ ูุฑูุด (ูุตุงุจุ ูุฑุบโูุฑูุดุ ูุงูโูุฑูุด)",
        "ูููโูุฑูุด ู ุชุฑูโุจุงุฑ (ูููโูุฑูุดุ ุณุจุฒโูุฑูุด)",
        "ูุงูโูุฑูุด ู ุบุฐุงูุง ุฏุฑุง",
        "ูุฑูุดฺฏุงู ููุงุฏ ุบุฐุง ูุญู",
        "ุนุณูโูุฑูุด ู ูุญุตููุงุช ุฒูุจูุฑุฏุงุฑ",
        "ูุญุตููุงุช ูุญู ู ููุทููโุง",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุงุฑฺฏุงูฺฉ",
        "ูุฑูุดฺฏุงู ููุงุฏ ุบุฐุง ููุฌูุฏ",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ูุจู ู ูพูุฑ",
        "ูุงูโูุฑูุด ุชุฎุตุต (ูุงู ุจุงฺฏุชุ ูุงู ุณูฺฏฺฉ)",
        "ุบุฐุงูุง ูุญู ู ุบุฐุงูุง ููู"
    ],
    "๐๏ธ ุฎุฑุฏ ู ูุฑูุด": [
        "ูพุงุณุงฺูุง ู ูุฑุงฺฉุฒ ุฎุฑุฏ (ูุงูุ ูุฑฺฉุฒ ุฎุฑุฏุ ุจุงุฒุงุฑฺู)",
        "ุณููพุฑูุงุฑฺฉุช ู ูุงูพุฑูุงุฑฺฉุช (ุฒูุฌุฑูโุงุ ูุญู)",
        "ูุฑูุดฺฏุงู ุฒูุฌุฑูโุง",
        "ุจุงุฒุงุฑ ุณูุช ู ุจุงุฒุงุฑฺูโูุง ูุญู (ุจุงุฒุงุฑ ุฑูุฒุ ุจุงุฒุงุฑ ููุชฺฏ)",
        "ูุฑูุดฺฏุงู ูพูุดุงฺฉ ู ฺฉู ู ฺฉูุด (ูุจุงุณ ูุฑุฏุงููุ ุฒูุงููุ ุจฺฺฏุงูู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุฎุงูฺฏ ู ุงูฺฉุชุฑููฺฉ (ููุงุฒู ุจุฑูุ ุฏุฌุชุงู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ูุฑุฒุด (ูุฑุฒุดุ ฺฉููููุฑุฏุ ุดูุง)",
        "ฺฉุชุงุจโูุฑูุด ู ููุงุฒู ุงูุชุญุฑุฑ (ฺฉุชุงุจโูุฑูุด ุนูููุ ุชุฎุตุต)",
        "ูุบุงุฒู ููุจุงู ู ููพโุชุงูพ (ูุฑูุดุ ุชุนูุฑุ ููุงุฒู ุฌุงูุจ)",
        "ฺฏูโูุฑูุด ู ฺฏุงูุงู ุขูพุงุฑุชูุงู (ฺฏูโูุฑูุดุ ฺฏูโุขุฑุง)",
        "ุนูฺฉโูุฑูุด ู ุงูพุชฺฉ (ุนูฺฉโูุฑูุดุ ุนูฺฉโุณุงุฒ)",
        "ุนุทุฑ ู ุงุฏฺฉูู ูุฑูุด (ุนุทุฑ ูุฑูุดุ ูุญุตููุงุช ุขุฑุงุด)",
        "ุทูุง ู ุฌูุงูุฑ ูุฑูุด (ุทูุงูุฑูุดุ ุฌูุงูุฑูุฑูุด)",
        "ุณุงุนุชโูุฑูุด (ุณุงุนุช ูฺุ ุฏูุงุฑ)",
        "ููุงุฒู ุขุฑุงุด ู ุจูุฏุงุดุช (ุขุฑุงุดุ ุจูุฏุงุดุชุ ูุฑุงูุจุช ูพูุณุช)",
        "ุงุณุจุงุจโุจุงุฒโูุฑูุด (ุงุณุจุงุจโุจุงุฒุ ุจุงุฒ ูฺฉุฑ)",
        "ุตูุงุนโุฏุณุช ู ุณูุบุงุชโูุฑูุด (ุตูุงุน ุฏุณุชุ ุณูุบุงุช)",
        "ุฏฺฉูุฑุงุณูู ู ููุงุฒู ููุฒู (ุฏฺฉูุฑุงุณููุ ููุงุฒู ุชุฒุฆู)",
        "ูุฑุด ู ฺฏูู ูุฑูุด (ูุฑุดโูุฑูุดุ ฺฏููโูุฑูุด)",
        "ูพุงุฑฺูโูุฑูุด ู ุฎุงุท (ูพุงุฑฺูโูุฑูุดุ ุฎุงุท)",
        "ฺุฑูโูุฑูุด ู ฺฉูโุณุงุฒ (ฺุฑูโูุฑูุดุ ฺฉูโุฏูุฒ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุขุดูพุฒุฎุงูู (ุธุฑููุ ููุงุฒู ุขุดูพุฒ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุจุงุบุจุงู (ููุงุฒู ุจุงุบุจุงูุ ููุงู)",
        "ูุฑูุดฺฏุงู ุญูุงูุงุช ุฎุงูฺฏ (ุญูุงูุงุชุ ุบุฐุง ุญูุงูุงุช)",
        "ูุฑูุดฺฏุงู ุฏูฺุฑุฎู ู ุงุณฺฉูุชุฑ (ุฏูฺุฑุฎูุ ุงุณฺฉูุชุฑุ ููุงุฒู)",
        "ูุฑูุดฺฏุงู ุงุจุฒุงุฑุขูุงุช (ุงุจุฒุงุฑ ุตูุนุชุ ุฏุณุช)",
        "ูุฑูุดฺฏุงู ฺฉุงููพูุชุฑ ู ฺฏู (ฺฉุงููพูุชุฑุ ฺฉูุณูู ุจุงุฒ)",
        "ูุฑูุดฺฏุงู ูุจุงุณ ุนุฑูุณ ู ูุฑุงุณู",
        "ูุฑูุดฺฏุงู ฺฉุงุฏู ู ูุฏู",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ูุฑููฺฏ (ุณ ุฏุ ุฏ ู ุฏุ ุขุซุงุฑ ููุฑ)",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุฏุณุชโุฏูู",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุณูุงูุช ู ุชูุฏุฑุณุช",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุฑูุณุชุง ู ูุญู"
    ],
    "โ๏ธ ุฒุจุง ู ุขุฑุงุด": [
        "ุขุฑุงุดฺฏุงู ูุฑุฏุงูู (ุขุฑุงุดฺฏุงูุ ุงุตูุงุญ)",
        "ุขุฑุงุดฺฏุงู ุฒูุงูู (ุขุฑุงุดุ ุฑูฺฏ ูู)",
        "ุณุงููโูุง ุฒุจุง ู ุงุณูพุง (ุงุณูพุงุ ูุงุณุงฺ)",
        "ูฺู ู ุงุจุฑู (ุงฺฉุณุชูุดู ูฺูุ ูฺฉุฑูุจูุฏูฺฏ)",
        "ูุงุฎูโฺฉุงุฑ (ูุงูฺฉูุฑุ ูพุฏฺฉูุฑุ ูุงุฎู ูุตููุน)",
        "ุชุชู ู ูฺฉุฑููพฺฏููุชุดู (ุชุงุชูุ ูฺฉุฑููพฺฏููุชุดู)",
        "ุณุงููโูุง ุชุงุชู ู ูพุฑุณูฺฏ (ูพุฑุณูฺฏุ ุชุงุชู ุญูุง)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพูุณุช ู ูู (ูพุงฺฉุณุงุฒ ูพูุณุชุ ูุฒุฑ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุขุฑุงุด ุญุฑููโุง",
        "ูุฑุงฺฉุฒ ูุงุณุงฺ ู ุฑูฺฉุณุดู (ูุงุณุงฺ ุฏุฑูุงูุ ุฑูฺฉุณุดู)",
        "ูุฑุงฺฉุฒ ุงูพูุงุณูู ู ูุฒุฑ",
        "ุณุงููโูุง ุจุฑูุฒู ฺฉุฑุฏู",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ุฒุจุง",
        "ุขููุฒุดฺฏุงูโูุง ุขุฑุงุดฺฏุฑ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุจูุฏุงุดุช ูุฑุฏุงูู"
    ],
    "๐ฅ ุฏุฑูุงู ู ุณูุงูุช": [
        "ุจูุงุฑุณุชุงู ู ูุฑุงฺฉุฒ ุฏุฑูุงู (ุนูููุ ุชุฎุตุตุ ุฎุตูุต)",
        "ุฏุฑูุงูฺฏุงู ู ฺฉููฺฉโูุง ุชุฎุตุต (ุฎุงููุงุฏูุ ุฒูุงูุ ููุจ)",
        "ุฏุงุฑูุฎุงูู (ุดุจุงููโุฑูุฒุ ฺฏุงู)",
        "ุฏูุฏุงูโูพุฒุดฺฉ ู ุงุฑุชูุฏูุณ (ุนูููุ ุชุฎุตุตุ ุฒุจุง)",
        "ุขุฒูุงุดฺฏุงู ูพุฒุดฺฉ ู ุฑุงุฏูููฺ (ุขุฒูุงุดฺฏุงูุ ุณูููฺฏุฑุงู)",
        "ฺฉููฺฉ ุฒุจุง ู ูุฒุฑ (ูุฒุฑุ ุจูุชุงฺฉุณุ ฺู)",
        "ูุฑุงฺฉุฒ ูุฒูุชุฑุงูพ ู ฺฉุงุฑุฏุฑูุงู (ูุฒูุชุฑุงูพุ ฺฉุงุฑุฏุฑูุงู)",
        "ุฏุงููพุฒุดฺฉ ู ฺฉููฺฉ ุญูุงูุงุช (ุฏุงููพุฒุดฺฉุ ุญูุงูุงุช ุฎุงูฺฏ)",
        "ูุฑุงฺฉุฒ ุชูุงูุจุฎุด (ุชูุงูุจุฎุดุ ฺฏูุชุงุฑุฏุฑูุงู)",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ู ุฑูุงูุดูุงุณ (ูุดุงูุฑูุ ุฑูุงูุดูุงุณ)",
        "ุดููุงโุณูุฌ ู ุณูุนฺฉ (ุณูุนฺฉุ ุดููุงโุณูุฌ)",
        "ุจูุงโุณูุฌ ู ุนูฺฉโุณุงุฒ (ุจูุงโุณูุฌุ ุนูฺฉโุณุงุฒ)",
        "ูพุฑุณุชุงุฑ ุฏุฑ ููุฒู (ูพุฑุณุชุงุฑุ ูพุฒุดฺฉ ุฏุฑ ููุฒู)",
        "ุชุฌูุฒุงุช ูพุฒุดฺฉ (ูุฑูุดุ ุงุฌุงุฑู)",
        "ูุฑุงฺฉุฒ ุงูุฏุง ุฎูู",
        "ูุฑุงฺฉุฒ ุทุจ ุณูุช ู ฺฏุงูุงู ุฏุงุฑู",
        "ูุฑุงฺฉุฒ ูุงุณุงฺ ุฏุฑูุงู",
        "ูุฑุงฺฉุฒ ุชุฑฺฉ ุงุนุชุงุฏ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฑุณุชุงุฑ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฒุดฺฉ ุณุงุฑ",
        "ูุฑุงฺฉุฒ ุชุตูุฑุจุฑุฏุงุฑ ูพุฒุดฺฉ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฒุดฺฉ ูุฑุฒุด"
    ],
    "โฝ ูุฑุฒุด ู ุณุฑฺฏุฑู": [
        "ุจุงุดฺฏุงู ูุฑุฒุด ู ุจุฏูุณุงุฒ (ุจุฏูุณุงุฒุ ฺฉุฑุงุณูุช)",
        "ุงุณุชุฎุฑ ู ูุฌููุนู ูุฑุฒุด (ุงุณุชุฎุฑุ ุณููุงุ ุฌฺฉูุฒ)",
        "ุณุงูู ููุชุณุงู ู ุจุณฺฉุชุจุงู (ููุชุณุงูุ ุจุณฺฉุชุจุงูุ ูุงูุจุงู)",
        "ุณููุง ู ุชุฆุงุชุฑ (ุณููุงุ ุชุฆุงุชุฑุ ููุงุด)",
        "ุดูุฑุจุงุฒ ู ูพุงุฑฺฉ ุจุงุฒ (ุดูุฑุจุงุฒุ ูพุงุฑฺฉ ุจุงุฒ)",
        "ุจูุงุฑุฏ ู ุจูููฺฏ (ุจูุงุฑุฏุ ุจูููฺฏุ ุฏุงุฑุช)",
        "ูุฑุงฺฉุฒ ุชูุฑุญ ุฎุงููุงุฏฺฏ (ุชูุฑุญุ ุจุงุฒ)",
        "ูุฑุงฺฉุฒ ูุฑููฺฏ ู ููุฑ (ูุฑููฺฏุ ููุฑ)",
        "ุณุงููโูุง ฺฉูุณุฑุช ู ููุงุด (ฺฉูุณุฑุชุ ููุงุด)",
        "ฺฏูโูุช ู ูุฑุงฺฉุฒ ุจุงุฒ (ฺฏูโูุชุ ุจุงุฒ ฺฉุงููพูุชุฑ)",
        "ุจุงุดฺฏุงู ุชุฑุงูุฏุงุฒ (ุชุฑุงูุฏุงุฒุ ฺฉูุงูโุงูุฏุงุฒ)",
        "ุจุงุดฺฏุงู ุณููุง ู ุฎุงูู ููู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุณู (ุขููุฒุด ููุณูุ ููุงุฒูุฏฺฏ)",
        "ฺฉุชุงุจุฎุงูู ุนููู (ุนูููุ ุชุฎุตุต)",
        "ูฺฏุงุฑุฎุงูู ู ููุงุดฺฏุงู ููุฑ (ูฺฏุงุฑุฎุงููุ ููุงุดฺฏุงู)",
        "ูุฑุงฺฉุฒ ุจุงุฒ ุงุชุงู ูุฑุงุฑ",
        "ูุฑุงฺฉุฒ ูพูุช ุจุงู ู ูุฒุฑุชฺฏ",
        "ุจุงุดฺฏุงูโูุง ุฑูุต ู ุจุงูู",
        "ูุฑุงฺฉุฒ ูฺฏุง ู ูุฏุชุดู",
        "ุจุงุดฺฏุงูโูุง ูุฑุฒุดโูุง ุฑุฒู",
        "ูุฑุงฺฉุฒ ุงุณฺฉุช ู ุฑููุฑ",
        "ุจุงุดฺฏุงูโูุง ุจูฺฉุณ ู ููุฑูุง ุฑุฒู ุชุฑฺฉุจ",
        "ูุฑุงฺฉุฒ ูุฑุฒุดโูุง ุขุจ",
        "ุจุงุดฺฏุงูโูุง ฺฏูู ู ุชูุณ",
        "ูุฑุงฺฉุฒ ูุงูฺฏุฑ ู ุดฺฉุงุฑ",
        "ุจุงุดฺฏุงูโูุง ุณูุงุฑฺฉุงุฑ"
    ],
    "๐จ ุงูุงูุช ู ุณูุฑ": [
        "ูุชู ู ูุชู ุขูพุงุฑุชูุงู (ูุชูุ ูุชู ุขูพุงุฑุชูุงู)",
        "ูุณุงูุฑุฎุงูู ู ูููุงููพุฐุฑ (ูุณุงูุฑุฎุงููุ ูููุงููพุฐุฑ)",
        "ุงูุงูุชฺฏุงู ุจููโฺฏุฑุฏ (ุจููโฺฏุฑุฏุ ุงูุงูุชฺฏุงู ูุญู)",
        "ููุง ู ุณูุฆุช ุงุฌุงุฑูโุง (ููุงุ ุณูุฆุช)",
        "ฺฉููพูฺฏ ู ุงุฑุฏูฺฏุงู (ฺฉููพูฺฏุ ุงุฑุฏูฺฏุงู)",
        "ุขฺุงูุณ ูุณุงูุฑุช ู ฺฏุฑุฏุดฺฏุฑ (ูุณุงูุฑุชุ ฺฏุฑุฏุดฺฏุฑ)",
        "ุงุณุชฺฏุงู ูุทุงุฑ ู ุงุชูุจูุณ (ูุทุงุฑุ ุงุชูุจูุณ)",
        "ูุฑูุฏฺฏุงู ู ูพุงุงูู ูุณุงูุฑ (ูุฑูุฏฺฏุงูุ ูพุงุงูู)",
        "ูุฑุงฺฉุฒ ุฑุฒุฑูุงุณูู (ุฑุฒุฑู ูุชูุ ุจูุท)",
        "ุฎุฏูุงุช ูุฒุง ู ูพุงุณูพูุฑุช (ูุฒุงุ ูพุงุณูพูุฑุช)",
        "ุงุฌุงุฑู ุฎูุฏุฑู ู ุฏูฺุฑุฎู (ุงุฌุงุฑู ูุงุดูุ ุฏูฺุฑุฎู)",
        "ุฑุงูููุงุงู ฺฏุฑุฏุดฺฏุฑ (ุชูุฑูุฏุฑุ ุฑุงูููุง)",
        "ูุฑุงฺฉุฒ ุงุทูุงุนุงุช ฺฏุฑุฏุดฺฏุฑ",
        "ุฎุฏูุงุช ุชุฑุฌูู ู ุฑุงูููุง ูุญู",
        "ูุฑุงฺฉุฒ ฺฉุฑุงู ุงุชููุจู",
        "ุฎุฏูุงุช ุงูุชูุงู ูุณุงูุฑ (ุญูู ู ูููุ ุชุฑุงูุณูุฑ)",
        "ูุฑุงฺฉุฒ ุฑุฒุฑูุงุณูู ุขููุงู",
        "ุฎุฏูุงุช ุจูู ูุณุงูุฑุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุฌูุงูฺฏุฑุฏ"
    ],
    "๐๏ธ ุฎุฏูุงุช ุนููู ู ุงุฏุงุฑ": [
        "ุจุงูฺฉ ู ุฎูุฏูพุฑุฏุงุฒ (ุจุงูฺฉุ ุตุฑุงู)",
        "ุงุฏุงุฑู ูพุณุช (ูพุณุชุ ูพฺฉ ููุชูุฑ)",
        "ุฏูุงุชุฑ ูพุดุฎูุงู ุฎุฏูุงุช ุฏููุช (ูพุดุฎูุงูุ ุฎุฏูุงุช ุงูฺฉุชุฑููฺฉ)",
        "ุดูุฑุฏุงุฑ ู ูุฑุงฺฉุฒ ุฎุฏูุงุช ุดูุฑ (ุดูุฑุฏุงุฑุ ุฎุฏูุงุช ุดูุฑ)",
        "ุงุฏุงุฑู ุจุฑูุ ุขุจุ ฺฏุงุฒ (ุจุฑูุ ุขุจุ ฺฏุงุฒ)",
        "ูพูุณ +ฑฐ ู ูุฑุงฺฉุฒ ุงูุชุธุงู (ูพูุณุ ุงูุชุธุงู)",
        "ุฏุงุฏฺฏุงู ู ูุฑุงุฌุน ูุถุง (ุฏุงุฏฺฏุงูุ ูุถุง)",
        "ฺฉูุงูุชุฑ ู ูพุงุณฺฏุงู (ฺฉูุงูุชุฑุ ูพุงุณฺฏุงู)",
        "ุฏูุงุชุฑ ุงุณูุงุฏ ุฑุณู (ุงุณูุงุฏ ุฑุณูุ ุฏูุชุฑุฎุงูู)",
        "ูุฑุงฺฉุฒ ุตุฏูุฑ ฺฏูุงููุงูู (ฺฏูุงููุงููุ ูุฏุงุฑฺฉ)",
        "ุงุฏุงุฑุงุช ุฏููุช ู ูุฒุงุฑุชุฎุงููโูุง (ุฏููุชุ ูุฒุงุฑุชุฎุงูู)",
        "ฺฉูุณููฺฏุฑ ู ุณูุงุฑุชุฎุงููโูุง (ุณูุงุฑุชุ ฺฉูุณููฺฏุฑ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงูฺฉุชุฑููฺฉ (ุฎุฏูุงุช ุขููุงูุ ุฏููุช ุงูฺฉุชุฑููฺฉ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุดุงูุฑู ุดุบู",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ูุณฺฉู ู ุงููุงฺฉ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุญููู ู ูุถุง",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ููุงุฌุฑุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุงู ู ุญุณุงุจุฏุงุฑ",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ุจููโุง",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชุนูุฑุงุช ุดูุฑ",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ูพูุงูฺฉุงุฑ"
    ],
    "๐ ุฎุฏูุงุช ุดูุฑ ู ุญููโูููู": [
        "ูพููพ ุจูุฒู ู CNG (ุจูุฒูุ ฺฏุงุฒ)",
        "ฺฉุงุฑูุงุด ู ุฎุฏูุงุช ุฎูุฏุฑู (ฺฉุงุฑูุงุดุ ุจุฑุงูโุณุงุฒ)",
        "ุชุนูุฑฺฏุงู ุฎูุฏุฑู ู ููุชูุฑุณฺฉูุช (ุชุนูุฑฺฏุงูุ ูฺฉุงูฺฉ)",
        "ุชุงฺฉุณโุณุฑูุณ ู ุชุงฺฉุณ ุงูุชุฑูุช (ุชุงฺฉุณุ ุงุณููพ)",
        "ูพุงุฑฺฉูฺฏ ุนููู (ูพุงุฑฺฉูฺฏุ ุฌุง ูพุงุฑฺฉ)",
        "ูฺฉุงูฺฉ ู ุจุฑู ุฎูุฏุฑู (ูฺฉุงูฺฉุ ุจุฑู ุฎูุฏุฑู)",
        "ูุงุณุชฺฉโูุฑูุด ู ูุฑูุด ููุงุฒู ุฏฺฉ (ูุงุณุชฺฉุ ููุงุฒู ุฏฺฉ)",
        "ุฎุฏูุงุช ููุงุด ู ุชุฑูู ุฎูุฏุฑู (ููุงุดุ ุชุฑูู)",
        "ูุฑุงฺฉุฒ ูุนุงูู ูู (ูุนุงูู ููุ ุชุณุช ุฎูุฏุฑู)",
        "ุฎุฏูุงุช ุงูุฏุงุฏ ุฎูุฏุฑู (ุฎุฏูุงุช ุงูุฏุงุฏุ ุฏฺฉโฺฉุด)",
        "ููุงูุฏฺฏ ุฎูุฏุฑู (ููุงูุฏฺฏุ ูุฑูุด ุฎูุฏุฑู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุฌุงูุจ ุฎูุฏุฑู (ููุงุฒู ุฌุงูุจุ ุชุฒุฆูุงุช)",
        "ุฎุฏูุงุช ุชูุธู ููุชูุฑ ู ุงูฺฺฉุชูุฑ",
        "ุฎุฏูุงุช ุตุงูฺฉุงุฑ ู ุฌููุจูุฏ",
        "ุฎุฏูุงุช ุชุนูุถ ุฑูุบู ู ููุชุฑ",
        "ุฎุฏูุงุช ุณุณุชู ุชููู ู ฺฉููุฑ",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุชุฎุตุต ุฎูุฏุฑู",
        "ุฎุฏูุงุช ฺฉุงุฑุชโุฎูุงู ู ูพุฑุฏุงุฎุช",
        "ุฎุฏูุงุช ูพุฎุด ูุญุตููุงุช ุฎูุฏุฑู",
        "ุฎุฏูุงุช ุญูู ู ููู ูุนูููู ู ุณุงูููุฏุงู"
    ],
    "๐ ุขููุฒุด ู ูุฑููฺฏ": [
        "ูุฏุฑุณู ู ุขููุฒุดฺฏุงู (ุฏุจุณุชุงูุ ุฏุจุฑุณุชุงู)",
        "ุฏุงูุดฺฏุงู ู ูุฑุงฺฉุฒ ุขููุฒุด ุนุงู (ุฏุงูุดฺฏุงูุ ููุณุณู ุขููุฒุด ุนุงู)",
        "ุขููุฒุดฺฏุงู ุฒุจุงู (ุฒุจุงู ุงูฺฏูุณุ ุณุงุฑ ุฒุจุงูโูุง)",
        "ุขููุฒุดฺฏุงู ููโูุญุฑููโุง (ููุ ุญุฑููโุง)",
        "ฺฉุชุงุจุฎุงูู ุนููู (ุนูููุ ุชุฎุตุต)",
        "ูุฑููฺฏุณุฑุง ู ุฎุงูู ูุฑููฺฏ (ูุฑููฺฏุณุฑุงุ ุฎุงูู ูุฑููฺฏ)",
        "ููุฒู ู ฺฏุงูุฑ (ููุฒูุ ฺฏุงูุฑ ููุฑ)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ฺฉุงููพูุชุฑ (ฺฉุงููพูุชุฑุ ุจุฑูุงููโููุณ)",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ุชุญุตู (ูุดุงูุฑูุ ุงูุชุฎุงุจ ุฑุดุชู)",
        "ุขููุฒุดฺฏุงูโูุง ููุฑ (ููุงุดุ ูุฌุณููโุณุงุฒ)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุฑุงููุฏฺฏ (ุขููุฒุด ุฑุงููุฏฺฏุ ุขูโูุงูู)",
        "ููุฏฺฉูุฏฺฉ ู ูพุดโุฏุจุณุชุงู (ููุฏฺฉูุฏฺฉุ ูพุดโุฏุจุณุชุงู)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุนููู ูุฎุชูู (ุฑุงุถุ ูุฒฺฉุ ุดู)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุงุฑุชโูุง ุฒูุฏฺฏ",
        "ุขููุฒุดฺฏุงูโูุง ุขุดูพุฒ ู ุดุฑูโูพุฒ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุฎูุงูุช ฺฉูุฏฺฉุงู",
        "ุขููุฒุดฺฏุงูโูุง ฺฉูฺฉูุฑ ู ุขุฒููู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุงุฒ ุฑุงู ุฏูุฑ",
        "ุขููุฒุดฺฏุงูโูุง ููุงุฑุชโุขููุฒ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุตูุงุน ุฏุณุช",
        "ุขููุฒุดฺฏุงูโูุง ุฎุงุท ู ุทุฑุงุญ ูุจุงุณ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุนฺฉุงุณ ู ูููุจุฑุฏุงุฑ",
        "ุขููุฒุดฺฏุงูโูุง ูุฑุฒุด ุชุฎุตุต",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุณู ูุญู",
        "ุขููุฒุดฺฏุงูโูุง ุฒุจุงู ุงุดุงุฑู",
        "ุฎุฏูุงุช ุขููุฒุด ูุฌุงุฒ ู ุขููุงู"
    ],
    "๐ ูุฐูุจ ู ูุนูู": [
        "ูุณุฌุฏ ู ูุตู (ูุณุฌุฏุ ูุตู)",
        "ุญุณูู ู ูุฆุช (ุญุณููุ ูุฆุช)",
        "ฺฉูุณุง ู ูุฑุงฺฉุฒ ูุณุญ (ฺฉูุณุงุ ูุฑุงฺฉุฒ ูุณุญ)",
        "ฺฉูุณู ู ูุฑุงฺฉุฒ ููุฏ (ฺฉูุณูุ ูุฑุงฺฉุฒ ููุฏ)",
        "ูุนุงุจุฏ ู ูพุฑุณุชุดฺฏุงูโูุง (ูุนุจุฏุ ูพุฑุณุชุดฺฏุงู)",
        "ูุฑุงฺฉุฒ ุนุฑูุงู ู ูุนูู (ุนุฑูุงูุ ูุนูู)",
        "ฺฉุชุงุจูุฑูุดโูุง ูุฐูุจ (ฺฉุชุงุจ ูุฐูุจุ ูุฑู ุงูุฒุงุฑ ูุฐูุจ)",
        "ูุฑุงฺฉุฒ ุฎุฑู ู ูฺฉูฺฉุงุฑ (ุฎุฑูุ ูฺฉูฺฉุงุฑ)",
        "ุงูุชุดุงุฑุงุช ูุฐูุจ (ุงูุชุดุงุฑุงุชุ ฺุงูพ ูุฐูุจ)",
        "ูุฑุงฺฉุฒ ุญูุธ ูุฑุขู ู ูุนุงุฑู ุงุณูุงู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุญุฌ ู ุฒุงุฑุช",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ูุฐูุจ ู ุฏู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุงุญฺฉุงู ู ูุนุงุฑู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงููุงู ู ุงููุฑ ุฎุฑู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุฐูุจ ุณุงุฑ",
        "ูุฑุงฺฉุฒ ุจุฑฺฏุฒุงุฑ ูุฑุงุณู ูุฐูุจ"
    ],
    "๐ณ ุทุจุนุช ู ุชูุฑุญ ุขุฒุงุฏ": [
        "ูพุงุฑฺฉ ู ุจูุณุชุงู (ูพุงุฑฺฉ ุนูููุ ุจูุณุชุงู)",
        "ุจุงุบ ูุญุด ู ุขฺฉูุงุฑูู (ุจุงุบ ูุญุดุ ุขฺฉูุงุฑูู)",
        "ุจุงุบ ฺฏุงูโุดูุงุณ (ฺฏุงูโุดูุงุณุ ฺฏูุฎุงูู)",
        "ูพุณุช ุฏูฺุฑุฎูโุณูุงุฑ (ุฏูฺุฑุฎูโุณูุงุฑุ ุฏูฺุฑุฎู ุณูุงุฑ ุขูุฑูุฏ)",
        "ฺฉููุณุชุงู ู ูุณุฑูุง ุทุจุนุชโฺฏุฑุฏ (ฺฉููููุฑุฏุ ุทุจุนุชโฺฏุฑุฏ)",
        "ุณุงุญู ู ุฏุฑุงฺู (ุณุงุญูุ ุฏุฑุงฺู)",
        "ุขุจุดุงุฑ ู ฺุดูู (ุขุจุดุงุฑุ ฺุดูู)",
        "ุฌูฺฏู ู ููุทูู ุญูุงุธุช ุดุฏู (ุฌูฺฏูุ ููุทูู ุญูุงุธุช ุดุฏู)",
        "ฺฉููพูฺฏ ู ูพฺฉูฺฉ (ฺฉููพูฺฏุ ูพฺฉูฺฉ)",
        "ูุฑุงฺฉุฒ ุงฺฉูุชูุฑุณู (ุงฺฉูุชูุฑุณูุ ฺฏุฑุฏุดฺฏุฑ ุทุจุนุช)",
        "ูพุณุช ุงุณฺฉ ู ูุฑุฒุดโูุง ุฒูุณุชุงู (ุงุณฺฉุ ูุฑุฒุด ุฒูุณุชุงู)",
        "ุณุงููโูุง ุจููุฏุฑูฺฏ ู ุตุฎุฑูโููุฑุฏ (ุตุฎุฑูโููุฑุฏุ ุจููุฏุฑูฺฏ)",
        "ูุฑุงฺฉุฒ ูุงูฺฏุฑ ู ูุงูโุฑุงู",
        "ูพุงุฑฺฉโูุง ุขุจ ู ุงุณุชุฎุฑูุง ุฑูุจุงุฒ",
        "ูุฑุงฺฉุฒ ูพุฑูุฏูโูฺฏุฑ ู ุญุงุช ูุญุด",
        "ูุณุฑูุง ูพุงุฏูโุฑู ู ฺฉูููพูุง",
        "ูุฑุงฺฉุฒ ฺุงุฏุฑุฒู ู ฺฉุงุฑูุงููฺฏ",
        "ูพุงุฑฺฉโูุง ูู ู ููุงุทู ฺฏุฑุฏุดฺฏุฑ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุทุจุนุชโฺฏุฑุฏ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชูุฑูุง ุทุจุนุช"
    ],
    "๐ผ ฺฉุณุจโูฺฉุงุฑ ู ุญุฑููโุง": [
        "ุฏูุชุฑ ฺฉุงุฑ ู ุดุฑฺฉุชโูุง (ุฏูุชุฑุ ุดุฑฺฉุช)",
        "ฺฉุงุฑุฎุงููโูุง ู ูุงุญุฏูุง ุชููุฏ (ฺฉุงุฑุฎุงููุ ุชููุฏ)",
        "ฺฉุงุฑฺฏุงูโูุง ุตูุนุช (ฺฉุงุฑฺฏุงูุ ุตูุนุช)",
        "ุฏูุงุชุฑ ุงููุงฺฉ ู ูุดุงูุฑู ุงููุงฺฉ (ุงููุงฺฉุ ูุดุงูุฑ ุงููุงฺฉ)",
        "ุฏูุงุชุฑ ุจูู (ุจููุ ุฎุฏูุงุช ุจููโุง)",
        "ุดุฑฺฉุชโูุง ุชุจูุบุงุช ู ุจุงุฒุงุฑุงุจ (ุชุจูุบุงุชุ ุจุงุฒุงุฑุงุจ)",
        "ูุฑุงฺฉุฒ ุทุฑุงุญ ู ฺุงูพ (ุทุฑุงุญุ ฺุงูพ)",
        "ุดุฑฺฉุชโูุง ูุนูุงุฑ ู ุนูุฑุงู (ูุนูุงุฑุ ุนูุฑุงู)",
        "ุฏูุงุชุฑ ุญููู ู ูฺฉุงูุช (ุญูููุ ูฺฉุงูุช)",
        "ุดุฑฺฉุชโูุง ูุดุงูุฑู ูุฏุฑุช (ูุดุงูุฑูุ ูุฏุฑุช)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุงู ู ุญุณุงุจุฏุงุฑ (ูุงูุ ุญุณุงุจุฏุงุฑ)",
        "ุดุฑฺฉุชโูุง ููุงูุฑ ุงุทูุงุนุงุช (ููุงูุฑ ุงุทูุงุนุงุชุ ูุฑูโุงูุฒุงุฑ)",
        "ุงุณุชูุฏููุง ุนฺฉุงุณ ู ูููุจุฑุฏุงุฑ (ุนฺฉุงุณุ ูููุจุฑุฏุงุฑ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงุฏุงุฑ ู ฺฉูพ (ุฎุฏูุงุช ุงุฏุงุฑุ ฺฉูพ)",
        "ุดุฑฺฉุชโูุง ุญูู ู ููู ู ุจุงุฑุจุฑ (ุญูู ูููุ ุจุงุฑุจุฑ)",
        "ุฎุฏูุงุช ูุธุงูุช ู ูฺฏูุฏุงุฑ (ูุธุงูุชุ ูฺฏูุฏุงุฑ)",
        "ุดุฑฺฉุชโูุง ุฑุณุงููโุง ู ุงูุชุดุงุฑุงุช",
        "ูุฑุงฺฉุฒ ุชุญููุงุช ู ุชูุณุนู",
        "ุดุฑฺฉุชโูุง ูุดุงูุฑู ููุงุจุน ุงูุณุงู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุดุงูุฑู ฺฉุณุจโูฺฉุงุฑ",
        "ุดุฑฺฉุชโูุง ุทุฑุงุญ ุณุงุช ู ุจูููโุณุงุฒ ููุชูุฑ ุฌุณุชุฌู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชุฑุฌูู ู ูุชุฑุฌู",
        "ุดุฑฺฉุชโูุง ุฎุฏูุงุช ุงููุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุดุชุจุงู ููุงูุฑ ุงุทูุงุนุงุช",
        "ุดุฑฺฉุชโูุง ุฎุฏูุงุช ูุดุงูุฑู ูุงูุงุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุจุฑูุฏูฺฏ ู ููุช ุณุงุฒ",
        "ุฎุฏูุงุช ูุดุงูุฑู ุงูุฑฺ ู ุจูููโุณุงุฒ"
    ],
    "๐งฐ ุฎุฏูุงุช ุชุฎุตุต ู ูู": [
        "ุชุนูุฑฺฏุงู ููุงุฒู ุฎุงูฺฏ (ุชุนูุฑ ููุงุฒูุ ุณุฑูุณ)",
        "ุชุนูุฑฺฏุงู ููุจุงู ู ฺฉุงููพูุชุฑ (ุชุนูุฑ ููุจุงูุ ฺฉุงููพูุชุฑ)",
        "ุฎุฏูุงุช ุจุฑู ุณุงุฎุชูุงู (ุจุฑูโฺฉุงุฑุ ุณูโฺฉุด)",
        "ุฎุฏูุงุช ููููโฺฉุด ู ุชุงุณุณุงุช (ููููโฺฉุดุ ุชุงุณุณุงุช)",
        "ุฎุฏูุงุช ฺฏุงุฒฺฉุด ู ุชุนูุฑุงุช ฺฏุงุฒ (ฺฏุงุฒฺฉุดุ ุชุนูุฑ ฺฏุงุฒ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุจุฑู (ุชุนูุฑ ููุงุฒู ุจุฑูุ ููุงุฒู ุฎุงูฺฏ)",
        "ุฎุฏูุงุช ฺฉููุฑ ู ุณุณุชูโูุง ุณุฑูุงุด (ฺฉููุฑุ ุณุฑูุงุด)",
        "ุฎุฏูุงุช ฺฏุฑูุงุด ู ูพฺฉุฌ (ฺฏุฑูุงุดุ ูพฺฉุฌ)",
        "ุฎุฏูุงุช ุขูุชู ู ุชููุฒูู (ุขูุชูุ ุชููุฒูู)",
        "ุฎุฏูุงุช ุงูุชุฑูุช ู ุดุจฺฉู (ุงูุชุฑูุชุ ุดุจฺฉู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุจุงู ู ุชุจูุช (ุชุนูุฑ ููุจุงูุ ุชุจูุช)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููพโุชุงูพ ู ฺฉุงููพูุชุฑ (ุชุนูุฑ ููพโุชุงูพุ ฺฉุงููพูุชุฑ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ฺฉูุณูู ุจุงุฒ (ุชุนูุฑ ฺฉูุณููุ ุจุงุฒ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุณุงุนุช ู ุฌูุงูุฑ (ุชุนูุฑ ุณุงุนุชุ ุฌูุงูุฑ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุตูุช ู ุชุตูุฑ (ุตูุชุ ุชุตูุฑ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุฎุงูฺฏ ุจุฒุฑฺฏ (ุฎฺุงูุ ูุจุงุณโุดู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุฎุงูฺฏ ฺฉูฺฺฉ (ูุงฺฉุฑูููุ ููููโุณุงุฒ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ูุฌุงุฑ ู ฺูุจ (ูุฌุงุฑุ ฺูุจ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุณูุงูู ู ุณุฑุงูฺฉ (ุณูุงูุ ุณุฑุงูฺฉ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ููุฒ ู ุขูู (ููุฒุ ุขูู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ูพูุงุณุชฺฉ (ูพูุงุณุชฺฉุ ุชุนูุฑ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ฺฉูุด ู ฺุฑู (ฺฉูุดุ ฺุฑู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ูุณุงุฌ ู ูพุงุฑฺู (ูุณุงุฌุ ูพุงุฑฺู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุขุดูพุฒุฎุงูู (ุขุดูพุฒุฎุงููุ ุชุนูุฑ)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุชุนูุฑุงุช (ุชุนูุฑุงุชุ ุฎุฏูุงุช)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุฎุฏูุงุช (ุฎุฏูุงุชุ ุชุนูุฑุงุช)"
    ],
    "๐ ุฎุฏูุงุช ุฎุงูฺฏ ู ุณุงุฎุชูุงู": [
        "ุฎุฏูุงุช ูุฌุงุฑ ู ฺูุจโฺฉุงุฑ (ูุฌุงุฑุ ฺูุจโฺฉุงุฑ)",
        "ุฎุฏูุงุช ุขููฺฏุฑ ู ุฌูุดฺฉุงุฑ (ุขููฺฏุฑุ ุฌูุดฺฉุงุฑ)",
        "ุฎุฏูุงุช ฺฉูุฏุณุงุฒ ู ูููโุณุงุฒ (ฺฉูุฏุณุงุฒุ ูููโุณุงุฒ)",
        "ุฎุฏูุงุช ุดุดูโุจุฑ ู ุขููโฺฉุงุฑ (ุดุดูโุจุฑุ ุขููโฺฉุงุฑ)",
        "ุฎุฏูุงุช ูุฑุด ุดู ู ูุจู ุดู (ูุฑุดโุดูุ ูุจูโุดู)",
        "ุฎุฏูุงุช ูุธุงูุช ููุฒู ู ุงุฏุงุฑู (ูุธุงูุชุ ุฎุฏูุงุช ูุธุงูุช)",
        "ุฎุฏูุงุช ุจุงุบุจุงู ู ูุถุง ุณุจุฒ (ุจุงุบุจุงูุ ูุถุง ุณุจุฒ)",
        "ุฎุฏูุงุช ุญุดุฑูโฺฉุด ู ุถุฏุนููู (ุถุฏุนูููุ ุณููพุงุด)",
        "ุฎุฏูุงุช ุงููุช ู ูฺฏูุจุงู (ุงููุชุ ูฺฏูุจุงู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุงูฺฉุชุฑููฺฉ",
        "ุฎุฏูุงุช ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ุชุฌูุฒุงุช",
        "ุฎุฏูุงุช ุณูโฺฉุด ุดุจฺฉู ู ุงูุชุฑูุช",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุตูุนุช ู ูุงุดูโุขูุงุช",
        "ุฎุฏูุงุช ูุตุจ ุฏูุฑุจู ู ุณุณุชูโูุง ุญูุงุธุช",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุขุดูพุฒุฎุงูู",
        "ุฎุฏูุงุช ูุตุจ ฺฉููพูุด ู ุณูู ฺฉุงุฐุจ",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุงุจุฒุงุฑุขูุงุช ุฏูู",
        "ุฎุฏูุงุช ูุตุจ ุขุณุงูุณูุฑ ู ูพูู ุจุฑู",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุณุณุชูโูุง ุณุฑูุงุด ู ฺฏุฑูุงุด",
        "ุฎุฏูุงุช ูุตุจ ุณุณุชูโูุง ุงุนูุงู ุญุฑู",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุงุฏูุงุช ููุณู",
        "ุฎุฏูุงุช ูุตุจ ุฏุด ู ุณุณุชูโูุง ูุงููุงุฑูโุง",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ูพุฒุดฺฉ",
        "ุฎุฏูุงุช ูุตุจ ุณุณุชูโูุง ููุดููุฏ ุณุงุฎุชูุงู",
        "ุฎุฏูุงุช ุจุงุฒุงูุช ู ูุญุท ุฒุณุช",
        "ุฎุฏูุงุช ุงุฌุงุฑู ุชุฌูุฒุงุช ู ููุงุฒู (ูุงููุฏ ุงุฌุงุฑู ฺุงุฏุฑุ ูุจุงุณ ูุฑุงุณูุ ุชุฌูุฒุงุช ูู)"
    ]
}

# HTML template for custom alert
CUSTOM_ALERT_HTML = """
<div id="customAlert" class="custom-alert">
    <div class="alert-content">
        <div class="alert-header">
            <span class="alert-title" id="alertTitle"></span>
            <span class="alert-close" onclick="hideCustomAlert()">&times;</span>
        </div>
        <div class="alert-body" id="alertMessage"></div>
        <div class="alert-footer">
            <button class="alert-btn" onclick="hideCustomAlert()">ุชุงุฏ</button>
        </div>
    </div>
</div>
"""

# HTML template for registration page (updated with custom alert)
REGISTER_HTML = """<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุซุจุช ูุงู ุฏุฑ ฺฏูู ููุง</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');
        :root {
            --primary: #006769;
            --secondary: #40A578;
            --success: #4caf50;
            --error: #f44336;
            --background: #f8f9fa;
            --text: #333;
            --light: #fff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background-color: var(--light);
            border-radius: 20px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 500px;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }
        .header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        .form-container {
            padding: 30px;
        }
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }
        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 103, 105, 0.2);
            outline: none;
        }
        .form-control.error {
            border-color: var(--error);
        }
        .error-message {
            color: var(--error);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .show-password {
            position: absolute;
            left: 15px;
            top: 40px;
            cursor: pointer;
            color: #777;
        }
        .btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .btn:active {
            transform: translateY(0);
        }
        .register-link {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }
        .register-link a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 576px) {
            .container {
                border-radius: 10px;
            }
            .header {
                padding: 20px;
            }
            .form-container {
                padding: 20px;
            }
        }
        /* Custom Alert Styles */
        .custom-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .alert-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .alert-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .alert-title {
            font-size: 18px;
            font-weight: 500;
        }
        .alert-close {
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: white;
        }
        .alert-body {
            padding: 20px;
            text-align: center;
            font-size: 16px;
            color: var(--text);
        }
        .alert-footer {
            padding: 20px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        .alert-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        /* Success Checkmark */
        .success-checkmark {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            stroke-width: 2;
            stroke: #4caf50;
            stroke-miterlimit: 10;
            box-shadow: inset 0px 0px 0px #4caf50;
            animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
            position: relative;
            top: 5px;
            right: 5px;
            margin: 0 auto;
        }
        .checkmark-circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 2;
            stroke-miterlimit: 10;
            stroke: #4caf50;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }
        .checkmark-check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }
        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }
        @keyframes scale {
            0%, 100% {
                transform: none;
            }
            50% {
                transform: scale3d(1.1, 1.1, 1);
            }
        }
        @keyframes fill {
            100% {
                box-shadow: inset 0px 0px 0px 30px #4caf50;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ุซุจุช ูุงู ุฏุฑ ฺฏูู ููุง</h1>
            <p>ุญุณุงุจ ฺฉุงุฑุจุฑ ุฌุฏุฏ ุจุณุงุฒุฏ</p>
        </div>
        <div class="form-container">
            <form id="registrationForm">
                <div class="form-group">
                    <label for="fullname">ูุงู ฺฉุงุฑุจุฑ</label>
                    <input type="text" id="fullname" class="form-control" placeholder="ูุงู ฺฉุงุฑุจุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                    <div class="error-message" id="fullname-error">ูุทูุงู ูุงู ฺฉุงุฑุจุฑ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ (ูุจุงุฏ ุชฺฉุฑุงุฑ ุจุงุดุฏ)</div>
                </div>
                <div class="form-group">
                    <label for="city">ุดูุฑ</label>
                    <select id="city" class="form-control">
                        <option value="">ูุทูุงู ุดูุฑ ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                        {% for city in cities %}
                        <option value="{{ city }}">{{ city }}</option>
                        {% endfor %}
                    </select>
                    <div class="error-message" id="city-error">ูุทูุงู ุดูุฑ ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</div>
                </div>
                <div class="form-group">
                    <label for="phone">ุชููู ููุฑุงู</label>
                    <input type="tel" id="phone" class="form-control" placeholder="09xxxxxxxxx">
                    <div class="error-message" id="phone-error">ูุทูุงู ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ</div>
                </div>
                <div class="form-group">
                    <label for="password">ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" id="password" class="form-control" placeholder="ุฑูุฒ ุนุจูุฑ ูู ุงูุชุฎุงุจ ฺฉูุฏ">
                    <span class="show-password" id="togglePassword">ููุงุด</span>
                    <div class="error-message" id="password-error">ุฑูุฒ ุนุจูุฑ ุจุงุฏ ุญุฏุงูู ถ ฺฉุงุฑุงฺฉุชุฑ ุฏุงุดุชู ุจุงุดุฏ</div>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" id="confirmPassword" class="form-control" placeholder="ุฑูุฒ ุนุจูุฑ ุฑุง ุชฺฉุฑุงุฑ ฺฉูุฏ">
                    <div class="error-message" id="confirmPassword-error">ุฑูุฒูุง ุนุจูุฑ ูุทุงุจูุช ูุฏุงุฑูุฏ</div>
                </div>
                <button type="submit" class="btn">ุซุจุช ูุงู</button>
                <div class="register-link">ูุจูุงู ุญุณุงุจ ุฏุงุฑุฏุ <a href="/login">ูุงุฑุฏ ุดูุฏ</a></div>
            </form>
        </div>
    </div>
""" + CUSTOM_ALERT_HTML + """
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registrationForm');
            const togglePassword = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            
            // ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑ
            togglePassword.addEventListener('click', function() {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePassword.textContent = 'ูพููุงู';
                } else {
                    passwordInput.type = 'password';
                    togglePassword.textContent = 'ููุงุด';
                }
            });
            
            // ุงุนุชุจุงุฑุณูุฌ ูุฑู
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                let isValid = true;
                
                // ุงุนุชุจุงุฑุณูุฌ ูุงู ฺฉุงุฑุจุฑ
                const fullname = document.getElementById('fullname');
                const fullnameError = document.getElementById('fullname-error');
                if (fullname.value.trim() === '' || fullname.value.length < 3) {
                    fullname.classList.add('error');
                    fullnameError.style.display = 'block';
                    isValid = false;
                } else {
                    fullname.classList.remove('error');
                    fullnameError.style.display = 'none';
                }
                
                // ุงุนุชุจุงุฑุณูุฌ ุดูุฑ
                const city = document.getElementById('city');
                const cityError = document.getElementById('city-error');
                if (city.value === '') {
                    city.classList.add('error');
                    cityError.style.display = 'block';
                    isValid = false;
                } else {
                    city.classList.remove('error');
                    cityError.style.display = 'none';
                }
                
                // ุงุนุชุจุงุฑุณูุฌ ุชููู
                const phone = document.getElementById('phone');
                const phoneError = document.getElementById('phone-error');
                const phoneRegex = /^09\d{9}$/;
                if (!phoneRegex.test(phone.value)) {
                    phone.classList.add('error');
                    phoneError.style.display = 'block';
                    isValid = false;
                } else {
                    phone.classList.remove('error');
                    phoneError.style.display = 'none';
                }
                
                // ุงุนุชุจุงุฑุณูุฌ ุฑูุฒ ุนุจูุฑ
                const password = document.getElementById('password');
                const passwordError = document.getElementById('password-error');
                if (password.value.length < 6) {
                    password.classList.add('error');
                    passwordError.style.display = 'block';
                    isValid = false;
                } else {
                    password.classList.remove('error');
                    passwordError.style.display = 'none';
                }
                
                // ุงุนุชุจุงุฑุณูุฌ ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ
                const confirmPassword = document.getElementById('confirmPassword');
                const confirmPasswordError = document.getElementById('confirmPassword-error');
                if (confirmPassword.value !== password.value) {
                    confirmPassword.classList.add('error');
                    confirmPasswordError.style.display = 'block';
                    isValid = false;
                } else {
                    confirmPassword.classList.remove('error');
                    confirmPasswordError.style.display = 'none';
                }
                
                // ุงฺฏุฑ ูุฑู ูุนุชุจุฑ ุงุณุชุ ุงุฑุณุงู ุดูุฏ
                if (isValid) {
                    // ุงุฌุงุฏ ุดุก ุฏุงุฏูโูุง
                    const formData = {
                        username: fullname.value,
                        city: city.value,
                        phone: phone.value,
                        password: password.value,
                        timestamp: new Date().toISOString()
                    };
                    
                    // ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุจู ุณุฑูุฑ
                    fetch('/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // ููุงุด ุงููุดู ููููุช
                            document.querySelector('.form-container').innerHTML = `
                                <div class="success-checkmark">
                                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                                        <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                                        <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                                    </svg>
                                </div>
                                <h2 style="text-align: center; color: #4caf50;">ุซุจุช ูุงู ุจุง ููููุช ุงูุฌุงู ุดุฏ!</h2>
                                <p style="text-align: center; margin-top: 20px;">ุฏุฑ ุญุงู ุงูุชูุงู ุจู ุตูุญู ุงุตู...</p>
                            `;
                            
                            // ุงูุชูุงู ุจู ุตูุญู ุงุตู ูพุณ ุงุฒ 3 ุซุงูู
                            setTimeout(() => {
                                window.location.href = '/main?username=' + encodeURIComponent(data.user.username);
                            }, 3000);
                        } else {
                            if (data.message.includes('ุชฺฉุฑุงุฑ')) {
                                fullname.classList.add('error');
                                fullnameError.textContent = data.message;
                                fullnameError.style.display = 'block';
                            } else {
                                showCustomAlert('ุฎุทุง', 'ุฎุทุง ุฏุฑ ุซุจุช ูุงู: ' + data.message, 'hideCustomAlert()');
                            }
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showCustomAlert('ุฎุทุง', 'ุฎุทุง ุฏุฑ ุงุฑุณุงู ุงุทูุงุนุงุช', 'hideCustomAlert()');
                    });
                }
            });
            
            // ุงุนุชุจุงุฑุณูุฌ ุฏุฑ ุญู ุชุงูพ
            const inputs = form.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.classList.remove('error');
                    const errorElement = document.getElementById(this.id + '-error');
                    if (errorElement) {
                        errorElement.style.display = 'none';
                    }
                });
            });
        });
        
        // ููุงุด ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function showCustomAlert(title, message, callback) {
            document.getElementById('alertTitle').textContent = title;
            document.getElementById('alertMessage').textContent = message;
            document.getElementById('customAlert').style.display = 'flex';
            
            // ุชูุธู ฺฉุงูโุจฺฉ ุจุฑุง ุฏฺฉูู ุชุงุฏ
            document.querySelector('.alert-btn').onclick = function() {
                hideCustomAlert();
                if (callback && typeof callback === 'string') {
                    eval(callback);
                } else if (callback && typeof callback === 'function') {
                    callback();
                }
            };
        }
        
        // ูุฎู ฺฉุฑุฏู ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function hideCustomAlert() {
            document.getElementById('customAlert').style.display = 'none';
        }
    </script>
</body>
</html>"""

# HTML template for login page (updated with custom alert)
LOGIN_HTML = """<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑูุฏ ุจู ฺฏูู ููุง</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');
        :root {
            --primary: #006769;
            --secondary: #40A578;
            --success: #4caf50;
            --error: #f44336;
            --background: #f8f9fa;
            --text: #333;
            --light: #fff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background-color: var(--light);
            border-radius: 20px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 500px;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }
        .header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        .form-container {
            padding: 30px;
        }
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }
        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 103, 105, 0.2);
            outline: none;
        }
        .form-control.error {
            border-color: var(--error);
        }
        .error-message {
            color: var(--error);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .show-password {
            position: absolute;
            left: 15px;
            top: 40px;
            cursor: pointer;
            color: #777;
        }
        .btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .btn:active {
            transform: translateY(0);
        }
        .register-link {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }
        .register-link a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 576px) {
            .container {
                border-radius: 10px;
            }
            .header {
                padding: 20px;
            }
            .form-container {
                padding: 20px;
            }
        }
        /* Custom Alert Styles */
        .custom-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .alert-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .alert-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .alert-title {
            font-size: 18px;
            font-weight: 500;
        }
        .alert-close {
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: white;
        }
        .alert-body {
            padding: 20px;
            text-align: center;
            font-size: 16px;
            color: var(--text);
        }
        .alert-footer {
            padding: 20px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        .alert-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        /* Success Checkmark */
        .success-checkmark {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            stroke-width: 2;
            stroke: #4caf50;
            stroke-miterlimit: 10;
            box-shadow: inset 0px 0px 0px #4caf50;
            animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
            position: relative;
            top: 5px;
            right: 5px;
            margin: 0 auto;
        }
        .checkmark-circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 2;
            stroke-miterlimit: 10;
            stroke: #4caf50;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }
        .checkmark-check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }
        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }
        @keyframes scale {
            0%, 100% {
                transform: none;
            }
            50% {
                transform: scale3d(1.1, 1.1, 1);
            }
        }
        @keyframes fill {
            100% {
                box-shadow: inset 0px 0px 0px 30px #4caf50;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ูุฑูุฏ ุจู ฺฏูู ููุง</h1>
            <p>ุจุฑุง ุฏุณุชุฑุณ ุจู ุญุณุงุจ ุฎูุฏ ูุงุฑุฏ ุดูุฏ</p>
        </div>
        <div class="form-container">
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">ูุงู ฺฉุงุฑุจุฑ ุง ุดูุงุฑู ุชููู</label>
                    <input type="text" id="username" class="form-control" placeholder="ูุงู ฺฉุงุฑุจุฑ ุง ุดูุงุฑู ุชููู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                    <div class="error-message" id="username-error">ูุทูุงู ูุงู ฺฉุงุฑุจุฑ ุง ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ</div>
                </div>
                <div class="form-group">
                    <label for="password">ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" id="password" class="form-control" placeholder="ุฑูุฒ ุนุจูุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                    <span class="show-password" id="togglePassword">ููุงุด</span>
                    <div class="error-message" id="password-error">ูุทูุงู ุฑูุฒ ุนุจูุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ</div>
                </div>
                <button type="submit" class="btn">ูุฑูุฏ</button>
                <div class="register-link">ุญุณุงุจ ูุฏุงุฑุฏุ <a href="/">ุซุจุช ูุงู ฺฉูุฏ</a></div>
            </form>
        </div>
    </div>
""" + CUSTOM_ALERT_HTML + """
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('loginForm');
            const togglePassword = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('password');
            
            // ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑ
            togglePassword.addEventListener('click', function() {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePassword.textContent = 'ูพููุงู';
                } else {
                    passwordInput.type = 'password';
                    togglePassword.textContent = 'ููุงุด';
                }
            });
            
            // ุงุนุชุจุงุฑุณูุฌ ูุฑู
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                let isValid = true;
                
                // ุงุนุชุจุงุฑุณูุฌ ูุงู ฺฉุงุฑุจุฑ/ุชููู
                const username = document.getElementById('username');
                const usernameError = document.getElementById('username-error');
                if (username.value.trim() === '') {
                    username.classList.add('error');
                    usernameError.style.display = 'block';
                    isValid = false;
                } else {
                    username.classList.remove('error');
                    usernameError.style.display = 'none';
                }
                
                // ุงุนุชุจุงุฑุณูุฌ ุฑูุฒ ุนุจูุฑ
                const password = document.getElementById('password');
                const passwordError = document.getElementById('password-error');
                if (password.value.trim() === '') {
                    password.classList.add('error');
                    passwordError.style.display = 'block';
                    isValid = false;
                } else {
                    password.classList.remove('error');
                    passwordError.style.display = 'none';
                }
                
                // ุงฺฏุฑ ูุฑู ูุนุชุจุฑ ุงุณุชุ ุงุฑุณุงู ุดูุฏ
                if (isValid) {
                    // ุงุฌุงุฏ ุดุก ุฏุงุฏูโูุง
                    const formData = {
                        username: username.value,
                        password: password.value
                    };
                    
                    // ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุจู ุณุฑูุฑ
                    fetch('/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData)
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // ููุงุด ุงููุดู ููููุช
                            document.querySelector('.form-container').innerHTML = `
                                <div class="success-checkmark">
                                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                                        <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                                        <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                                    </svg>
                                </div>
                                <h2 style="text-align: center; color: #4caf50;">ูุฑูุฏ ุจุง ููููุช ุงูุฌุงู ุดุฏ!</h2>
                                <p style="text-align: center; margin-top: 20px;">ุฏุฑ ุญุงู ุงูุชูุงู ุจู ุตูุญู ุงุตู...</p>
                            `;
                            
                            // ุงูุชูุงู ุจู ุตูุญู ุงุตู ูพุณ ุงุฒ 2 ุซุงูู
                            setTimeout(() => {
                                window.location.href = '/main?username=' + encodeURIComponent(data.user.username);
                            }, 2000);
                        } else {
                            showCustomAlert('ุฎุทุง', data.message, 'hideCustomAlert()');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showCustomAlert('ุฎุทุง', 'ุฎุทุง ุฏุฑ ุงุฑุณุงู ุงุทูุงุนุงุช', 'hideCustomAlert()');
                    });
                }
            });
            
            // ุงุนุชุจุงุฑุณูุฌ ุฏุฑ ุญู ุชุงูพ
            const inputs = form.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.classList.remove('error');
                    const errorElement = document.getElementById(this.id + '-error');
                    if (errorElement) {
                        errorElement.style.display = 'none';
                    }
                });
            });
        });
        
        // ููุงุด ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function showCustomAlert(title, message, callback) {
            document.getElementById('alertTitle').textContent = title;
            document.getElementById('alertMessage').textContent = message;
            document.getElementById('customAlert').style.display = 'flex';
            
            // ุชูุธู ฺฉุงูโุจฺฉ ุจุฑุง ุฏฺฉูู ุชุงุฏ
            document.querySelector('.alert-btn').onclick = function() {
                hideCustomAlert();
                if (callback && typeof callback === 'string') {
                    eval(callback);
                } else if (callback && typeof callback === 'function') {
                    callback();
                }
            };
        }
        
        // ูุฎู ฺฉุฑุฏู ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function hideCustomAlert() {
            document.getElementById('customAlert').style.display = 'none';
        }
    </script>
</body>
</html>"""

# Main HTML template (updated with all sections and functionalities)
MAIN_HTML = """<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ฺฏูู ููุง - ุตูุญู ุงุตู</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');
        :root {
            --primary: #006769;
            --secondary: #40A578;
            --success: #4caf50;
            --error: #f44336;
            --background: #f8f9fa;
            --text: #333;
            --light: #fff;
            --gray: #f0f0f0;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding-bottom: 80px;
        }
        .welcome-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
        }
        .welcome-header h2 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .welcome-header p {
            font-size: 14px;
            opacity: 0.9;
        }
        .content-section {
            display: none;
            padding: 20px;
            animation: fadeIn 0.5s ease-out;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 700;
        }
        /* Home Section */
        .locations-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        .location-tile {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.3s;
        }
        .location-tile:hover {
            transform: translateY(-5px);
        }
        .location-image {
            height: 120px;
            background-size: cover;
            background-position: center;
        }
        .location-info {
            padding: 10px;
        }
        .location-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .location-city {
            font-size: 12px;
            color: #666;
        }
        /* Location Detail Section */
        .location-detail {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        .location-detail-image {
            height: 200px;
            background-size: cover;
            background-position: center;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .location-detail-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        .detail-field {
            margin-bottom: 15px;
        }
        .detail-label {
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }
        .detail-value {
            font-size: 16px;
            color: var(--text);
            margin-top: 5px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        .chat-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        .edit-btn {
            background: var(--gray);
            color: var(--text);
        }
        .back-arrow {
            font-size: 24px;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-block;
        }
        /* Add Location Section */
        .add-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        .add-step {
            display: none;
        }
        .add-step.active {
            display: block;
        }
        .photo-upload {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        .photo-upload:hover {
            border-color: var(--primary);
            background-color: rgba(0, 103, 105, 0.05);
        }
        .photo-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .preview-item {
            position: relative;
            width: 80px;
            height: 80px;
        }
        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 5px;
        }
        .remove-photo {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
        }
        .set-main-photo {
            position: absolute;
            bottom: -5px;
            left: -5px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
        }
        .main-photo-indicator {
            position: absolute;
            top: 5px;
            left: 5px;
            background: var(--success);
            color: white;
            border-radius: 3px;
            padding: 2px 5px;
            font-size: 10px;
        }
        .form-field {
            margin-bottom: 20px;
        }
        .form-field label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }
        .form-field label.required::after {
            content: " *";
            color: var(--error);
        }
        .form-field input, .form-field textarea, .form-field select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }
        .form-field input:focus, .form-field textarea:focus, .form-field select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 103, 105, 0.2);
            outline: none;
        }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .nav-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        .back-btn {
            background: var(--gray);
            color: var(--text);
        }
        .next-btn, .submit-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        /* Profile Section */
        .profile-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        .profile-item {
            margin-bottom: 20px;
        }
        .profile-label {
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }
        .profile-value {
            font-size: 16px;
            color: var(--text);
            margin-top: 5px;
        }
        .profile-actions {
            margin-top: 30px;
        }
        .action-button {
            width: 100%;
            padding: 15px;
            background: var(--gray);
            border: none;
            border-radius: 10px;
            font-weight: 500;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .action-button:hover {
            background: #e0e0e0;
        }
        .edit-form {
            display: none;
            margin-top: 15px;
        }
        .edit-form input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5eb;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .form-actions {
            display: flex;
            gap: 10px;
        }
        .save-btn, .cancel-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
        }
        .save-btn {
            background: var(--success);
            color: white;
        }
        .cancel-btn {
            background: var(--gray);
            color: var(--text);
        }
        /* Chat Section */
        .chat-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .chat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s;
        }
        .chat-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .chat-user {
            font-weight: 500;
            margin-bottom: 5px;
        }
        .chat-last-message {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .chat-messages {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            height: 70vh;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .message {
            margin-bottom: 15px;
            max-width: 80%;
        }
        .message.sent {
            margin-left: auto;
            text-align: right;
        }
        .message.received {
            margin-right: auto;
        }
        .message-content {
            display: inline-block;
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 14px;
        }
        .sent .message-content {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        .received .message-content {
            background: var(--gray);
            color: var(--text);
        }
        .message-time {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }
        .chat-input {
            display: flex;
            gap: 10px;
        }
        .chat-input input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 14px;
        }
        .chat-input input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 103, 105, 0.2);
            outline: none;
        }
        .chat-send-btn {
            padding: 15px 20px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
        }
        /* Notifications Section */
        .notifications-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .notification-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        .notification-title {
            font-weight: 500;
            margin-bottom: 5px;
        }
        .notification-message {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        .notification-time {
            font-size: 12px;
            color: #999;
        }
        /* Comments Section */
        .comments-section {
            margin-top: 30px;
        }
        .comment-form {
            margin-bottom: 20px;
        }
        .star-rating {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .star {
            font-size: 24px;
            color: #ddd;
            cursor: pointer;
            transition: color 0.3s;
        }
        .star.filled {
            color: #ffc107;
        }
        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .comment-item {
            background: var(--gray);
            padding: 15px;
            border-radius: 10px;
        }
        .comment-user {
            font-weight: 500;
            margin-bottom: 5px;
        }
        .comment-stars {
            color: #ffc107;
            margin-bottom: 5px;
        }
        .comment-text {
            color: #666;
        }
        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        .nav-item {
            text-align: center;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .nav-item.active {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
        .nav-text {
            font-size: 12px;
        }
        /* Custom Alert Styles */
        .custom-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .alert-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .alert-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .alert-title {
            font-size: 18px;
            font-weight: 500;
        }
        .alert-close {
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: white;
        }
        .alert-body {
            padding: 20px;
            text-align: center;
            font-size: 16px;
            color: var(--text);
        }
        .alert-footer {
            padding: 20px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        .alert-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        /* Success Checkmark */
        .success-checkmark {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            stroke-width: 2;
            stroke: #4caf50;
            stroke-miterlimit: 10;
            box-shadow: inset 0px 0px 0px #4caf50;
            animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
            position: relative;
            top: 5px;
            right: 5px;
            margin: 0 auto;
        }
        .checkmark-circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 2;
            stroke-miterlimit: 10;
            stroke: #4caf50;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }
        .checkmark-check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }
        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }
        @keyframes scale {
            0%, 100% {
                transform: none;
            }
            50% {
                transform: scale3d(1.1, 1.1, 1);
            }
        }
        @keyframes fill {
            100% {
                box-shadow: inset 0px 0px 0px 30px #4caf50;
            }
        }
    </style>
</head>
<body>
    <div class="welcome-header">
        <h2>ุฎูุด ุขูุฏุฏุ {{ username }}!</h2>
        <p>ุจู ุงูพูฺฉุดู ฺฏูู ููุง ุฎูุด ุขูุฏุฏ</p>
    </div>
    
    <div id="homeSection" class="content-section active">
        <h3>ุตูุญู ุงุตู</h3>
        <div class="locations-list">
            {% for loc in all_locations %}
            <div class="location-tile" onclick="showLocationDetails('{{ loc.id }}')">
                <div class="location-image" style="background-image: url('/uploads/{{ loc.photos[0] }}');"></div>
                <div class="location-info">
                    <div class="location-title">{{ loc.title }}</div>
                    <div class="location-city">{{ loc.city }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div id="locationDetailSection" class="content-section">
        <span class="back-arrow" onclick="showSection('homeSection', document.querySelector('.nav-item[onclick*=\"homeSection\"]'))">โฌ๏ธ</span>
        <div class="location-detail">
            <div class="location-detail-image" id="locImage"></div>
            <div class="location-detail-title" id="locTitle"></div>
            <div class="detail-field">
                <div class="detail-label">ุชูุถุญุงุช</div>
                <div class="detail-value" id="locDesc"></div>
            </div>
            <div class="detail-field">
                <div class="detail-label">ุดูุฑฺฉ</div>
                <div class="detail-value" id="locCity"></div>
            </div>
            <div class="detail-field">
                <div class="detail-label">ุขุฏุฑุณ</div>
                <div class="detail-value" id="locAddress"></div>
            </div>
            <div class="detail-field" id="locPhoneField">
                <div class="detail-label">ุดูุงุฑู ููุจุงู</div>
                <div class="detail-value" id="locPhone"></div>
            </div>
            <div class="detail-field" id="locShiftsField">
                <div class="detail-label">ุดูุชโูุง</div>
                <div class="detail-value" id="locShifts"></div>
            </div>
            <div class="detail-field">
                <div class="detail-label">ุฏุณุชู</div>
                <div class="detail-value" id="locCategory"></div>
            </div>
            <div class="detail-field">
                <div class="detail-label">ุฒุฑ ุฏุณุชู</div>
                <div class="detail-value" id="locSubcategory"></div>
            </div>
            <div class="action-buttons" id="locActions"></div>
            <div class="comments-section">
                <h4>ูุธุฑุงุช</h4>
                <div class="comment-form">
                    <textarea id="commentText" placeholder="ูุธุฑ ุฎูุฏ ุฑุง ุจููุณุฏ"></textarea>
                    <div class="star-rating">
                        <span class="star" onclick="setRating(1)">โ</span>
                        <span class="star" onclick="setRating(2)">โ</span>
                        <span class="star" onclick="setRating(3)">โ</span>
                        <span class="star" onclick="setRating(4)">โ</span>
                        <span class="star" onclick="setRating(5)">โ</span>
                    </div>
                    <button class="submit-btn" onclick="submitComment()">ุงุฑุณุงู ูุธุฑ</button>
                </div>
                <div class="comments-list" id="commentsList"></div>
            </div>
        </div>
    </div>
    
    <div id="addSection" class="content-section">
        <h3>ุงูุฒูุฏู ูฺฉุงู</h3>
        <div class="add-container">
            <div id="addStep1" class="add-step active">
                <div class="photo-upload" onclick="document.getElementById('photoInput').click()">
                    <span style="font-size: 50px;">+</span>
                    <p>ุงุถุงูู ฺฉุฑุฏู ุนฺฉุณ</p>
                </div>
                <input type="file" id="photoInput" multiple accept="image/*" style="display: none;" onchange="previewPhotos()">
                <div class="photo-preview" id="photoPreview"></div>
                <div class="form-field">
                    <label class="required">ุนููุงู ูฺฉุงู</label>
                    <input type="text" id="locTitleInput" placeholder="ุนููุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                <div class="form-field">
                    <label class="required">ุดูุฑฺฉ</label>
                    <select id="locCitySelect">
                        <option value="">ุงูุชุฎุงุจ ุดูุฑฺฉ</option>
                        {% for city in cities %}
                        <option value="{{ city }}">{{ city }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-field">
                    <label class="required">ุขุฏุฑุณ</label>
                    <textarea id="locAddressInput" placeholder="ุขุฏุฑุณ ุฑุง ูุงุฑุฏ ฺฉูุฏ"></textarea>
                </div>
                <div class="nav-buttons">
                    <div></div> <!-- Empty div for spacing -->
                    <button class="next-btn" onclick="nextStep(1)">ุจุนุฏ</button>
                </div>
            </div>
            
            <div id="addStep2" class="add-step">
                <div class="form-field">
                    <label>ุดูุงุฑู ููุจุงู</label>
                    <input type="tel" id="locPhoneInput" placeholder="09xxxxxxxxx">
                </div>
                <div class="form-field">
                    <label>ุดูุช ุตุจุญฺฏุงู</label>
                    <input type="text" id="morningShift" placeholder="ูุซุงู: 8:00 ุชุง 14:00">
                </div>
                <div class="form-field">
                    <label>ุดูุช ุนุตุฑฺฏุงู</label>
                    <input type="text" id="eveningShift" placeholder="ูุซุงู: 14:00 ุชุง 22:00">
                </div>
                <div class="form-field">
                    <label>ุชูุถุญุงุช</label>
                    <textarea id="locDescInput" placeholder="ุชูุถุญุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ"></textarea>
                </div>
                <div class="form-field">
                    <label>ุฏุณุชู</label>
                    <select id="categorySelect" onchange="loadSubcategories()">
                        <option value="">ุงูุชุฎุงุจ ุฏุณุชู</option>
                        {% for cat in categories.keys() %}
                        <option value="{{ cat }}">{{ cat }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-field" id="subcategoryField" style="display: none;">
                    <label>ุฒุฑ ุฏุณุชู</label>
                    <select id="subcategorySelect">
                        <option value="">ุงูุชุฎุงุจ ุฒุฑ ุฏุณุชู</option>
                    </select>
                </div>
                <div class="nav-buttons">
                    <div class="back-btn" onclick="prevStep(2)">ุจุฑฺฏุดุช</div>
                    <div class="next-btn" onclick="nextStep(2)">ุจุนุฏ</div>
                </div>
            </div>
            
            <div id="addStep3" class="add-step">
                <div class="form-field">
                    <label class="required">ูุงู ฺฉุงุฑุจุฑ ูุงูฺฉ</label>
                    <input type="text" id="locOwnerInput" placeholder="ูุงู ฺฉุงุฑุจุฑ ูุงูฺฉ ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                <div class="nav-buttons">
                    <div class="back-btn" onclick="prevStep(3)">ุจุฑฺฏุดุช</div>
                    <div class="submit-btn" onclick="submitLocation()">ุซุจุช</div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="editLocationSection" class="content-section">
        <span class="back-arrow" onclick="showMyLocations()">โฌ๏ธ</span>
        <h3>ูุฑุงุด ูฺฉุงู</h3>
        <!-- Similar to add section but pre-filled -->
        <div class="add-container">
            <!-- ... (duplicate add steps with pre-fill logic in JS) ... -->
        </div>
    </div>
    
    <div id="profileSection" class="content-section">
        <div class="profile-card">
            <h3>ูพุฑููุงู ฺฉุงุฑุจุฑ</h3>
            <div class="profile-item">
                <div class="profile-label">ูุงู ฺฉุงุฑุจุฑ</div>
                <div class="profile-value" id="profileUsername">{{ username }}</div>
                <div class="edit-form" id="usernameForm">
                    <input type="text" id="newUsername" placeholder="ูุงู ฺฉุงุฑุจุฑ ุฌุฏุฏ">
                    <div class="form-actions">
                        <button class="cancel-btn" onclick="toggleEditForm('usernameForm')">ูุบู</button>
                        <button class="save-btn" onclick="updateUsername()">ุฐุฎุฑู</button>
                    </div>
                </div>
            </div>
            <div class="profile-item">
                <div class="profile-label">ุดูุฑ</div>
                <div class="profile-value" id="profileCity">{{ user_city }}</div>
                <div class="edit-form" id="cityForm">
                    <select id="newCity">
                        {% for city in cities %}
                        <option value="{{ city }}" {% if city == user_city %}selected{% endif %}>{{ city }}</option>
                        {% endfor %}
                    </select>
                    <div class="form-actions">
                        <button class="cancel-btn" onclick="toggleEditForm('cityForm')">ูุบู</button>
                        <button class="save-btn" onclick="updateCity()">ุฐุฎุฑู</button>
                    </div>
                </div>
            </div>
            <div class="profile-item">
                <div class="profile-label">ุชููู ููุฑุงู</div>
                <div class="profile-value" id="profilePhone">{{ user_phone }}</div>
                <div class="edit-form" id="phoneForm">
                    <input type="tel" id="newPhone" placeholder="09xxxxxxxxx" value="{{ user_phone }}">
                    <div class="form-actions">
                        <button class="cancel-btn" onclick="toggleEditForm('phoneForm')">ูุบู</button>
                        <button class="save-btn" onclick="updatePhone()">ุฐุฎุฑู</button>
                    </div>
                </div>
            </div>
            <div class="profile-actions">
                <button class="action-button" onclick="toggleEditForm('usernameForm')">ูุฑุงุด ูุงู ฺฉุงุฑุจุฑ</button>
                <button class="action-button" onclick="toggleEditForm('cityForm')">ูุฑุงุด ุดูุฑ</button>
                <button class="action-button" onclick="toggleEditForm('phoneForm')">ูุฑุงุด ุชููู</button>
                <button class="action-button" onclick="showChangePasswordForm()">ุชุบุฑ ุฑูุฒ ุนุจูุฑ</button>
                <button class="action-button" onclick="showMyLocations()">ูฺฉุงู ูุง ูู</button>
                <button class="action-button" onclick="logout()">ุฎุฑูุฌ ุงุฒ ุญุณุงุจ</button>
            </div>
            <div class="edit-form" id="passwordForm">
                <input type="password" id="newPassword" placeholder="ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ" class="form-control">
                <input type="password" id="confirmNewPassword" placeholder="ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ" class="form-control" style="margin-top: 10px;">
                <div class="form-actions">
                    <button class="cancel-btn" onclick="toggleEditForm('passwordForm')">ูุบู</button>
                    <button class="save-btn" onclick="updatePassword()">ุฐุฎุฑู</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="chatSection" class="content-section">
        <h3>ฺุช</h3>
        <div class="chat-list" id="chatList"></div>
    </div>
    
    <div id="chatRoomSection" class="content-section">
        <span class="back-arrow" onclick="showSection('chatSection', document.querySelector('.nav-item[onclick*=\"chatSection\"]'))">โฌ๏ธ</span>
        <h3 id="chatUserTitle"></h3>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="ูพุงู ุฎูุฏ ุฑุง ุจููุณุฏ...">
            <button class="chat-send-btn" onclick="sendMessage()">ุงุฑุณุงู</button>
        </div>
    </div>
    
    <div id="notificationsSection" class="content-section">
        <span class="back-arrow" onclick="backFromNotifications()">โฌ๏ธ</span>
        <h3>ุงุนูุงูโูุง</h3>
        <div class="notifications-list" id="notificationsList"></div>
    </div>
    
    <div class="bottom-nav">
        <div class="nav-item" onclick="showSection('profileSection', this)">
            <div class="nav-icon">๐ค</div>
            <div class="nav-text">ูพุฑููุงู</div>
        </div>
        <div class="nav-item" onclick="showSection('chatSection', this)">
            <div class="nav-icon">๐ฌ</div>
            <div class="nav-text">ฺุช</div>
        </div>
        <div class="nav-item active" onclick="showSection('homeSection', this)">
            <div class="nav-icon">๐</div>
            <div class="nav-text">ุตูุญู ุงุตู</div>
        </div>
        <div class="nav-item" onclick="showSection('addSection', this)">
            <div class="nav-icon">โ</div>
            <div class="nav-text">ุงุถุงูู ฺฉุฑุฏู</div>
        </div>
    </div>
    
""" + CUSTOM_ALERT_HTML + """
    <script>
        let currentSection = 'homeSection';
        let previousSection = '';
        let addStep = 1;
        let photos = [];
        let mainPhotoIndex = 0;
        let currentLocationId = '';
        let isMyLocation = false;
        let rating = 0;
        let chatPartner = '';
        
        function showSection(sectionId, element) {
            previousSection = currentSection;
            currentSection = sectionId;
            
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            if (element) {
                element.classList.add('active');
            }
        }
        
        function showLocationDetails(locationId) {
            fetch('/get_location/' + locationId)
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    const loc = data.location;
                    document.getElementById('locImage').style.backgroundImage = `url('/uploads/${loc.photos[loc.main_photo]}')`;
                    document.getElementById('locTitle').textContent = loc.title;
                    document.getElementById('locDesc').textContent = loc.description || 'ุจุฏูู ุชูุถุญ';
                    document.getElementById('locCity').textContent = loc.city;
                    document.getElementById('locAddress').textContent = loc.address;
                    
                    if (loc.phone) {
                        document.getElementById('locPhone').textContent = loc.phone;
                        document.getElementById('locPhoneField').style.display = 'block';
                    } else {
                        document.getElementById('locPhoneField').style.display = 'none';
                    }
                    
                    if (loc.morning_shift || loc.evening_shift) {
                        let shifts = '';
                        if (loc.morning_shift) shifts += `ุตุจุญฺฏุงู: ${loc.morning_shift}`;
                        if (loc.evening_shift) shifts += ` | ุนุตุฑฺฏุงู: ${loc.evening_shift}`;
                        document.getElementById('locShifts').textContent = shifts;
                        document.getElementById('locShiftsField').style.display = 'block';
                    } else {
                        document.getElementById('locShiftsField').style.display = 'none';
                    }
                    
                    document.getElementById('locCategory').textContent = loc.category || 'ุจุฏูู ุฏุณุชู';
                    document.getElementById('locSubcategory').textContent = loc.subcategory || 'ุจุฏูู ุฒุฑ ุฏุณุชู';
                    
                    // ุชูุธู ุฏฺฉููโูุง ุนููุงุช
                    const actionsDiv = document.getElementById('locActions');
                    actionsDiv.innerHTML = '';
                    
                    const chatBtn = document.createElement('button');
                    chatBtn.className = 'action-btn chat-btn';
                    chatBtn.textContent = 'ฺุช ุจุง ูุงูฺฉ';
                    chatBtn.onclick = () => openChat(loc.owner);
                    actionsDiv.appendChild(chatBtn);
                    
                    // ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุงูฺฉ ูฺฉุงู ุจุงุดุฏุ ุฏฺฉูู ูุฑุงุด ููุงุด ุฏุงุฏู ุดูุฏ
                    if (loc.owner === '{{ username }}') {
                        const editBtn = document.createElement('button');
                        editBtn.className = 'action-btn edit-btn';
                        editBtn.textContent = 'ูุฑุงุด';
                        editBtn.onclick = () => editLocation(locationId);
                        actionsDiv.appendChild(editBtn);
                        isMyLocation = true;
                    } else {
                        isMyLocation = false;
                    }
                    
                    currentLocationId = locationId;
                    showSection('locationDetailSection');
                    loadComments(locationId);
                }
            });
        }
        
        function loadComments(locationId) {
            fetch('/get_comments/' + locationId)
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    const commentsList = document.getElementById('commentsList');
                    commentsList.innerHTML = '';
                    data.comments.forEach(comment => {
                        const commentDiv = document.createElement('div');
                        commentDiv.className = 'comment-item';
                        let stars = '';
                        for (let i = 0; i < comment.rating; i++) {
                            stars += 'โ';
                        }
                        commentDiv.innerHTML = `
                            <div class="comment-user">${comment.user}</div>
                            <div class="comment-stars">${stars}</div>
                            <div class="comment-text">${comment.text}</div>
                        `;
                        commentsList.appendChild(commentDiv);
                    });
                }
            });
        }
        
        function setRating(ratingValue) {
            rating = ratingValue;
            const stars = document.querySelectorAll('.star-rating .star');
            stars.forEach((star, index) => {
                if (index < ratingValue) {
                    star.classList.add('filled');
                } else {
                    star.classList.remove('filled');
                }
            });
        }
        
        function submitComment() {
            const text = document.getElementById('commentText').value;
            if (!text.trim() || rating === 0) {
                showCustomAlert('ุฎุทุง', 'ูุทูุงู ูุธุฑ ู ุงูุชุงุฒ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
                return;
            }
            
            const data = {
                location_id: currentLocationId,
                text: text,
                rating: rating
            };
            
            fetch('/add_comment', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('commentText').value = '';
                    setRating(0);
                    loadComments(currentLocationId);
                    showCustomAlert('ููููุช', 'ูุธุฑ ุดูุง ุซุจุช ุดุฏ');
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function nextStep(step) {
            if (step === 1) {
                const title = document.getElementById('locTitleInput').value;
                const city = document.getElementById('locCitySelect').value;
                const address = document.getElementById('locAddressInput').value;
                
                if (!title || !city || !address) {
                    showCustomAlert('ุฎุทุง', 'ูุทูุงู ุชูุงู ููุฏูุง ุงุฌุจุงุฑ ุฑุง ูพุฑ ฺฉูุฏ');
                    return;
                }
            }
            
            document.getElementById('addStep' + step).classList.remove('active');
            document.getElementById('addStep' + (step + 1)).classList.add('active');
            addStep = step + 1;
        }
        
        function prevStep(step) {
            document.getElementById('addStep' + step).classList.remove('active');
            document.getElementById('addStep' + (step - 1)).classList.add('active');
            addStep = step - 1;
        }
        
        function previewPhotos() {
            const files = document.getElementById('photoInput').files;
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                if (!file.type.match('image.*')) continue;
                
                const reader = new FileReader();
                reader.onload = (function(theFile, index) {
                    return function(e) {
                        const div = document.createElement('div');
                        div.className = 'preview-item';
                        div.innerHTML = `
                            <img src="${e.target.result}" alt="Preview">
                            <button class="remove-photo" onclick="removePhoto(${index})">ร</button>
                            <button class="set-main-photo" onclick="setMainPhoto(${index})">M</button>
                            ${index === mainPhotoIndex ? '<div class="main-photo-indicator">ุงุตู</div>' : ''}
                        `;
                        preview.appendChild(div);
                    };
                })(file, i);
                
                reader.readAsDataURL(file);
                photos.push(file);
            }
        }
        
        function removePhoto(index) {
            photos.splice(index, 1);
            if (mainPhotoIndex >= photos.length) {
                mainPhotoIndex = photos.length - 1;
            }
            previewPhotos();
        }
        
        function setMainPhoto(index) {
            mainPhotoIndex = index;
            previewPhotos();
        }
        
        function loadSubcategories() {
            const category = document.getElementById('categorySelect').value;
            const subcategoryField = document.getElementById('subcategoryField');
            const subcategorySelect = document.getElementById('subcategorySelect');
            
            if (category) {
                subcategoryField.style.display = 'block';
                subcategorySelect.innerHTML = '<option value="">ุงูุชุฎุงุจ ุฒุฑ ุฏุณุชู</option>';
                
                const subcategories = {
                    {% for cat, subs in categories.items() %}
                    "{{ cat }}": [
                        {% for sub in subs %}
                        "{{ sub }}",
                        {% endfor %}
                    ],
                    {% endfor %}
                };
                
                subcategories[category].forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
            } else {
                subcategoryField.style.display = 'none';
            }
        }
        
        function submitLocation() {
            const title = document.getElementById('locTitleInput').value;
            const city = document.getElementById('locCitySelect').value;
            const address = document.getElementById('locAddressInput').value;
            const phone = document.getElementById('locPhoneInput').value;
            const morning_shift = document.getElementById('morningShift').value;
            const evening_shift = document.getElementById('eveningShift').value;
            const description = document.getElementById('locDescInput').value;
            const category = document.getElementById('categorySelect').value;
            const subcategory = document.getElementById('subcategorySelect').value;
            const owner = document.getElementById('locOwnerInput').value;
            
            if (!title || !city || !address || !owner) {
                showCustomAlert('ุฎุทุง', 'ูุทูุงู ุชูุงู ููุฏูุง ุงุฌุจุงุฑ ุฑุง ูพุฑ ฺฉูุฏ');
                return;
            }
            
            const formData = new FormData();
            formData.append('title', title);
            formData.append('city', city);
            formData.append('address', address);
            formData.append('phone', phone);
            formData.append('morning_shift', morning_shift);
            formData.append('evening_shift', evening_shift);
            formData.append('description', description);
            formData.append('category', category);
            formData.append('subcategory', subcategory);
            formData.append('owner', owner);
            formData.append('main_photo', mainPhotoIndex.toString());
            
            for (let i = 0; i < photos.length; i++) {
                formData.append('photos', photos[i]);
            }
            
            fetch('/add_location', {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    showCustomAlert('ููููุช', 'ูฺฉุงู ุซุจุช ุดุฏ', "showSection('homeSection', document.querySelector('.nav-item[onclick*=\"homeSection\"]'))");
                    resetAddForm();
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function resetAddForm() {
            document.getElementById('addStep' + addStep).classList.remove('active');
            document.getElementById('addStep1').classList.add('active');
            addStep = 1;
            
            document.getElementById('photoInput').value = '';
            document.getElementById('photoPreview').innerHTML = '';
            document.getElementById('locTitleInput').value = '';
            document.getElementById('locCitySelect').value = '';
            document.getElementById('locAddressInput').value = '';
            document.getElementById('locPhoneInput').value = '';
            document.getElementById('morningShift').value = '';
            document.getElementById('eveningShift').value = '';
            document.getElementById('locDescInput').value = '';
            document.getElementById('categorySelect').value = '';
            document.getElementById('subcategorySelect').innerHTML = '<option value="">ุงูุชุฎุงุจ ุฒุฑ ุฏุณุชู</option>';
            document.getElementById('subcategoryField').style.display = 'none';
            document.getElementById('locOwnerInput').value = '';
            
            photos = [];
            mainPhotoIndex = 0;
        }
        
        function toggleEditForm(formId) {
            const form = document.getElementById(formId);
            if (form.style.display === 'block') {
                form.style.display = 'none';
            } else {
                // ูุฎู ฺฉุฑุฏู ุณุงุฑ ูุฑูโูุง
                document.querySelectorAll('.edit-form').forEach(f => {
                    f.style.display = 'none';
                });
                form.style.display = 'block';
            }
        }
        
        function showChangePasswordForm() {
            toggleEditForm('passwordForm');
        }
        
        function updateUsername() {
            const newUsername = document.getElementById('newUsername').value;
            if (!newUsername) {
                showCustomAlert('ุฎุทุง', 'ูุทูุงู ูุงู ฺฉุงุฑุจุฑ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
                return;
            }
            
            fetch('/update_profile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ field: 'username', value: newUsername })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('profileUsername').textContent = newUsername;
                    document.getElementById('newUsername').value = '';
                    toggleEditForm('usernameForm');
                    showCustomAlert('ููููุช', 'ูุงู ฺฉุงุฑุจุฑ ุจุง ููููุช ุชุบุฑ ฺฉุฑุฏ');
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function updateCity() {
            const newCity = document.getElementById('newCity').value;
            fetch('/update_profile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ field: 'city', value: newCity })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('profileCity').textContent = newCity;
                    toggleEditForm('cityForm');
                    showCustomAlert('ููููุช', 'ุดูุฑ ุจุง ููููุช ุชุบุฑ ฺฉุฑุฏ');
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function updatePhone() {
            const newPhone = document.getElementById('newPhone').value;
            const phoneRegex = /^09\d{9}$/;
            if (!phoneRegex.test(newPhone)) {
                showCustomAlert('ุฎุทุง', 'ูุทูุงู ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ');
                return;
            }
            
            fetch('/update_profile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ field: 'phone', value: newPhone })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('profilePhone').textContent = newPhone;
                    document.getElementById('newPhone').value = '';
                    toggleEditForm('phoneForm');
                    showCustomAlert('ููููุช', 'ุดูุงุฑู ุชููู ุจุง ููููุช ุชุบุฑ ฺฉุฑุฏ');
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function updatePassword() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            if (newPassword.length < 6) {
                showCustomAlert('ุฎุทุง', 'ุฑูุฒ ุนุจูุฑ ุจุงุฏ ุญุฏุงูู ถ ฺฉุงุฑุงฺฉุชุฑ ุฏุงุดุชู ุจุงุดุฏ');
                return;
            }
            
            if (newPassword !== confirmNewPassword) {
                showCustomAlert('ุฎุทุง', 'ุฑูุฒูุง ุนุจูุฑ ูุทุงุจูุช ูุฏุงุฑูุฏ');
                return;
            }
            
            fetch('/update_profile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ field: 'password', value: newPassword })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmNewPassword').value = '';
                    toggleEditForm('passwordForm');
                    showCustomAlert('ููููุช', 'ุฑูุฒ ุนุจูุฑ ุจุง ููููุช ุชุบุฑ ฺฉุฑุฏ');
                } else {
                    showCustomAlert('ุฎุทุง', data.message);
                }
            });
        }
        
        function showMyLocations() {
            fetch('/my_locations')
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    // ููุงุด ูฺฉุงูโูุง ฺฉุงุฑุจุฑ
                    // ุงู ูุณูุช ูุงุฒ ุจู ูพุงุฏูโุณุงุฒ ุจุดุชุฑ ุฏุงุฑุฏ
                    showCustomAlert('ุงุทูุงุนุงุช', 'ุงู ุจุฎุด ุฏุฑ ุญุงู ุชูุณุนู ุงุณุช');
                }
            });
        }
        
        function logout() {
            fetch('/logout', { method: 'POST' })
            .then(() => {
                window.location.href = '/';
            });
        }
        
        function openChat(partner) {
            chatPartner = partner;
            document.getElementById('chatUserTitle').textContent = `ฺุช ุจุง ${partner}`;
            showSection('chatRoomSection');
            loadChatMessages(partner);
        }
        
        function loadChatMessages(partner) {
            fetch('/get_chat/' + partner)
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    const messagesDiv = document.getElementById('chatMessages');
                    messagesDiv.innerHTML = '';
                    data.messages.forEach(msg => {
                        const messageDiv = document.createElement('div');
                        messageDiv.className = `message ${msg.sender === '{{ username }}' ? 'sent' : 'received'}`;
                        messageDiv.innerHTML = `
                            <div class="message-content">${msg.text}</div>
                            <div class="message-time">${new Date(msg.timestamp).toLocaleTimeString('fa-IR')}</div>
                        `;
                        messagesDiv.appendChild(messageDiv);
                    });
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                }
            });
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text) return;
            
            const data = {
                partner: chatPartner,
                text: text
            };
            
            fetch('/send_message', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    input.value = '';
                    loadChatMessages(chatPartner);
                }
            });
        }
        
        function editLocation(locationId) {
            // ูพุงุฏูโุณุงุฒ ูุฑุงุด ูฺฉุงู
            showCustomAlert('ุงุทูุงุนุงุช', 'ุงู ุจุฎุด ุฏุฑ ุญุงู ุชูุณุนู ุงุณุช');
        }
        
        // ููุงุด ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function showCustomAlert(title, message, callback) {
            document.getElementById('alertTitle').textContent = title;
            document.getElementById('alertMessage').textContent = message;
            document.getElementById('customAlert').style.display = 'flex';
            
            // ุชูุธู ฺฉุงูโุจฺฉ ุจุฑุง ุฏฺฉูู ุชุงุฏ
            document.querySelector('.alert-btn').onclick = function() {
                hideCustomAlert();
                if (callback && typeof callback === 'string') {
                    eval(callback);
                } else if (callback && typeof callback === 'function') {
                    callback();
                }
            };
        }
        
        // ูุฎู ฺฉุฑุฏู ูพูุฌุฑู ูุดุฏุงุฑ ุณูุงุฑุด
        function hideCustomAlert() {
            document.getElementById('customAlert').style.display = 'none';
        }
        
        // ุจุงุฑฺฏุฐุงุฑ ุงููู ุฏุงุฏูโูุง
        document.addEventListener('DOMContentLoaded', function() {
            // ุจุงุฑฺฏุฐุงุฑ ูุณุช ฺุชโูุง
            fetch('/get_chats')
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    const chatList = document.getElementById('chatList');
                    chatList.innerHTML = '';
                    data.chats.forEach(chat => {
                        const chatDiv = document.createElement('div');
                        chatDiv.className = 'chat-item';
                        chatDiv.innerHTML = `
                            <div class="chat-user">${chat.partner}</div>
                            <div class="chat-last-message">${chat.last_message || 'ุจุฏูู ูพุงู'}</div>
                        `;
                        chatDiv.onclick = () => openChat(chat.partner);
                        chatList.appendChild(chatDiv);
                    });
                }
            });
            
            // ุจุงุฑฺฏุฐุงุฑ ุงุนูุงูโูุง
            fetch('/get_notifications')
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    const notificationsList = document.getElementById('notificationsList');
                    notificationsList.innerHTML = '';
                    data.notifications.forEach(notification => {
                        const notifDiv = document.createElement('div');
                        notifDiv.className = 'notification-item';
                        notifDiv.innerHTML = `
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-message">${notification.message}</div>
                            <div class="notification-time">${new Date(notification.timestamp).toLocaleString('fa-IR')}</div>
                        `;
                        notificationsList.appendChild(notifDiv);
                    });
                }
            });
        });
    </script>
</body>
</html>"""

# ุชูุงุจุน ฺฉูฺฉ ุจุฑุง ฺฉุงุฑ ุจุง ูุงูโูุง JSON
def load_data(filename):
    """ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ุงุฒ ูุงู JSON"""
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            return json.load(f)
    except FileNotFoundError:
        return []

def save_data(filename, data):
    """ุฐุฎุฑู ุฏุงุฏูโูุง ุฏุฑ ูุงู JSON"""
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=4)

def find_user(username=None, phone=None):
    """ูพุฏุง ฺฉุฑุฏู ฺฉุงุฑุจุฑ ุจุฑ ุงุณุงุณ ูุงู ฺฉุงุฑุจุฑ ุง ุดูุงุฑู ุชููู"""
    users = load_data(USERS_FILE)
    for user in users:
        if (username and user.get('username') == username) or (phone and user.get('phone') == phone):
            return user
    return None

def validate_phone(phone):
    """ุงุนุชุจุงุฑุณูุฌ ุดูุงุฑู ุชููู"""
    return re.match(r'^09\d{9}$', phone) is not None

def validate_password(password):
    """ุงุนุชุจุงุฑุณูุฌ ุฑูุฒ ุนุจูุฑ"""
    return len(password) >= 6

# ูุณุฑูุง ุงูพูฺฉุดู
@app.route('/')
def register():
    """ุตูุญู ุซุจุช ูุงู"""
    return REGISTER_HTML.replace('{% for city in cities %}', ''.join([f'<option value="{city}">{city}</option>' for city in CITIES])).replace('{% endfor %}', '')

@app.route('/register', methods=['POST'])
def register_user():
    """ุซุจุช ูุงู ฺฉุงุฑุจุฑ"""
    data = request.get_json()
    username = data.get('username')
    city = data.get('city')
    phone = data.get('phone')
    password = data.get('password')
    
    # ุงุนุชุจุงุฑุณูุฌ ุฏุงุฏูโูุง
    if not username or len(username) < 3:
        return jsonify({'success': False, 'message': 'ูุงู ฺฉุงุฑุจุฑ ุจุงุฏ ุญุฏุงูู ณ ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ'})
    
    if not city:
        return jsonify({'success': False, 'message': 'ูุทูุงู ุดูุฑ ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ'})
    
    if not validate_phone(phone):
        return jsonify({'success': False, 'message': 'ูุทูุงู ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ'})
    
    if not validate_password(password):
        return jsonify({'success': False, 'message': 'ุฑูุฒ ุนุจูุฑ ุจุงุฏ ุญุฏุงูู ถ ฺฉุงุฑุงฺฉุชุฑ ุฏุงุดุชู ุจุงุดุฏ'})
    
    # ุจุฑุฑุณ ุชฺฉุฑุงุฑ ุจูุฏู ูุงู ฺฉุงุฑุจุฑ ุง ุดูุงุฑู ุชููู
    if find_user(username=username):
        return jsonify({'success': False, 'message': 'ูุงู ฺฉุงุฑุจุฑ ุชฺฉุฑุงุฑ ุงุณุช'})
    
    if find_user(phone=phone):
        return jsonify({'success': False, 'message': 'ุดูุงุฑู ุชููู ุชฺฉุฑุงุฑ ุงุณุช'})
    
    # ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ
    users = load_data(USERS_FILE)
    new_user = {
        'id': str(uuid.uuid4()),
        'username': username,
        'city': city,
        'phone': phone,
        'password': password,  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุฑูุฒ ุนุจูุฑ ูุด ุดูุฏ
        'timestamp': data.get('timestamp')
    }
    users.append(new_user)
    save_data(USERS_FILE, users)
    
    return jsonify({'success': True, 'user': new_user, 'message': 'ุซุจุช ูุงู ุจุง ููููุช ุงูุฌุงู ุดุฏ'})

@app.route('/login')
def login():
    """ุตูุญู ูุฑูุฏ"""
    return LOGIN_HTML

@app.route('/login', methods=['POST'])
def login_user():
    """ูุฑูุฏ ฺฉุงุฑุจุฑ"""
    data = request.get_json()
    username_or_phone = data.get('username')
    password = data.get('password')
    
    # ูพุฏุง ฺฉุฑุฏู ฺฉุงุฑุจุฑ
    user = find_user(username=username_or_phone) or find_user(phone=username_or_phone)
    
    if user and user.get('password') == password:  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุฑูุฒ ุนุจูุฑ ููุงุณู ุดูุฏ
        return jsonify({'success': True, 'user': user, 'message': 'ูุฑูุฏ ุจุง ููููุช ุงูุฌุงู ุดุฏ'})
    else:
        return jsonify({'success': False, 'message': 'ูุงู ฺฉุงุฑุจุฑ/ุชููู ุง ุฑูุฒ ุนุจูุฑ ุงุดุชุจุงู ุงุณุช'})

@app.route('/main')
def main_page():
    """ุตูุญู ุงุตู ุงูพูฺฉุดู"""
    username = request.args.get('username')
    if not username:
        return "ุฎุทุง: ูุงู ฺฉุงุฑุจุฑ ูุดุฎุต ูุดุฏู ุงุณุช"
    
    user = find_user(username=username)
    if not user:
        return "ุฎุทุง: ฺฉุงุฑุจุฑ ุงูุช ูุดุฏ"
    
    # ุจุงุฑฺฏุฐุงุฑ ูฺฉุงูโูุง
    locations = load_data(LOCATIONS_FILE)
    
    # ุฌุงฺฏุฒู ฺฉุฑุฏู ูุชุบุฑูุง ุชููพูุช
    html = MAIN_HTML.replace('{{ username }}', username)
    html = html.replace('{{ user_city }}', user.get('city', ''))
    html = html.replace('{{ user_phone }}', user.get('phone', ''))
    
    # ุฌุงฺฏุฒู ฺฉุฑุฏู ูุณุช ุดูุฑูุง
    cities_options = ''.join([f'<option value="{city}">{city}</option>' for city in CITIES])
    html = html.replace('{% for city in cities %}', cities_options).replace('{% endfor %}', '')
    
    # ุฌุงฺฏุฒู ฺฉุฑุฏู ุฏุณุชูโุจูุฏโูุง
    categories_html = ''
    for cat, subs in CATEGORIES.items():
        categories_html += f'"{cat}": ['
        for sub in subs:
            categories_html += f'"{sub}",'
        categories_html += '],'
    html = html.replace('{% for cat, subs in categories.items() %}', '').replace('{% endfor %}', categories_html)
    
    # ุฌุงฺฏุฒู ฺฉุฑุฏู ูฺฉุงูโูุง
    locations_html = ''
    for loc in locations:
        locations_html += f'''
        <div class="location-tile" onclick="showLocationDetails('{loc["id"]}')">
            <div class="location-image" style="background-image: url('/uploads/{loc["photos"][0]}');"></div>
            <div class="location-info">
                <div class="location-title">{loc["title"]}</div>
                <div class="location-city">{loc["city"]}</div>
            </div>
        </div>
        '''
    html = html.replace('{% for loc in all_locations %}', locations_html).replace('{% endfor %}', '')
    
    return html

@app.route('/uploads/<filename>')
def uploaded_file(filename):
    """ุณุฑู ฺฉุฑุฏู ูุงูโูุง ุขูพููุฏ ุดุฏู"""
    return send_from_directory(UPLOAD_FOLDER, filename)

@app.route('/add_location', methods=['POST'])
def add_location():
    """ุงูุฒูุฏู ูฺฉุงู ุฌุฏุฏ"""
    try:
        # ุฏุฑุงูุช ุฏุงุฏูโูุง ุงุฒ ูุฑู
        title = request.form.get('title')
        city = request.form.get('city')
        address = request.form.get('address')
        phone = request.form.get('phone')
        morning_shift = request.form.get('morning_shift')
        evening_shift = request.form.get('evening_shift')
        description = request.form.get('description')
        category = request.form.get('category')
        subcategory = request.form.get('subcategory')
        owner = request.form.get('owner')
        main_photo = int(request.form.get('main_photo', 0))
        
        # ุงุนุชุจุงุฑุณูุฌ ุฏุงุฏูโูุง ุงุฌุจุงุฑ
        if not title or not city or not address or not owner:
            return jsonify({'success': False, 'message': 'ูุทูุงู ุชูุงู ููุฏูุง ุงุฌุจุงุฑ ุฑุง ูพุฑ ฺฉูุฏ'})
        
        # ุฐุฎุฑู ุนฺฉุณโูุง
        photos = []
        photo_files = request.files.getlist('photos')
        for i, photo in enumerate(photo_files):
            if photo and photo.filename:
                filename = f"{uuid.uuid4()}_{photo.filename}"
                photo.save(os.path.join(UPLOAD_FOLDER, filename))
                photos.append(filename)
        
        if not photos:
            return jsonify({'success': False, 'message': 'ูุทูุงู ุญุฏุงูู ฺฉ ุนฺฉุณ ุขูพููุฏ ฺฉูุฏ'})
        
        # ุงุฌุงุฏ ูฺฉุงู ุฌุฏุฏ
        locations = load_data(LOCATIONS_FILE)
        new_location = {
            'id': str(uuid.uuid4()),
            'title': title,
            'city': city,
            'address': address,
            'phone': phone,
            'morning_shift': morning_shift,
            'evening_shift': evening_shift,
            'description': description,
            'category': category,
            'subcategory': subcategory,
            'owner': owner,
            'photos': photos,
            'main_photo': main_photo,
            'timestamp': datetime.now().isoformat()
        }
        locations.append(new_location)
        save_data(LOCATIONS_FILE, locations)
        
        # ุงุฌุงุฏ ุงุนูุงู ุจุฑุง ฺฉุงุฑุจุฑุงู ููโุดูุฑ
        notifications = load_data(NOTIFICATIONS_FILE)
        users = load_data(USERS_FILE)
        for user in users:
            if user.get('city') == city and user.get('username') != owner:
                notifications.append({
                    'id': str(uuid.uuid4()),
                    'user': user.get('username'),
                    'title': 'ูฺฉุงู ุฌุฏุฏ',
                    'message': f'ูฺฉุงู ุฌุฏุฏ "{title}" ุฏุฑ ุดูุฑ ุดูุง ุซุจุช ุดุฏ',
                    'timestamp': datetime.now().isoformat()
                })
        save_data(NOTIFICATIONS_FILE, notifications)
        
        return jsonify({'success': True, 'message': 'ูฺฉุงู ุจุง ููููุช ุซุจุช ุดุฏ'})
    except Exception as e:
        return jsonify({'success': False, 'message': f'ุฎุทุง ุฏุฑ ุซุจุช ูฺฉุงู: {str(e)}'})

@app.route('/get_location/<location_id>')
def get_location(location_id):
    """ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉ ูฺฉุงู"""
    locations = load_data(LOCATIONS_FILE)
    location = next((loc for loc in locations if loc['id'] == location_id), None)
    if location:
        return jsonify({'success': True, 'location': location})
    else:
        return jsonify({'success': False, 'message': 'ูฺฉุงู ุงูุช ูุดุฏ'})

@app.route('/add_comment', methods=['POST'])
def add_comment():
    """ุงูุฒูุฏู ูุธุฑ ุจู ูฺฉุงู"""
    data = request.get_json()
    location_id = data.get('location_id')
    text = data.get('text')
    rating = data.get('rating')
    user = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    
    if not location_id or not text or not rating or not user:
        return jsonify({'success': False, 'message': 'ูุทูุงู ุชูุงู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ'})
    
    comments = load_data(COMMENTS_FILE)
    new_comment = {
        'id': str(uuid.uuid4()),
        'location_id': location_id,
        'user': user,
        'text': text,
        'rating': rating,
        'timestamp': datetime.now().isoformat()
    }
    comments.append(new_comment)
    save_data(COMMENTS_FILE, comments)
    
    return jsonify({'success': True, 'message': 'ูุธุฑ ุจุง ููููุช ุซุจุช ุดุฏ'})

@app.route('/get_comments/<location_id>')
def get_comments(location_id):
    """ุฏุฑุงูุช ูุธุฑุงุช ฺฉ ูฺฉุงู"""
    comments = load_data(COMMENTS_FILE)
    location_comments = [comment for comment in comments if comment['location_id'] == location_id]
    return jsonify({'success': True, 'comments': location_comments})

@app.route('/get_chats')
def get_chats():
    """ุฏุฑุงูุช ูุณุช ฺุชโูุง"""
    user = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    if not user:
        return jsonify({'success': False, 'message': 'ฺฉุงุฑุจุฑ ูุดุฎุต ูุดุฏู ุงุณุช'})
    
    chats = load_data(CHAT_FILE)
    user_chats = []
    partners = set()
    
    # ูพุฏุง ฺฉุฑุฏู ููู ฺุชโูุง ฺฉุงุฑุจุฑ
    for chat in chats:
        if chat['sender'] == user or chat['receiver'] == user:
            partner = chat['receiver'] if chat['sender'] == user else chat['sender']
            if partner not in partners:
                partners.add(partner)
                user_chats.append({
                    'partner': partner,
                    'last_message': chat['text']
                })
    
    return jsonify({'success': True, 'chats': user_chats})

@app.route('/get_chat/<partner>')
def get_chat(partner):
    """ุฏุฑุงูุช ูพุงูโูุง ฺฉ ฺุช ุฎุงุต"""
    user = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    if not user:
        return jsonify({'success': False, 'message': 'ฺฉุงุฑุจุฑ ูุดุฎุต ูุดุฏู ุงุณุช'})
    
    chats = load_data(CHAT_FILE)
    chat_messages = [chat for chat in chats if 
                     (chat['sender'] == user and chat['receiver'] == partner) or 
                     (chat['sender'] == partner and chat['receiver'] == user)]
    
    # ูุฑุชุจโุณุงุฒ ูพุงูโูุง ุจุฑ ุงุณุงุณ ุฒูุงู
    chat_messages.sort(key=lambda x: x['timestamp'])
    
    return jsonify({'success': True, 'messages': chat_messages})

@app.route('/send_message', methods=['POST'])
def send_message():
    """ุงุฑุณุงู ูพุงู ุฏุฑ ฺุช"""
    data = request.get_json()
    partner = data.get('partner')
    text = data.get('text')
    sender = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    
    if not partner or not text or not sender:
        return jsonify({'success': False, 'message': 'ูุทูุงู ุชูุงู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ'})
    
    chats = load_data(CHAT_FILE)
    new_message = {
        'id': str(uuid.uuid4()),
        'sender': sender,
        'receiver': partner,
        'text': text,
        'timestamp': datetime.now().isoformat()
    }
    chats.append(new_message)
    save_data(CHAT_FILE, chats)
    
    return jsonify({'success': True, 'message': 'ูพุงู ุจุง ููููุช ุงุฑุณุงู ุดุฏ'})

@app.route('/get_notifications')
def get_notifications():
    """ุฏุฑุงูุช ุงุนูุงูโูุง"""
    user = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    if not user:
        return jsonify({'success': False, 'message': 'ฺฉุงุฑุจุฑ ูุดุฎุต ูุดุฏู ุงุณุช'})
    
    notifications = load_data(NOTIFICATIONS_FILE)
    user_notifications = [notif for notif in notifications if notif['user'] == user]
    
    # ูุฑุชุจโุณุงุฒ ุงุนูุงูโูุง ุจุฑ ุงุณุงุณ ุฒูุงู (ุฌุฏุฏุชุฑู ุงูู)
    user_notifications.sort(key=lambda x: x['timestamp'], reverse=True)
    
    return jsonify({'success': True, 'notifications': user_notifications})

@app.route('/update_profile', methods=['POST'])
def update_profile():
    """ุจุฑูุฒุฑุณุงู ูพุฑููุงู ฺฉุงุฑุจุฑ"""
    data = request.get_json()
    field = data.get('field')
    value = data.get('value')
    username = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    
    if not field or not value or not username:
        return jsonify({'success': False, 'message': 'ูุทูุงู ุชูุงู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ'})
    
    users = load_data(USERS_FILE)
    user_index = next((i for i, user in enumerate(users) if user['username'] == username), None)
    
    if user_index is None:
        return jsonify({'success': False, 'message': 'ฺฉุงุฑุจุฑ ุงูุช ูุดุฏ'})
    
    # ุงุนุชุจุงุฑุณูุฌ ุจุฑ ุงุณุงุณ ููุฏ
    if field == 'phone' and not validate_phone(value):
        return jsonify({'success': False, 'message': 'ูุทูุงู ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ'})
    
    if field == 'password' and not validate_password(value):
        return jsonify({'success': False, 'message': 'ุฑูุฒ ุนุจูุฑ ุจุงุฏ ุญุฏุงูู ถ ฺฉุงุฑุงฺฉุชุฑ ุฏุงุดุชู ุจุงุดุฏ'})
    
    # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุจุฑุฑุณ ุชฺฉุฑุงุฑ ุจูุฏู ูุงู ฺฉุงุฑุจุฑ ู ุดูุงุฑู ุชููู ุงูุฌุงู ุดูุฏ
    
    users[user_index][field] = value
    save_data(USERS_FILE, users)
    
    return jsonify({'success': True, 'message': 'ูพุฑููุงู ุจุง ููููุช ุจุฑูุฒุฑุณุงู ุดุฏ'})

@app.route('/logout', methods=['POST'])
def logout():
    """ุฎุฑูุฌ ุงุฒ ุญุณุงุจ ฺฉุงุฑุจุฑ"""
    # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุณุดู ูพุงฺฉ ุดูุฏ
    return jsonify({'success': True, 'message': 'ุฎุฑูุฌ ุงุฒ ุญุณุงุจ ุจุง ููููุช ุงูุฌุงู ุดุฏ'})

@app.route('/my_locations')
def my_locations():
    """ุฏุฑุงูุช ูฺฉุงูโูุง ุซุจุช ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ"""
    username = request.args.get('username')  # ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุงูุน ุจุงุฏ ุงุฒ ุณุดู ุงุณุชูุงุฏู ุดูุฏ
    if not username:
        return jsonify({'success': False, 'message': 'ฺฉุงุฑุจุฑ ูุดุฎุต ูุดุฏู ุงุณุช'})
    
    locations = load_data(LOCATIONS_FILE)
    user_locations = [loc for loc in locations if loc['owner'] == username]
    
    return jsonify({'success': True, 'locations': user_locations})

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)