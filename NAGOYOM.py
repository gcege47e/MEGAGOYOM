import telebot
from telebot import types
import sqlite3
import random
import re
import threading
import time
import os
from flask import Flask, request

# ุชูุธูุงุช
API_TOKEN = "8158514610:AAG6QYu1tlOuh6BkbjhojAkjRl3cCAP31Ao"
ADMIN_ID = 7385601641
DB_NAME = "goyim.db"
WEBHOOK_URL = "https://goyomnama.onrender.com"
PORT = 5000

# ุชูุธู ุฑุจุงุช
bot = telebot.TeleBot(API_TOKEN, threaded=True)
app = Flask(__name__)

# ุงุณุชฺฉุฑูุง ูุฎุตูุต
EMOJIS = {
    "profile": "๐ค",
    "places": "๐",
    "back": "๐",
    "home": "๐",
    "edit": "โ๏ธ",
    "delete": "๐๏ธ",
    "add": "โ",
    "view": "๐๏ธ",
    "success": "โ",
    "error": "โ",
    "info": "โน๏ธ",
    "star": "โญ",
    "admin": "๐ง",
    "news": "๐ฐ",
    "help": "โ",
    "link": "๐",
    "document": "๐",
    "warning": "โ๏ธ",
    "rating": "๐",
    "group": "๐ฅ",
    "user": "๐ค",
    "score": "๐",
    "add_score": "โฌ๏ธ",
    "remove_score": "โฌ๏ธ"
}

# ูพุงู ุฎูุดโุขูุฏฺฏู ู ููุงูู
WELCOME_MESSAGE = f"""
{EMOJIS['home']} ุจู ุฑุจุงุช ฺฏููโููุง ุฎูุด ุขูุฏุฏ! {EMOJIS['success']}

ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุงู ุฑุจุงุชุ ูุทูุงู ููุงูู ุฒุฑ ุฑุง ูุทุงูุนู ู ุชุฃุฏ ฺฉูุฏ:

{EMOJIS['info']} ููุงูู ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุช:
1. ุฏุฑ ุตูุฑุช ฺฉู ุตุงุญุจ ฺฉ ูฺฉุงู ูุณุชุฏุ ูุณุฆููุช ูุฑฺฏููู ูุดฺฉู ุง ุงุชูุงู ูุฑุชุจุท ุจุง ูฺฉุงู ุซุจุชโุดุฏู ุจุฑ ุนูุฏู ุดูุงุณุช.
2. ุงุฒ ุงุฑุณุงู ูุญุชูุง ุบุฑุงุฎูุงูุ ุชูููโุขูุฒ ุง ููุถโฺฉููุฏู ููุงูู ุฑุจุงุช ุฌุฏุงู ุฎูุฏุฏุงุฑ ฺฉูุฏ.
3. ุงุทูุงุนุงุช ูฺฉุงูโูุง ุฑุง ุจุง ุฏูุช ู ุตุญุช ูุงุฑุฏ ฺฉูุฏ.
4. ูุฑฺฏููู ุณูุกุงุณุชูุงุฏู ุงุฒ ุงุทูุงุนุงุช ูฺฉุงูโูุง ููููุน ุจูุฏู ู ููุฌุฑ ุจู ูุณุฏูุฏ ุดุฏู ุญุณุงุจ ฺฉุงุฑุจุฑ ุดูุง ุฎูุงูุฏ ุดุฏ.
5. ุฏุฑ ุตูุฑุช ููุถ ููุงููุ ุญุณุงุจ ุดูุง ูุณุฏูุฏ ุดุฏู ู ุจุฑุง ุฑูุน ูุณุฏูุฏุช ูุงุฒ ุจู ูพุฑุฏุงุฎุช ูุฒููโุง ุงูุฏฺฉ ุฎูุงูุฏ ุจูุฏ.

{EMOJIS['warning']} ุชูุฌู: ูุฑฺฏููู ุงุณุชูุงุฏู ุบุฑูุฌุงุฒ ุงุฒ ุงุทูุงุนุงุช ูฺฉุงูโูุง ูพฺฏุฑุฏ ูุงููู ุฏุงุฑุฏ.

ูุทูุงู ุจุง ุฏูุช ููุงูู ุฑุง ูุทุงูุนู ฺฉุฑุฏู ู ฺฏุฒูู ููุงุณุจ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:
"""

# ูุชุบุฑูุง ุญุงูุช ฺฉุงุฑุจุฑ
user_states = {}
user_data = {}
blocked_users = set()

# ุชูุธู ูพุงฺฏุงู ุฏุงุฏู
def init_db():
    conn = sqlite3.connect(DB_NAME)
    c = conn.cursor()
    c.execute('''CREATE TABLE IF NOT EXISTS users (
                 user_id INTEGER PRIMARY KEY,
                 name TEXT,
                 age INTEGER,
                 gender TEXT,
                 score INTEGER DEFAULT 0,
                 numeric_id INTEGER UNIQUE)''')
    c.execute('''CREATE TABLE IF NOT EXISTS places (
                 place_id INTEGER PRIMARY KEY AUTOINCREMENT,
                 user_id INTEGER,
                 category TEXT,
                 subcategory TEXT,
                 title TEXT,
                 description TEXT,
                 address TEXT,
                 phone TEXT,
                 photo TEXT,
                 morning_shift TEXT,
                 afternoon_shift TEXT,
                 rating_sum INTEGER DEFAULT 0,
                 rating_count INTEGER DEFAULT 0)''')
    c.execute('''CREATE TABLE IF NOT EXISTS place_ratings (
                 place_id INTEGER,
                 user_id INTEGER,
                 rating INTEGER,
                 PRIMARY KEY (place_id, user_id))''')
    c.execute('''CREATE TABLE IF NOT EXISTS news (
                 news_id INTEGER PRIMARY KEY AUTOINCREMENT,
                 content TEXT)''')
    try:
        c.execute("ALTER TABLE places ADD COLUMN subcategory TEXT")
    except sqlite3.OperationalError:
        pass
    conn.commit()
    conn.close()

init_db()

# ุฏุณุชูโุจูุฏ ูฺฉุงูโูุง
PLACE_CATEGORIES = {
    "๐ฝ๏ธ ุฎูุฑุงฺฉ ู ููุดุฏู": [
        "ุฑุณุชูุฑุงูโูุง (ุณูุชุ ูุณุช ููุฏุ ุจูโุงููููุ ุฏุฑุงุ ฺฏุงูุฎูุงุฑ)",
        "ฺฉุงูู ู ฺฉุงูโุดุงูพ (ฺฉุงููโุฑุณุชูุฑุงูุ ูููู ุชุฎุตุต)",
        "ุจุณุชูโูุฑูุด ู ุขุจูููโูุฑูุด (ุจุณุชู ุณูุชุ ุจุณุชู ุงุชุงูุง)",
        "ุดุฑูโูพุฒ ู ูุงููุง (ูุงููุง ุณูุชุ ุดุฑูโูพุฒ ููุงุฏ)",
        "ุณูุฑูโุฎุงูู ู ฺุงุฎุงูู (ูููู ุฎุงูู ุณูุชุ ฺุงุฎุงูู ูุฏุฑู)",
        "ููุฏฺฉูุฑุช ู ูุฑุงฺฉุฒ ุบุฐุงุฎูุฑ",
        "ฺฉุจุงุจ ู ุฌฺฏุฑฺฉ (ฺฉุจุงุจโูุฑูุดุ ุฌฺฏุฑฺฉุ ุฏุฒโุณุฑุง)",
        "ุณุงูุฏูฺโูุฑูุด ู ูพุชุฒุงูุฑูุด (ูพุชุฒุงูุฑูุดุ ุณุงูุฏูฺโูุฑูุด ูุญู)",
        "ููุงุฏ ู ุดฺฉูุงุชโูุฑูุด (ุดฺฉูุงุชโูุฑูุด ุชุฎุตุตุ ุขุจูุจุงุชโูุฑูุด)",
        "ุขุฌูโูุฑูุด ู ุฎุดฺฉุจุงุฑ (ุขุฌูโูุฑูุดุ ุฎุดฺฉุจุงุฑูุฑูุด)",
        "ุณููพุฑูุงุฑฺฉุช ูุญู ู ูุงูพุฑ",
        "ูุตุงุจ ู ูุฑุบ ูุฑูุด (ูุตุงุจุ ูุฑุบโูุฑูุดุ ูุงูโูุฑูุด)",
        "ูููโูุฑูุด ู ุชุฑูโุจุงุฑ (ูููโูุฑูุดุ ุณุจุฒโูุฑูุด)",
        "ูุงูโูุฑูุด ู ุบุฐุงูุง ุฏุฑุง",
        "ูุฑูุดฺฏุงู ููุงุฏ ุบุฐุง ูุญู",
        "ุนุณูโูุฑูุด ู ูุญุตููุงุช ุฒูุจูุฑุฏุงุฑ",
        "ูุญุตููุงุช ูุญู ู ููุทููโุง",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุงุฑฺฏุงูฺฉ",
        "ูุฑูุดฺฏุงู ููุงุฏ ุบุฐุง ููุฌูุฏ",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ูุจู ู ูพูุฑ",
        "ูุงูโูุฑูุด ุชุฎุตุต (ูุงู ุจุงฺฏุชุ ูุงู ุณูฺฏฺฉ)",
        "ุบุฐุงูุง ูุญู ู ุบุฐุงูุง ููู"
    ],
    "๐๏ธ ุฎุฑุฏ ู ูุฑูุด": [
        "ูพุงุณุงฺูุง ู ูุฑุงฺฉุฒ ุฎุฑุฏ (ูุงูุ ูุฑฺฉุฒ ุฎุฑุฏุ ุจุงุฒุงุฑฺู)",
        "ุณููพุฑูุงุฑฺฉุช ู ูุงูพุฑูุงุฑฺฉุช (ุฒูุฌุฑูโุงุ ูุญู)",
        "ูุฑูุดฺฏุงู ุฒูุฌุฑูโุง",
        "ุจุงุฒุงุฑ ุณูุช ู ุจุงุฒุงุฑฺูโูุง ูุญู (ุจุงุฒุงุฑ ุฑูุฒุ ุจุงุฒุงุฑ ููุชฺฏ)",
        "ูุฑูุดฺฏุงู ูพูุดุงฺฉ ู ฺฉู ู ฺฉูุด (ูุจุงุณ ูุฑุฏุงููุ ุฒูุงููุ ุจฺฺฏุงูู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุฎุงูฺฏ ู ุงูฺฉุชุฑููฺฉ (ููุงุฒู ุจุฑูุ ุฏุฌุชุงู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ูุฑุฒุด (ูุฑุฒุดุ ฺฉููููุฑุฏุ ุดูุง)",
        "ฺฉุชุงุจโูุฑูุด ู ููุงุฒู ุงูุชุญุฑุฑ (ฺฉุชุงุจโูุฑูุด ุนูููุ ุชุฎุตุต)",
        "ูุบุงุฒู ููุจุงู ู ููพโุชุงูพ (ูุฑูุดุ ุชุนูุฑุ ููุงุฒู ุฌุงูุจ)",
        "ฺฏูโูุฑูุด ู ฺฏุงูุงู ุขูพุงุฑุชูุงู (ฺฏูโูุฑูุดุ ฺฏูโุขุฑุง)",
        "ุนูฺฉโูุฑูุด ู ุงูพุชฺฉ (ุนูฺฉโูุฑูุดุ ุนูฺฉโุณุงุฒ)",
        "ุนุทุฑ ู ุงุฏฺฉูู ูุฑูุด (ุนุทุฑ ูุฑูุดุ ูุญุตููุงุช ุขุฑุงุด)",
        "ุทูุง ู ุฌูุงูุฑ ูุฑูุด (ุทูุงูุฑูุดุ ุฌูุงูุฑูุฑูุด)",
        "ุณุงุนุชโูุฑูุด (ุณุงุนุช ูฺุ ุฏูุงุฑ)",
        "ููุงุฒู ุขุฑุงุด ู ุจูุฏุงุดุช (ุขุฑุงุดุ ุจูุฏุงุดุชุ ูุฑุงูุจุช ูพูุณุช)",
        "ุงุณุจุงุจโุจุงุฒโูุฑูุด (ุงุณุจุงุจโุจุงุฒุ ุจุงุฒ ูฺฉุฑ)",
        "ุตูุงุนโุฏุณุช ู ุณูุบุงุชโูุฑูุด (ุตูุงุน ุฏุณุชุ ุณูุบุงุช)",
        "ุฏฺฉูุฑุงุณูู ู ููุงุฒู ููุฒู (ุฏฺฉูุฑุงุณููุ ููุงุฒู ุชุฒุฆู)",
        "ูุฑุด ู ฺฏูู ูุฑูุด (ูุฑุดโูุฑูุดุ ฺฏููโูุฑูุด)",
        "ูพุงุฑฺูโูุฑูุด ู ุฎุงุท (ูพุงุฑฺูโูุฑูุดุ ุฎุงุท)",
        "ฺุฑูโูุฑูุด ู ฺฉูโุณุงุฒ (ฺุฑูโูุฑูุดุ ฺฉูโุฏูุฒ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุขุดูพุฒุฎุงูู (ุธุฑููุ ููุงุฒู ุขุดูพุฒ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุจุงุบุจุงู (ููุงุฒู ุจุงุบุจุงูุ ููุงู)",
        "ูุฑูุดฺฏุงู ุญูุงูุงุช ุฎุงูฺฏ (ุญูุงูุงุชุ ุบุฐุง ุญูุงูุงุช)",
        "ูุฑูุดฺฏุงู ุฏูฺุฑุฎู ู ุงุณฺฉูุชุฑ (ุฏูฺุฑุฎูุ ุงุณฺฉูุชุฑุ ููุงุฒู)",
        "ูุฑูุดฺฏุงู ุงุจุฒุงุฑุขูุงุช (ุงุจุฒุงุฑ ุตูุนุชุ ุฏุณุช)",
        "ูุฑูุดฺฏุงู ฺฉุงููพูุชุฑ ู ฺฏู (ฺฉุงููพูุชุฑุ ฺฉูุณูู ุจุงุฒ)",
        "ูุฑูุดฺฏุงู ูุจุงุณ ุนุฑูุณ ู ูุฑุงุณู",
        "ูุฑูุดฺฏุงู ฺฉุงุฏู ู ูุฏู",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ูุฑููฺฏ (ุณ ุฏุ ุฏ ู ุฏุ ุขุซุงุฑ ููุฑ)",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุฏุณุชโุฏูู",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุณูุงูุช ู ุชูุฏุฑุณุช",
        "ูุฑูุดฺฏุงู ูุญุตููุงุช ุฑูุณุชุง ู ูุญู"
    ],
    "โ๏ธ ุฒุจุง ู ุขุฑุงุด": [
        "ุขุฑุงุดฺฏุงู ูุฑุฏุงูู (ุขุฑุงุดฺฏุงูุ ุงุตูุงุญ)",
        "ุขุฑุงุดฺฏุงู ุฒูุงูู (ุขุฑุงุดุ ุฑูฺฏ ูู)",
        "ุณุงููโูุง ุฒุจุง ู ุงุณูพุง (ุงุณูพุงุ ูุงุณุงฺ)",
        "ูฺู ู ุงุจุฑู (ุงฺฉุณุชูุดู ูฺูุ ูฺฉุฑูุจูุฏูฺฏ)",
        "ูุงุฎูโฺฉุงุฑ (ูุงูฺฉูุฑุ ูพุฏฺฉูุฑุ ูุงุฎู ูุตููุน)",
        "ุชุชู ู ูฺฉุฑููพฺฏููุชุดู (ุชุงุชูุ ูฺฉุฑููพฺฏููุชุดู)",
        "ุณุงููโูุง ุชุงุชู ู ูพุฑุณูฺฏ (ูพุฑุณูฺฏุ ุชุงุชู ุญูุง)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพูุณุช ู ูู (ูพุงฺฉุณุงุฒ ูพูุณุชุ ูุฒุฑ)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุขุฑุงุด ุญุฑููโุง",
        "ูุฑุงฺฉุฒ ูุงุณุงฺ ู ุฑูฺฉุณุดู (ูุงุณุงฺ ุฏุฑูุงูุ ุฑูฺฉุณุดู)",
        "ูุฑุงฺฉุฒ ุงูพูุงุณูู ู ูุฒุฑ",
        "ุณุงููโูุง ุจุฑูุฒู ฺฉุฑุฏู",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ุฒุจุง",
        "ุขููุฒุดฺฏุงูโูุง ุขุฑุงุดฺฏุฑ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุจูุฏุงุดุช ูุฑุฏุงูู"
    ],
    "๐ฅ ุฏุฑูุงู ู ุณูุงูุช": [
        "ุจูุงุฑุณุชุงู ู ูุฑุงฺฉุฒ ุฏุฑูุงู (ุนูููุ ุชุฎุตุตุ ุฎุตูุต)",
        "ุฏุฑูุงูฺฏุงู ู ฺฉููฺฉโูุง ุชุฎุตุต (ุฎุงููุงุฏูุ ุฒูุงูุ ููุจ)",
        "ุฏุงุฑูุฎุงูู (ุดุจุงููโุฑูุฒุ ฺฏุงู)",
        "ุฏูุฏุงูโูพุฒุดฺฉ ู ุงุฑุชูุฏูุณ (ุนูููุ ุชุฎุตุตุ ุฒุจุง)",
        "ุขุฒูุงุดฺฏุงู ูพุฒุดฺฉ ู ุฑุงุฏูููฺ (ุขุฒูุงุดฺฏุงูุ ุณูููฺฏุฑุงู)",
        "ฺฉููฺฉ ุฒุจุง ู ูุฒุฑ (ูุฒุฑุ ุจูุชุงฺฉุณุ ฺู)",
        "ูุฑุงฺฉุฒ ูุฒูุชุฑุงูพ ู ฺฉุงุฑุฏุฑูุงู (ูุฒูุชุฑุงูพุ ฺฉุงุฑุฏุฑูุงู)",
        "ุฏุงููพุฒุดฺฉ ู ฺฉููฺฉ ุญูุงูุงุช (ุฏุงููพุฒุดฺฉุ ุญูุงูุงุช ุฎุงูฺฏ)",
        "ูุฑุงฺฉุฒ ุชูุงูุจุฎุด (ุชูุงูุจุฎุดุ ฺฏูุชุงุฑุฏุฑูุงู)",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ู ุฑูุงูุดูุงุณ (ูุดุงูุฑูุ ุฑูุงูุดูุงุณ)",
        "ุดููุงโุณูุฌ ู ุณูุนฺฉ (ุณูุนฺฉุ ุดููุงโุณูุฌ)",
        "ุจูุงโุณูุฌ ู ุนูฺฉโุณุงุฒ (ุจูุงโุณูุฌุ ุนูฺฉโุณุงุฒ)",
        "ูพุฑุณุชุงุฑ ุฏุฑ ููุฒู (ูพุฑุณุชุงุฑุ ูพุฒุดฺฉ ุฏุฑ ููุฒู)",
        "ุชุฌูุฒุงุช ูพุฒุดฺฉ (ูุฑูุดุ ุงุฌุงุฑู)",
        "ูุฑุงฺฉุฒ ุงูุฏุง ุฎูู",
        "ูุฑุงฺฉุฒ ุทุจ ุณูุช ู ฺฏุงูุงู ุฏุงุฑู",
        "ูุฑุงฺฉุฒ ูุงุณุงฺ ุฏุฑูุงู",
        "ูุฑุงฺฉุฒ ุชุฑฺฉ ุงุนุชุงุฏ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฑุณุชุงุฑ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฒุดฺฉ ุณุงุฑ",
        "ูุฑุงฺฉุฒ ุชุตูุฑุจุฑุฏุงุฑ ูพุฒุดฺฉ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุฒุดฺฉ ูุฑุฒุด"
    ],
    "โฝ ูุฑุฒุด ู ุณุฑฺฏุฑู": [
        "ุจุงุดฺฏุงู ูุฑุฒุด ู ุจุฏูุณุงุฒ (ุจุฏูุณุงุฒุ ฺฉุฑุงุณูุช)",
        "ุงุณุชุฎุฑ ู ูุฌููุนู ูุฑุฒุด (ุงุณุชุฎุฑุ ุณููุงุ ุฌฺฉูุฒ)",
        "ุณุงูู ููุชุณุงู ู ุจุณฺฉุชุจุงู (ููุชุณุงูุ ุจุณฺฉุชุจุงูุ ูุงูุจุงู)",
        "ุณููุง ู ุชุฆุงุชุฑ (ุณููุงุ ุชุฆุงุชุฑุ ููุงุด)",
        "ุดูุฑุจุงุฒ ู ูพุงุฑฺฉ ุจุงุฒ (ุดูุฑุจุงุฒุ ูพุงุฑฺฉ ุจุงุฒ)",
        "ุจูุงุฑุฏ ู ุจูููฺฏ (ุจูุงุฑุฏุ ุจูููฺฏุ ุฏุงุฑุช)",
        "ูุฑุงฺฉุฒ ุชูุฑุญ ุฎุงููุงุฏฺฏ (ุชูุฑุญุ ุจุงุฒ)",
        "ูุฑุงฺฉุฒ ูุฑููฺฏ ู ููุฑ (ูุฑููฺฏุ ููุฑ)",
        "ุณุงููโูุง ฺฉูุณุฑุช ู ููุงุด (ฺฉูุณุฑุชุ ููุงุด)",
        "ฺฏูโูุช ู ูุฑุงฺฉุฒ ุจุงุฒ (ฺฏูโูุชุ ุจุงุฒ ฺฉุงููพูุชุฑ)",
        "ุจุงุดฺฏุงู ุชุฑุงูุฏุงุฒ (ุชุฑุงูุฏุงุฒุ ฺฉูุงูโุงูุฏุงุฒ)",
        "ุจุงุดฺฏุงู ุณููุง ู ุฎุงูู ููู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุณู (ุขููุฒุด ููุณูุ ููุงุฒูุฏฺฏ)",
        "ฺฉุชุงุจุฎุงูู ุนููู (ุนูููุ ุชุฎุตุต)",
        "ูฺฏุงุฑุฎุงูู ู ููุงุดฺฏุงู ููุฑ (ูฺฏุงุฑุฎุงููุ ููุงุดฺฏุงู)",
        "ูุฑุงฺฉุฒ ุจุงุฒ ุงุชุงู ูุฑุงุฑ",
        "ูุฑุงฺฉุฒ ูพูุช ุจุงู ู ูุฒุฑุชฺฏ",
        "ุจุงุดฺฏุงูโูุง ุฑูุต ู ุจุงูู",
        "ูุฑุงฺฉุฒ ูฺฏุง ู ูุฏุชุดู",
        "ุจุงุดฺฏุงูโูุง ูุฑุฒุดโูุง ุฑุฒู",
        "ูุฑุงฺฉุฒ ุงุณฺฉุช ู ุฑููุฑ",
        "ุจุงุดฺฏุงูโูุง ุจูฺฉุณ ู ููุฑูุง ุฑุฒู ุชุฑฺฉุจ",
        "ูุฑุงฺฉุฒ ูุฑุฒุดโูุง ุขุจ",
        "ุจุงุดฺฏุงูโูุง ฺฏูู ู ุชูุณ",
        "ูุฑุงฺฉุฒ ูุงูฺฏุฑ ู ุดฺฉุงุฑ",
        "ุจุงุดฺฏุงูโูุง ุณูุงุฑฺฉุงุฑ"
    ],
    "๐จ ุงูุงูุช ู ุณูุฑ": [
        "ูุชู ู ูุชู ุขูพุงุฑุชูุงู (ูุชูุ ูุชู ุขูพุงุฑุชูุงู)",
        "ูุณุงูุฑุฎุงูู ู ูููุงููพุฐุฑ (ูุณุงูุฑุฎุงููุ ูููุงููพุฐุฑ)",
        "ุงูุงูุชฺฏุงู ุจููโฺฏุฑุฏ (ุจููโฺฏุฑุฏุ ุงูุงูุชฺฏุงู ูุญู)",
        "ููุง ู ุณูุฆุช ุงุฌุงุฑูโุง (ููุงุ ุณูุฆุช)",
        "ฺฉููพูฺฏ ู ุงุฑุฏูฺฏุงู (ฺฉููพูฺฏุ ุงุฑุฏูฺฏุงู)",
        "ุขฺุงูุณ ูุณุงูุฑุช ู ฺฏุฑุฏุดฺฏุฑ (ูุณุงูุฑุชุ ฺฏุฑุฏุดฺฏุฑ)",
        "ุงุณุชฺฏุงู ูุทุงุฑ ู ุงุชูุจูุณ (ูุทุงุฑุ ุงุชูุจูุณ)",
        "ูุฑูุฏฺฏุงู ู ูพุงุงูู ูุณุงูุฑ (ูุฑูุฏฺฏุงูุ ูพุงุงูู)",
        "ูุฑุงฺฉุฒ ุฑุฒุฑูุงุณูู (ุฑุฒุฑู ูุชูุ ุจูุท)",
        "ุฎุฏูุงุช ูุฒุง ู ูพุงุณูพูุฑุช (ูุฒุงุ ูพุงุณูพูุฑุช)",
        "ุงุฌุงุฑู ุฎูุฏุฑู ู ุฏูฺุฑุฎู (ุงุฌุงุฑู ูุงุดูุ ุฏูฺุฑุฎู)",
        "ุฑุงูููุงุงู ฺฏุฑุฏุดฺฏุฑ (ุชูุฑูุฏุฑุ ุฑุงูููุง)",
        "ูุฑุงฺฉุฒ ุงุทูุงุนุงุช ฺฏุฑุฏุดฺฏุฑ",
        "ุฎุฏูุงุช ุชุฑุฌูู ู ุฑุงูููุง ูุญู",
        "ูุฑุงฺฉุฒ ฺฉุฑุงู ุงุชููุจู",
        "ุฎุฏูุงุช ุงูุชูุงู ูุณุงูุฑ (ุญูู ู ูููุ ุชุฑุงูุณูุฑ)",
        "ูุฑุงฺฉุฒ ุฑุฒุฑูุงุณูู ุขููุงู",
        "ุฎุฏูุงุช ุจูู ูุณุงูุฑุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุฌูุงูฺฏุฑุฏ"
    ],
    "๐๏ธ ุฎุฏูุงุช ุนููู ู ุงุฏุงุฑ": [
        "ุจุงูฺฉ ู ุฎูุฏูพุฑุฏุงุฒ (ุจุงูฺฉุ ุตุฑุงู)",
        "ุงุฏุงุฑู ูพุณุช (ูพุณุชุ ูพฺฉ ููุชูุฑ)",
        "ุฏูุงุชุฑ ูพุดุฎูุงู ุฎุฏูุงุช ุฏููุช (ูพุดุฎูุงูุ ุฎุฏูุงุช ุงูฺฉุชุฑููฺฉ)",
        "ุดูุฑุฏุงุฑ ู ูุฑุงฺฉุฒ ุฎุฏูุงุช ุดูุฑ (ุดูุฑุฏุงุฑุ ุฎุฏูุงุช ุดูุฑ)",
        "ุงุฏุงุฑู ุจุฑูุ ุขุจุ ฺฏุงุฒ (ุจุฑูุ ุขุจุ ฺฏุงุฒ)",
        "ูพูุณ +ฑฐ ู ูุฑุงฺฉุฒ ุงูุชุธุงู (ูพูุณุ ุงูุชุธุงู)",
        "ุฏุงุฏฺฏุงู ู ูุฑุงุฌุน ูุถุง (ุฏุงุฏฺฏุงูุ ูุถุง)",
        "ฺฉูุงูุชุฑ ู ูพุงุณฺฏุงู (ฺฉูุงูุชุฑุ ูพุงุณฺฏุงู)",
        "ุฏูุงุชุฑ ุงุณูุงุฏ ุฑุณู (ุงุณูุงุฏ ุฑุณูุ ุฏูุชุฑุฎุงูู)",
        "ูุฑุงฺฉุฒ ุตุฏูุฑ ฺฏูุงููุงูู (ฺฏูุงููุงููุ ูุฏุงุฑฺฉ)",
        "ุงุฏุงุฑุงุช ุฏููุช ู ูุฒุงุฑุชุฎุงููโูุง (ุฏููุชุ ูุฒุงุฑุชุฎุงูู)",
        "ฺฉูุณููฺฏุฑ ู ุณูุงุฑุชุฎุงููโูุง (ุณูุงุฑุชุ ฺฉูุณููฺฏุฑ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงูฺฉุชุฑููฺฉ (ุฎุฏูุงุช ุขููุงูุ ุฏููุช ุงูฺฉุชุฑููฺฉ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุดุงูุฑู ุดุบู",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ูุณฺฉู ู ุงููุงฺฉ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุญููู ู ูุถุง",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ููุงุฌุฑุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุงู ู ุญุณุงุจุฏุงุฑ",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ุจููโุง",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชุนูุฑุงุช ุดูุฑ",
        "ุฏูุงุชุฑ ุฎุฏูุงุช ูพูุงูฺฉุงุฑ"
    ],
    "๐ ุฎุฏูุงุช ุดูุฑ ู ุญููโูููู": [
        "ูพููพ ุจูุฒู ู CNG (ุจูุฒูุ ฺฏุงุฒ)",
        "ฺฉุงุฑูุงุด ู ุฎุฏูุงุช ุฎูุฏุฑู (ฺฉุงุฑูุงุดุ ุจุฑุงูโุณุงุฒ)",
        "ุชุนูุฑฺฏุงู ุฎูุฏุฑู ู ููุชูุฑุณฺฉูุช (ุชุนูุฑฺฏุงูุ ูฺฉุงูฺฉ)",
        "ุชุงฺฉุณโุณุฑูุณ ู ุชุงฺฉุณ ุงูุชุฑูุช (ุชุงฺฉุณุ ุงุณููพ)",
        "ูพุงุฑฺฉูฺฏ ุนููู (ูพุงุฑฺฉูฺฏุ ุฌุง ูพุงุฑฺฉ)",
        "ูฺฉุงูฺฉ ู ุจุฑู ุฎูุฏุฑู (ูฺฉุงูฺฉุ ุจุฑู ุฎูุฏุฑู)",
        "ูุงุณุชฺฉโูุฑูุด ู ูุฑูุด ููุงุฒู ุฏฺฉ (ูุงุณุชฺฉุ ููุงุฒู ุฏฺฉ)",
        "ุฎุฏูุงุช ููุงุด ู ุชุฑูู ุฎูุฏุฑู (ููุงุดุ ุชุฑูู)",
        "ูุฑุงฺฉุฒ ูุนุงูู ูู (ูุนุงูู ููุ ุชุณุช ุฎูุฏุฑู)",
        "ุฎุฏูุงุช ุงูุฏุงุฏ ุฎูุฏุฑู (ุฎุฏูุงุช ุงูุฏุงุฏุ ุฏฺฉโฺฉุด)",
        "ููุงูุฏฺฏ ุฎูุฏุฑู (ููุงูุฏฺฏุ ูุฑูุด ุฎูุฏุฑู)",
        "ูุฑูุดฺฏุงู ููุงุฒู ุฌุงูุจ ุฎูุฏุฑู (ููุงุฒู ุฌุงูุจุ ุชุฒุฆูุงุช)",
        "ุฎุฏูุงุช ุชูุธู ููุชูุฑ ู ุงูฺฺฉุชูุฑ",
        "ุฎุฏูุงุช ุตุงูฺฉุงุฑ ู ุฌููุจูุฏ",
        "ุฎุฏูุงุช ุชุนูุถ ุฑูุบู ู ููุชุฑ",
        "ุฎุฏูุงุช ุณุณุชู ุชููู ู ฺฉููุฑ",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุชุฎุตุต ุฎูุฏุฑู",
        "ุฎุฏูุงุช ฺฉุงุฑุชโุฎูุงู ู ูพุฑุฏุงุฎุช",
        "ุฎุฏูุงุช ูพุฎุด ูุญุตููุงุช ุฎูุฏุฑู",
        "ุฎุฏูุงุช ุญูู ู ููู ูุนูููู ู ุณุงูููุฏุงู"
    ],
    "๐ ุขููุฒุด ู ูุฑููฺฏ": [
        "ูุฏุฑุณู ู ุขููุฒุดฺฏุงู (ุฏุจุณุชุงูุ ุฏุจุฑุณุชุงู)",
        "ุฏุงูุดฺฏุงู ู ูุฑุงฺฉุฒ ุขููุฒุด ุนุงู (ุฏุงูุดฺฏุงูุ ููุณุณู ุขููุฒุด ุนุงู)",
        "ุขููุฒุดฺฏุงู ุฒุจุงู (ุฒุจุงู ุงูฺฏูุณุ ุณุงุฑ ุฒุจุงูโูุง)",
        "ุขููุฒุดฺฏุงู ููโูุญุฑููโุง (ููุ ุญุฑููโุง)",
        "ฺฉุชุงุจุฎุงูู ุนููู (ุนูููุ ุชุฎุตุต)",
        "ูุฑููฺฏุณุฑุง ู ุฎุงูู ูุฑููฺฏ (ูุฑููฺฏุณุฑุงุ ุฎุงูู ูุฑููฺฏ)",
        "ููุฒู ู ฺฏุงูุฑ (ููุฒูุ ฺฏุงูุฑ ููุฑ)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ฺฉุงููพูุชุฑ (ฺฉุงููพูุชุฑุ ุจุฑูุงููโููุณ)",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ุชุญุตู (ูุดุงูุฑูุ ุงูุชุฎุงุจ ุฑุดุชู)",
        "ุขููุฒุดฺฏุงูโูุง ููุฑ (ููุงุดุ ูุฌุณููโุณุงุฒ)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุฑุงููุฏฺฏ (ุขููุฒุด ุฑุงููุฏฺฏุ ุขูโูุงูู)",
        "ููุฏฺฉูุฏฺฉ ู ูพุดโุฏุจุณุชุงู (ููุฏฺฉูุฏฺฉุ ูพุดโุฏุจุณุชุงู)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุนููู ูุฎุชูู (ุฑุงุถุ ูุฒฺฉุ ุดู)",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุงุฑุชโูุง ุฒูุฏฺฏ",
        "ุขููุฒุดฺฏุงูโูุง ุขุดูพุฒ ู ุดุฑูโูพุฒ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุฎูุงูุช ฺฉูุฏฺฉุงู",
        "ุขููุฒุดฺฏุงูโูุง ฺฉูฺฉูุฑ ู ุขุฒููู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุงุฒ ุฑุงู ุฏูุฑ",
        "ุขููุฒุดฺฏุงูโูุง ููุงุฑุชโุขููุฒ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุตูุงุน ุฏุณุช",
        "ุขููุฒุดฺฏุงูโูุง ุฎุงุท ู ุทุฑุงุญ ูุจุงุณ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุนฺฉุงุณ ู ูููุจุฑุฏุงุฑ",
        "ุขููุฒุดฺฏุงูโูุง ูุฑุฒุด ุชุฎุตุต",
        "ูุฑุงฺฉุฒ ุขููุฒุด ููุณู ูุญู",
        "ุขููุฒุดฺฏุงูโูุง ุฒุจุงู ุงุดุงุฑู",
        "ุฎุฏูุงุช ุขููุฒุด ูุฌุงุฒ ู ุขููุงู"
    ],
    "๐ ูุฐูุจ ู ูุนูู": [
        "ูุณุฌุฏ ู ูุตู (ูุณุฌุฏุ ูุตู)",
        "ุญุณูู ู ูุฆุช (ุญุณููุ ูุฆุช)",
        "ฺฉูุณุง ู ูุฑุงฺฉุฒ ูุณุญ (ฺฉูุณุงุ ูุฑุงฺฉุฒ ูุณุญ)",
        "ฺฉูุณู ู ูุฑุงฺฉุฒ ููุฏ (ฺฉูุณูุ ูุฑุงฺฉุฒ ููุฏ)",
        "ูุนุงุจุฏ ู ูพุฑุณุชุดฺฏุงูโูุง (ูุนุจุฏุ ูพุฑุณุชุดฺฏุงู)",
        "ูุฑุงฺฉุฒ ุนุฑูุงู ู ูุนูู (ุนุฑูุงูุ ูุนูู)",
        "ฺฉุชุงุจูุฑูุดโูุง ูุฐูุจ (ฺฉุชุงุจ ูุฐูุจุ ูุฑู ุงูุฒุงุฑ ูุฐูุจ)",
        "ูุฑุงฺฉุฒ ุฎุฑู ู ูฺฉูฺฉุงุฑ (ุฎุฑูุ ูฺฉูฺฉุงุฑ)",
        "ุงูุชุดุงุฑุงุช ูุฐูุจ (ุงูุชุดุงุฑุงุชุ ฺุงูพ ูุฐูุจ)",
        "ูุฑุงฺฉุฒ ุญูุธ ูุฑุขู ู ูุนุงุฑู ุงุณูุงู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุญุฌ ู ุฒุงุฑุช",
        "ูุฑุงฺฉุฒ ูุดุงูุฑู ูุฐูุจ ู ุฏู",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุงุญฺฉุงู ู ูุนุงุฑู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงููุงู ู ุงููุฑ ุฎุฑู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุฐูุจ ุณุงุฑ",
        "ูุฑุงฺฉุฒ ุจุฑฺฏุฒุงุฑ ูุฑุงุณู ูุฐูุจ"
    ],
    "๐ณ ุทุจุนุช ู ุชูุฑุญ ุขุฒุงุฏ": [
        "ูพุงุฑฺฉ ู ุจูุณุชุงู (ูพุงุฑฺฉ ุนูููุ ุจูุณุชุงู)",
        "ุจุงุบ ูุญุด ู ุขฺฉูุงุฑูู (ุจุงุบ ูุญุดุ ุขฺฉูุงุฑูู)",
        "ุจุงุบ ฺฏุงูโุดูุงุณ (ฺฏุงูโุดูุงุณุ ฺฏูุฎุงูู)",
        "ูพุณุช ุฏูฺุฑุฎูโุณูุงุฑ (ุฏูฺุฑุฎูโุณูุงุฑุ ุฏูฺุฑุฎู ุณูุงุฑ ุขูุฑูุฏ)",
        "ฺฉููุณุชุงู ู ูุณุฑูุง ุทุจุนุชโฺฏุฑุฏ (ฺฉููููุฑุฏุ ุทุจุนุชโฺฏุฑุฏ)",
        "ุณุงุญู ู ุฏุฑุงฺู (ุณุงุญูุ ุฏุฑุงฺู)",
        "ุขุจุดุงุฑ ู ฺุดูู (ุขุจุดุงุฑุ ฺุดูู)",
        "ุฌูฺฏู ู ููุทูู ุญูุงุธุช ุดุฏู (ุฌูฺฏูุ ููุทูู ุญูุงุธุช ุดุฏู)",
        "ฺฉููพูฺฏ ู ูพฺฉูฺฉ (ฺฉููพูฺฏุ ูพฺฉูฺฉ)",
        "ูุฑุงฺฉุฒ ุงฺฉูุชูุฑุณู (ุงฺฉูุชูุฑุณูุ ฺฏุฑุฏุดฺฏุฑ ุทุจุนุช)",
        "ูพุณุช ุงุณฺฉ ู ูุฑุฒุดโูุง ุฒูุณุชุงู (ุงุณฺฉุ ูุฑุฒุด ุฒูุณุชุงู)",
        "ุณุงููโูุง ุจููุฏุฑูฺฏ ู ุตุฎุฑูโููุฑุฏ (ุตุฎุฑูโููุฑุฏุ ุจููุฏุฑูฺฏ)",
        "ูุฑุงฺฉุฒ ูุงูฺฏุฑ ู ูุงูโุฑุงู",
        "ูพุงุฑฺฉโูุง ุขุจ ู ุงุณุชุฎุฑูุง ุฑูุจุงุฒ",
        "ูุฑุงฺฉุฒ ูพุฑูุฏูโูฺฏุฑ ู ุญุงุช ูุญุด",
        "ูุณุฑูุง ูพุงุฏูโุฑู ู ฺฉูููพูุง",
        "ูุฑุงฺฉุฒ ฺุงุฏุฑุฒู ู ฺฉุงุฑูุงููฺฏ",
        "ูพุงุฑฺฉโูุง ูู ู ููุงุทู ฺฏุฑุฏุดฺฏุฑ",
        "ูุฑุงฺฉุฒ ุขููุฒุด ุทุจุนุชโฺฏุฑุฏ",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชูุฑูุง ุทุจุนุช"
    ],
    "๐ผ ฺฉุณุจโูฺฉุงุฑ ู ุญุฑููโุง": [
        "ุฏูุชุฑ ฺฉุงุฑ ู ุดุฑฺฉุชโูุง (ุฏูุชุฑุ ุดุฑฺฉุช)",
        "ฺฉุงุฑุฎุงููโูุง ู ูุงุญุฏูุง ุชููุฏ (ฺฉุงุฑุฎุงููุ ุชููุฏ)",
        "ฺฉุงุฑฺฏุงูโูุง ุตูุนุช (ฺฉุงุฑฺฏุงูุ ุตูุนุช)",
        "ุฏูุงุชุฑ ุงููุงฺฉ ู ูุดุงูุฑู ุงููุงฺฉ (ุงููุงฺฉุ ูุดุงูุฑ ุงููุงฺฉ)",
        "ุฏูุงุชุฑ ุจูู (ุจููุ ุฎุฏูุงุช ุจููโุง)",
        "ุดุฑฺฉุชโูุง ุชุจูุบุงุช ู ุจุงุฒุงุฑุงุจ (ุชุจูุบุงุชุ ุจุงุฒุงุฑุงุจ)",
        "ูุฑุงฺฉุฒ ุทุฑุงุญ ู ฺุงูพ (ุทุฑุงุญุ ฺุงูพ)",
        "ุดุฑฺฉุชโูุง ูุนูุงุฑ ู ุนูุฑุงู (ูุนูุงุฑุ ุนูุฑุงู)",
        "ุฏูุงุชุฑ ุญููู ู ูฺฉุงูุช (ุญูููุ ูฺฉุงูุช)",
        "ุดุฑฺฉุชโูุง ูุดุงูุฑู ูุฏุฑุช (ูุดุงูุฑูุ ูุฏุฑุช)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุงู ู ุญุณุงุจุฏุงุฑ (ูุงูุ ุญุณุงุจุฏุงุฑ)",
        "ุดุฑฺฉุชโูุง ููุงูุฑ ุงุทูุงุนุงุช (ููุงูุฑ ุงุทูุงุนุงุชุ ูุฑูโุงูุฒุงุฑ)",
        "ุงุณุชูุฏููุง ุนฺฉุงุณ ู ูููุจุฑุฏุงุฑ (ุนฺฉุงุณุ ูููุจุฑุฏุงุฑ)",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุงุฏุงุฑ ู ฺฉูพ (ุฎุฏูุงุช ุงุฏุงุฑุ ฺฉูพ)",
        "ุดุฑฺฉุชโูุง ุญูู ู ููู ู ุจุงุฑุจุฑ (ุญูู ูููุ ุจุงุฑุจุฑ)",
        "ุฎุฏูุงุช ูุธุงูุช ู ูฺฏูุฏุงุฑ (ูุธุงูุชุ ูฺฏูุฏุงุฑ)",
        "ุดุฑฺฉุชโูุง ุฑุณุงููโุง ู ุงูุชุดุงุฑุงุช",
        "ูุฑุงฺฉุฒ ุชุญููุงุช ู ุชูุณุนู",
        "ุดุฑฺฉุชโูุง ูุดุงูุฑู ููุงุจุน ุงูุณุงู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูุดุงูุฑู ฺฉุณุจโูฺฉุงุฑ",
        "ุดุฑฺฉุชโูุง ุทุฑุงุญ ุณุงุช ู ุจูููโุณุงุฒ ููุชูุฑ ุฌุณุชุฌู",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุชุฑุฌูู ู ูุชุฑุฌู",
        "ุดุฑฺฉุชโูุง ุฎุฏูุงุช ุงููุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ูพุดุชุจุงู ููุงูุฑ ุงุทูุงุนุงุช",
        "ุดุฑฺฉุชโูุง ุฎุฏูุงุช ูุดุงูุฑู ูุงูุงุช",
        "ูุฑุงฺฉุฒ ุฎุฏูุงุช ุจุฑูุฏูฺฏ ู ููุช ุณุงุฒ",
        "ุฎุฏูุงุช ูุดุงูุฑู ุงูุฑฺ ู ุจูููโุณุงุฒ"
    ],
    "๐งฐ ุฎุฏูุงุช ุชุฎุตุต ู ูู": [
        "ุชุนูุฑฺฏุงู ููุงุฒู ุฎุงูฺฏ (ุชุนูุฑ ููุงุฒูุ ุณุฑูุณ)",
        "ุชุนูุฑฺฏุงู ููุจุงู ู ฺฉุงููพูุชุฑ (ุชุนูุฑ ููุจุงูุ ฺฉุงููพูุชุฑ)",
        "ุฎุฏูุงุช ุจุฑู ุณุงุฎุชูุงู (ุจุฑูโฺฉุงุฑุ ุณูโฺฉุด)",
        "ุฎุฏูุงุช ููููโฺฉุด ู ุชุงุณุณุงุช (ููููโฺฉุดุ ุชุงุณุณุงุช)",
        "ุฎุฏูุงุช ููุงุด ุณุงุฎุชูุงู (ููุงุด ุณุงุฎุชูุงูุ ุฑูฺฏโฺฉุงุฑ)",
        "ุฎุฏูุงุช ฺฉุงุจูุช ุณุงุฒ ู ูุฌุงุฑ (ฺฉุงุจูุชโุณุงุฒุ ูุฌุงุฑ)",
        "ุฎุฏูุงุช ุขููฺฏุฑ ู ุฌูุดฺฉุงุฑ (ุขููฺฏุฑุ ุฌูุดฺฉุงุฑ)",
        "ุฎุฏูุงุช ฺฉูุฏุณุงุฒ ู ูููโุณุงุฒ (ฺฉูุฏุณุงุฒุ ูููโุณุงุฒ)",
        "ุฎุฏูุงุช ุดุดูโุจุฑ ู ุขููโฺฉุงุฑ (ุดุดูโุจุฑุ ุขููโฺฉุงุฑ)",
        "ุฎุฏูุงุช ูุฑุด ุดู ู ูุจู ุดู (ูุฑุดโุดูุ ูุจูโุดู)",
        "ุฎุฏูุงุช ูุธุงูุช ููุฒู ู ุงุฏุงุฑู (ูุธุงูุชุ ุฎุฏูุงุช ูุธุงูุช)",
        "ุฎุฏูุงุช ุจุงุบุจุงู ู ูุถุง ุณุจุฒ (ุจุงุบุจุงูุ ูุถุง ุณุจุฒ)",
        "ุฎุฏูุงุช ุญุดุฑูโฺฉุด ู ุถุฏุนููู (ุถุฏุนูููุ ุณููพุงุด)",
        "ุฎุฏูุงุช ุงููุช ู ูฺฏูุจุงู (ุงููุชุ ูฺฏูุจุงู)",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุงูฺฉุชุฑููฺฉ",
        "ุฎุฏูุงุช ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ุชุฌูุฒุงุช",
        "ุฎุฏูุงุช ุณูโฺฉุด ุดุจฺฉู ู ุงูุชุฑูุช",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุตูุนุช ู ูุงุดูโุขูุงุช",
        "ุฎุฏูุงุช ูุตุจ ุฏูุฑุจู ู ุณุณุชูโูุง ุญูุงุธุช",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ุขุดูพุฒุฎุงูู",
        "ุฎุฏูุงุช ูุตุจ ฺฉููพูุด ู ุณูู ฺฉุงุฐุจ",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุงุจุฒุงุฑุขูุงุช ุฏูู",
        "ุฎุฏูุงุช ูุตุจ ุขุณุงูุณูุฑ ู ูพูู ุจุฑู",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุณุณุชูโูุง ุณุฑูุงุด ู ฺฏุฑูุงุด",
        "ุฎุฏูุงุช ูุตุจ ุณุณุชูโูุง ุงุนูุงู ุญุฑู",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ุงุฏูุงุช ููุณู",
        "ุฎุฏูุงุช ูุตุจ ุฏุด ู ุณุณุชูโูุง ูุงููุงุฑูโุง",
        "ุฎุฏูุงุช ุชุนูุฑุงุช ููุงุฒู ูพุฒุดฺฉ",
        "ุฎุฏูุงุช ูุตุจ ุณุณุชูโูุง ููุดููุฏ ุณุงุฎุชูุงู",
        "ุฎุฏูุงุช ุจุงุฒุงูุช ู ูุญุท ุฒุณุช",
        "ุฎุฏูุงุช ุงุฌุงุฑู ุชุฌูุฒุงุช ู ููุงุฒู (ูุงููุฏ ุงุฌุงุฑู ฺุงุฏุฑุ ูุจุงุณ ูุฑุงุณูุ ุชุฌูุฒุงุช ูู)"
    ]
}

# ูุชุบุฑูุง ฺฉูฺฉ
def generate_numeric_id():
    while True:
        num_id = random.randint(100000000, 999999999)
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("SELECT numeric_id FROM users WHERE numeric_id = ?", (num_id,))
        if not c.fetchone():
            conn.close()
            return num_id
        conn.close()

def save_user(user_id, name, age, gender):
    numeric_id = generate_numeric_id()
    conn = sqlite3.connect(DB_NAME)
    c = conn.cursor()
    c.execute("INSERT OR REPLACE INTO users (user_id, name, age, gender, score, numeric_id) VALUES (?, ?, ?, ?, ?, ?)",
              (user_id, name, age, gender, 0, numeric_id))
    conn.commit()
    conn.close()

def get_user(user_id):
    conn = sqlite3.connect(DB_NAME)
    c = conn.cursor()
    c.execute("SELECT * FROM users WHERE user_id = ?", (user_id,))
    user = c.fetchone()
    conn.close()
    return user

def get_user_by_numeric_id(numeric_id):
    conn = sqlite3.connect(DB_NAME)
    c = conn.cursor()
    c.execute("SELECT * FROM users WHERE numeric_id = ?", (numeric_id,))
    user = c.fetchone()
    conn.close()
    return user

def is_user_blocked(user_id):
    return user_id in blocked_users

def block_user(user_id):
    blocked_users.add(user_id)

def unblock_user(user_id):
    blocked_users.discard(user_id)

# ููููุง
def main_menu(user_id):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['profile']} ูพุฑููุงู")
    keyboard.row('๐ข ฺฏุฒุงุฑุด', '๐ฐ ุฎุฑุฏ ูฺฉุงู ุจุฑุชุฑ')
    keyboard.row(f"{EMOJIS['places']} ูฺฉุงูโูุง", f"{EMOJIS['rating']} ูฺฉุงูโูุง ุจุฑุชุฑ")
    keyboard.row(f"{EMOJIS['star']} ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ")
    keyboard.row(f"{EMOJIS['link']} ููฺฉโูุง", f"{EMOJIS['help']} ุฑุงูููุง")
    
    # ููุท ุงุฏูู ูโุชูุงูุฏ ุฏฺฉูู ุงุฏูู ุฑุง ุจุจูุฏ
    if user_id == ADMIN_ID:
        keyboard.row(f"{EMOJIS['admin']} ุจุฎุด ุงุฏูู")
    
    return keyboard

def profile_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("ูุดุงูุฏู ูพุฑููุงู")
    keyboard.row("ุชุบุฑ ูุงู", "ุชุบุฑ ุณู", "ุชุบุฑ ุฌูุณุช")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def get_place_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['add']} ุงุถุงูู ฺฉุฑุฏู ูฺฉุงู")
    keyboard.row(f"{EMOJIS['view']} ูุดุงูุฏู ูฺฉุงูโูุง", f"{EMOJIS['view']} ูฺฉุงูโูุง ูู")
    keyboard.row(f"{EMOJIS['view']} ุฌุณุชุฌู")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def back_home_buttons():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def back_button_only():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
    return keyboard

def skip_button():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("ุฑุฏ ฺฉุฑุฏู")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
    return keyboard

def place_view_result_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("ูุดุงูุฏู ุฏูุจุงุฑู")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
    keyboard.row(f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def search_result_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("ุฌุณุชุฌู ุฏูุจุงุฑู")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
    keyboard.row(f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def admin_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("๐ฅ ฺฉุงุฑุจุฑุงู ูุนุงู")
    keyboard.row(f"{EMOJIS['news']} ุงุฑุณุงู ุฎุจุฑ")
    keyboard.row("๐ก๏ธ ูุฏุฑ ูฺฉุงูโูุง")
    keyboard.row("๐ซ ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ", "๐ ุฑูุน ูุณุฏูุฏุช")
    keyboard.row(f"{EMOJIS['score']} ุงูุชุงุฒ ฺฉุงุฑุจุฑุงู")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def admin_sub_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
    return keyboard

def admin_news_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['group']} ุงุฑุณุงู ุฎุจุฑ ฺฏุฑูู")
    keyboard.row(f"{EMOJIS['user']} ุงุฑุณุงู ุฎุจุฑ ุจู ฺฉุงุฑุจุฑ")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
    return keyboard

def admin_score_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['add_score']} ุงุถุงูู ฺฉุฑุฏู ุงูุชุงุฒ", f"{EMOJIS['remove_score']} ฺฉู ฺฉุฑุฏู ุงูุชุงุฒ")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
    return keyboard

def edit_place_menu(place_id):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row(f"{EMOJIS['edit']} ูุฑุงุด ุนููุงู", f"{EMOJIS['edit']} ูุฑุงุด ุชูุถุญุงุช")
    keyboard.row(f"{EMOJIS['edit']} ูุฑุงุด ุขุฏุฑุณ", f"{EMOJIS['edit']} ูุฑุงุด ุชูุงุณ")
    keyboard.row(f"{EMOJIS['edit']} ูุฑุงุด ุนฺฉุณ")
    keyboard.row(f"{EMOJIS['edit']} ูุฑุงุด ุดูุช ุตุจุญ", f"{EMOJIS['edit']} ูุฑุงุด ุดูุช ุนุตุฑ")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

def search_type_menu():
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.row("ูุบุงุฒู ูุง ุขุฏุฑุณ ููุฑุฏ ูุธุฑ")
    keyboard.row("ุฌุณุชุฌู ูุบุงุฒู ููุฑุฏ ูุธุฑ")
    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", f"{EMOJIS['home']} ุตูุญู ุงุตู")
    return keyboard

# ุฏุณุชูุฑ ุดุฑูุน
@app.route('/' + API_TOKEN, methods=['POST'])
def get_message():
    json_string = request.get_data().decode('utf-8')
    update = telebot.types.Update.de_json(json_string)
    bot.process_new_updates([update])
    return "!", 200

@app.route('/')
def webhook():
    bot.remove_webhook()
    bot.set_webhook(url=WEBHOOK_URL + '/' + API_TOKEN)
    return "Webhook set!", 200

@app.route('/health')
def health_check():
    return "OK", 200

@bot.message_handler(commands=['start', 'admin'])
def start(message):
    user_id = message.from_user.id
    if is_user_blocked(user_id):
        bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ุจู ุฏูู ููุถ ููุงูู ุงุฒ ุทุฑู ุงุฏูู ูุณุฏูุฏ ุดุฏู ุงุฏโุจุฑุง ุฑูุน ูุณุฏูุฏุช ุจุงุฏ ูุฒูู ุง ุงูุฏฺฉ ุจูพุฑุฏุงุฒุฏ โผ๏ธ ุจุฑุง ููุงููฺฏ ุจู ุงุฏ ุงุฏูู ูพุงู ุฏูุฏ: @Sedayegoyom10")
        return
    if message.text == '/admin' and user_id == ADMIN_ID:
        bot.send_message(user_id, f"{EMOJIS['admin']} ุจู ูพูู ุงุฏูู ุฎูุด ุขูุฏุฏ!", reply_markup=admin_menu())
        user_states[user_id] = "admin_menu"
        return
    user = get_user(user_id)
    if user:
        bot.send_message(user_id, f"{EMOJIS['success']} ุฎูุด ุจุฑฺฏุดุช! ๐", reply_markup=main_menu(user_id))
        user_states[user_id] = "main_menu"
    else:
        keyboard = types.InlineKeyboardMarkup()
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['success']} ูพุฐุฑูุชู", callback_data="accept_terms"))
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['error']} ููพุฐุฑูุชู", callback_data="decline_terms"))
        bot.send_message(user_id, WELCOME_MESSAGE, parse_mode="Markdown", reply_markup=keyboard)
        user_states[user_id] = "awaiting_terms"

# ูุฏุฑุช ูพุงูโูุง - ุจูุจูุฏ ุจุฑุง ฺฉุงุฑฺฉุฑุฏ ุจุฏูู ูุงุฒ ุจู /start
@bot.message_handler(content_types=['text'])
def handle_message(message):
    user_id = message.from_user.id
    if is_user_blocked(user_id):
        bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ุจู ุฏูู ููุถ ููุงูู ุงุฒ ุทุฑู ุงุฏูู ูุณุฏูุฏ ุดุฏู ุงุฏโุจุฑุง ุฑูุน ูุณุฏูุฏุช ุจุงุฏ ูุฒูู ุง ุงูุฏฺฉ ุจูพุฑุฏุงุฒุฏ โผ๏ธ ุจุฑุง ููุงููฺฏ ุจู ุงุฏ ุงุฏูู ูพุงู ุฏูุฏ: @Sedayegoyom10")
        return
    
    # ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุจูุงู ุซุจุชโูุงู ูฺฉุฑุฏูุ ูุณุชููุงู ุจู ูุฑุขูุฏ ุซุจุชโูุงู ูุฏุงุช ุดูุฏ
    if user_id not in user_states and not get_user(user_id):
        keyboard = types.InlineKeyboardMarkup()
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['success']} ูพุฐุฑูุชู", callback_data="accept_terms"))
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['error']} ููพุฐุฑูุชู", callback_data="decline_terms"))
        bot.send_message(user_id, WELCOME_MESSAGE, parse_mode="Markdown", reply_markup=keyboard)
        user_states[user_id] = "awaiting_terms"
        return
    
    state = user_states.get(user_id, "main_menu")
    text = message.text if message.text else ""

    if text == f"{EMOJIS['home']} ุตูุญู ุงุตู":
        bot.send_message(user_id, "ุตูุญู ุงุตู:", reply_markup=main_menu(user_id))
        user_states[user_id] = "main_menu"
        return
    if text == f"{EMOJIS['back']} ุจุฑฺฏุดุช":
        if state in ["profile_menu", "profile_view", "profile_edit_name", "profile_edit_age", "profile_edit_gender"]:
            bot.send_message(user_id, "ุจุฎุด ูพุฑููุงู:", reply_markup=profile_menu())
            user_states[user_id] = "profile_menu"
            return
        elif state == "place_view_category":
            bot.send_message(user_id, f"{EMOJIS['places']} ุจู ุจุฎุด ูฺฉุงูโูุง ุฎูุด ุขูุฏุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
            return
        elif state == "place_view_subcategory":
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for cat in PLACE_CATEGORIES:
                keyboard.row(f"๐ {cat}")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฏุณุชู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "place_view_category"
            return
        elif state in ["place_menu", "place_add_category", "place_add_subcategory", "place_add_title", "place_add_description", 
                       "place_add_address", "place_add_phone", "place_add_photo", "place_add_morning_shift", 
                       "place_add_afternoon_shift", "place_add_numeric_id", "place_view_result", "place_my_places", 
                       "place_top_rated", "place_rate", "place_rate_confirm", "place_search_title", "place_search_address", "place_search_result", "search_type", "search_by_address", "search_by_name", "search_by_name_address"]:
            bot.send_message(user_id, "ุจุฎุด ูฺฉุงูโูุง:", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
            return
        elif state in ["edit_place_menu", "edit_place_title", "edit_place_description", "edit_place_address", 
                       "edit_place_phone", "edit_place_photo", "edit_place_morning_shift", "edit_place_afternoon_shift"]:
            bot.send_message(user_id, "ูุฑุงุด ูฺฉุงู:", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
            return
        elif state in ["admin_menu", "admin_view_gender", "admin_users", "admin_news_content", "admin_news_confirm", 
                       "admin_news_sent", "admin_delete_place_title", "admin_delete_place_category", 
                       "admin_delete_place_subcategory", "admin_delete_place_user_id", "admin_delete_place_confirm", 
                       "admin_block_user", "admin_confirm_block", "admin_unblock_user", "admin_confirm_unblock",
                       "admin_news_menu", "admin_news_user_content", "admin_news_user_numeric_id", "admin_news_user_confirm",
                       "admin_score_menu", "admin_add_score_numeric_id", "admin_add_score_amount", "admin_add_score_confirm",
                       "admin_remove_score_numeric_id", "admin_remove_score_amount", "admin_remove_score_confirm"]:
            if state.startswith("admin_news"):
                bot.send_message(user_id, f"{EMOJIS['news']} ุจุฎุด ุงุฑุณุงู ุฎุจุฑ:", reply_markup=admin_news_menu())
                user_states[user_id] = "admin_news_menu"
            elif state.startswith("admin_score"):
                bot.send_message(user_id, f"{EMOJIS['score']} ุจุฎุด ุงูุชุงุฒ ฺฉุงุฑุจุฑุงู:", reply_markup=admin_score_menu())
                user_states[user_id] = "admin_score_menu"
            elif state == "admin_view_gender":
                bot.send_message(user_id, f"{EMOJIS['admin']} ูพูู ุงุฏูู:", reply_markup=admin_menu())
                user_states[user_id] = "admin_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['admin']} ูพูู ุงุฏูู:", reply_markup=admin_menu())
                user_states[user_id] = "admin_menu"
            return
        else:
            bot.send_message(user_id, "ุตูุญู ุงุตู:", reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
            return
    if text == "ุจุฑฺฏุดุช ุจู ุงุฏูู":
        bot.send_message(user_id, f"{EMOJIS['admin']} ูพูู ุงุฏูู:", reply_markup=admin_menu())
        user_states[user_id] = "admin_menu"
        return
    if state == "awaiting_name":
        if text.strip():
            user_data[user_id] = {'name': text}
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for i in range(13, 71, 10):
                row = [str(x) for x in range(i, min(i+10, 71))]
                keyboard.row(*row)
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, "ุณู ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "awaiting_age"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")
    elif state == "awaiting_age":
        try:
            age = int(text)
            if 13 <= age <= 70:
                user_data[user_id]['age'] = age
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                keyboard.row("๐ฆ ูพุณุฑ", "๐ง ุฏุฎุชุฑ", "๐ ุฏฺฏุฑ")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
                bot.send_message(user_id, "ุฌูุณุช ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
                user_states[user_id] = "awaiting_gender"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุณู ุจู 13 ุชุง 70 ุจุงุดุฏ!")
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!")
    elif state == "awaiting_gender":
        if text in ["๐ฆ ูพุณุฑ", "๐ง ุฏุฎุชุฑ", "๐ ุฏฺฏุฑ"]:
            gender = text.split()[1] if " " in text else text
            user_data[user_id]['gender'] = gender
            save_user(user_id, user_data[user_id]['name'], user_data[user_id]['age'], gender)
            user = get_user(user_id)
            profile_msg = f"{EMOJIS['profile']} ูพุฑููุงู ุดูุง:\n"
            profile_msg += f"ูุงู: {user[1]}\nุณู: {user[2]}\nุฌูุณุช: {user[3]}\nุงูุชุงุฒ: {user[4]}\nุดูุงุณู: {user[5]}"
            bot.send_message(user_id, profile_msg, reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ฺฉ ุงุฒ ฺฏุฒููโูุง ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ!")
    elif state == "main_menu":
        if text == f"{EMOJIS['profile']} ูพุฑููุงู":
            user = get_user(user_id)
            if user:
                keyboard = profile_menu()
                profile_msg = f"{EMOJIS['profile']} ูพุฑููุงู ุดูุง:\n"
                profile_msg += f"ูุงู: {user[1]}\nุณู: {user[2]}\nุฌูุณุช: {user[3]}\nุงูุชุงุฒ: {user[4]}\nุดูุงุณู: {user[5]}"
                bot.send_message(user_id, profile_msg, reply_markup=keyboard)
                user_states[user_id] = "profile_menu"
        elif text == f"{EMOJIS['places']} ูฺฉุงูโูุง":
            bot.send_message(user_id, f"{EMOJIS['places']} ุจู ุจุฎุด ูฺฉุงูโูุง ุฎูุด ุขูุฏุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
        elif text == f"{EMOJIS['rating']} ูฺฉุงูโูุง ุจุฑุชุฑ":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            MIN_RATING_COUNT = 100  # ุชุบุฑ ุงุฒ 200 ุจู 100
            MIN_AVG_RATING = 8.0
            c.execute("""
                SELECT places.*, users.numeric_id
                FROM places
                JOIN users ON places.user_id = users.user_id
                WHERE places.rating_count >= ? AND (places.rating_sum * 1.0 / places.rating_count) > ?
                ORDER BY (places.rating_sum * 1.0 / places.rating_count) DESC
            """, (MIN_RATING_COUNT, MIN_AVG_RATING))
            places = c.fetchall()
            conn.close()
            if places:
                for place in places:
                    if place[8]:
                        try:
                            bot.send_photo(user_id, place[8])
                        except:
                            pass
                    avg_rating = (place[11] / place[12]) if place[12] > 0 else 0
                    msg = f"{EMOJIS['places']} ูฺฉุงู ุจุฑุชุฑ:\n"
                    msg += f"ุนููุงู: {place[4]}\nุฏุณุชู: {place[2]}\nุฒุฑุฏุณุชู: {place[3] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุชูุถุญุงุช: {place[5]}\n"
                    msg += f"ุขุฏุฑุณ: {place[6]}\n"
                    msg += f"ุชูุงุณ: {place[7] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุดูุช ุตุจุญ: {place[9] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุดูุช ุนุตุฑ: {place[10] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุงูุชุงุฒ ูุงูฺฏู: {avg_rating:.1f} ({place[12]} ุฑุง)"
                    # ููุงุด ุดูุงุณู ุนุฏุฏ ูุงูฺฉ ููุท ุจุฑุง ุงุฏูู
                    if user_id == ADMIN_ID:
                        msg += f"\nุดูุงุณู ุนุฏุฏ ูุงูฺฉ: {place[13]}"
                    keyboard = types.InlineKeyboardMarkup()
                    if user_id == ADMIN_ID:
                        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['delete']} ุญุฐู", callback_data=f"delete_place_{place[0]}"))
                        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['edit']} ูุฑุงุด", callback_data=f"edit_place_{place[0]}"))
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['rating']} ุงูุชุงุฒ", callback_data=f"rate_place_{place[0]}"))
                    bot.send_message(user_id, msg, reply_markup=keyboard)
                bot.send_message(user_id, "ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=main_menu(user_id))
                user_states[user_id] = "main_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ูููุฒ ูฺ ูฺฉุงู ูุชููุณุชู ูุฑุชุจู ุจุฑุชุฑ ุฑุง ุฏุฑ ูฺฉุงูโูุง ฺฉุณุจ ฺฉูุฏ!", reply_markup=main_menu(user_id))
                user_states[user_id] = "main_menu"
        elif text == f"{EMOJIS['star']} ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT user_id, name, score FROM users WHERE score >= 1000 ORDER BY score DESC")
            users = c.fetchall()
            conn.close()
            if users:
                msg = f"{EMOJIS['star']} ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ:\n\n"
                for user in users:
                    user_id_db = user[0]
                    user_name = user[1]
                    user_score = user[2]
                    
                    # ุฏุฑุงูุช ูฺฉุงูโูุง ฺฉุงุฑุจุฑ
                    conn = sqlite3.connect(DB_NAME)
                    c = conn.cursor()
                    c.execute("SELECT title FROM places WHERE user_id = ?", (user_id_db,))
                    places = c.fetchall()
                    conn.close()
                    
                    places_list = [place[0] for place in places]
                    places_str = ", ".join(places_list) if places_list else "ูฺ ูฺฉุงู ุซุจุช ูุดุฏู"
                    
                    msg += f"๐ค ูุงู: {user_name}\n๐ ุงูุชุงุฒ: {user_score}\n๐ ูฺฉุงูโูุง: {places_str}\n\n"
                    msg += "-------------------\n\n"
            else:
                msg = f"{EMOJIS['error']} ูููุฒ ฺฉุณ ุจู ฑฐฐฐ ุงูุชุงุฒ ูุฑุณุฏู ุงุณุช!"
            bot.send_message(user_id, msg, reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        elif text == f"{EMOJIS['link']} ููฺฉโูุง":
            link_text = f"{EMOJIS['link']} ููฺฉโูุง ููุฏ:\n\n"
            link_text += f"{EMOJIS['link']} ููฺฉ ูพุฌ ุงุตู ฺฏููโููุง:\n"
            link_text += "https://www.instagram.com/sedayegoyom?igsh=MXd0MTlkZGdzNzZ6bw==\n\n"
            link_text += f"{EMOJIS['admin']} ุงุฏ ุงุฏูู ฺฏููโููุง:\n"
            link_text += "@Sedayegoyom10"
            bot.send_message(user_id, link_text, reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        elif text == f"{EMOJIS['help']} ุฑุงูููุง":
            help_text = f"{EMOJIS['help']} ุฑุงูููุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุช ฺฏููโููุง:\n\n"
            help_text += f"{EMOJIS['profile']} ุจุฎุด ูพุฑููุงู:\n"
            help_text += "โข ูุดุงูุฏู ุงุทูุงุนุงุช ุดุฎุต ุฎูุฏ\n"
            help_text += "โข ูุฑุงุด ูุงูุ ุณู ู ุฌูุณุช\n\n"
            help_text += f"{EMOJIS['places']} ุจุฎุด ูฺฉุงูโูุง:\n"
            help_text += "โข ูุดุงูุฏู ูฺฉุงูโูุง ุจุฑ ุงุณุงุณ ุฏุณุชูโุจูุฏ\n"
            help_text += "โข ูุฏุฑุช ูฺฉุงูโูุง ุฎูุฏ (ูุฑุงุด/ุญุฐู ุจุฑุง ุงุฏูู)\n"
            help_text += "โข ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ูฺฉุงู ุจุง ุงุฏูู ุชูุงุณ ุจฺฏุฑุฏ\n"
            help_text += "โข ุฌุณุชุฌู ุจุฑ ุงุณุงุณ ุขุฏุฑุณ ุง ูุงู ูฺฉุงู (ุฌุฒุฆ ุง ฺฉุงูู)\n"
            help_text += "โข ูุฑ ูฺฉุงู ฑต ุงูุชุงุฒ ุจุฑุง ฺฉุงุฑุจุฑ ูุฑุชุจุท\n\n"
            help_text += f"{EMOJIS['rating']} ูฺฉุงูโูุง ุจุฑุชุฑ:\n"
            help_text += "โข ูุดุงูุฏู ูฺฉุงูโูุง ุจุง ุญุฏุงูู ฑฐฐ ุฑุง ู ูุงูฺฏู ุงูุชุงุฒ ุจุงูุง ธ\n"
            help_text += "โข ูุฑ ฺฉุงุฑุจุฑ ููุท ฺฉโุจุงุฑ ูโุชูุงูุฏ ุจู ูุฑ ูฺฉุงู ุฑุง ุฏูุฏ\n\n"
            help_text += f"{EMOJIS['star']} ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ:\n"
            help_text += "โข ูุดุงูุฏู ฺฉุงุฑุจุฑุงู ุจุง ุจุดุชุฑู ุงูุชุงุฒ\n"
            help_text += "โข ุญุฏุงูู ฑฐฐฐ ุงูุชุงุฒ ุจุฑุง ููุงุด\n\n"
            help_text += f"{EMOJIS['link']} ุจุฎุด ููฺฉโูุง:\n"
            help_text += "โข ุฏุณุชุฑุณ ุจู ูพุฌ ุงุตู\n"
            help_text += "โข ุงุฑุชุจุงุท ุจุง ุงุฏูู\n\n"
            help_text += f"{EMOJIS['info']} ููุงูู ููู:\n"
            help_text += "โข ูุญุชูุง ูุณุชูุฌู ุง ุชูููโุขูุฒ ูุฌุงุฒ ูุณุช\n"
            help_text += "โข ุงุทูุงุนุงุช ูุงูุน ู ุฏูู ูุงุฑุฏ ฺฉูุฏ\n"
            help_text += "โข ุฑุนุงุช ุงุฏุจ ู ุงุญุชุฑุงู ุฏุฑ ุชุนุงููุงุช\n"
            help_text += "โข ุชุฎูู ุงุฒ ููุงูู ููุฌุฑ ุจู ูุณุฏูุฏุช ูโุดูุฏ\n\n"
            help_text += f"{EMOJIS['places']} ุฏุณุชูโุจูุฏ ูฺฉุงูโูุง (ุฎูุงุตู):\n"
            help_text += "๐ฝ๏ธ ุฎูุฑุงฺฉ ู ููุดุฏู: ุฑุณุชูุฑุงูโูุงุ ฺฉุงููโูุงุ ุณููพุฑูุงุฑฺฉุชโูุง ู ...\n"
            help_text += "๐๏ธ ุฎุฑุฏ ู ูุฑูุด: ูพุงุณุงฺูุงุ ูุฑูุดฺฏุงูโูุง ูพูุดุงฺฉุ ููุงุฒู ุฎุงูฺฏ ู ...\n"
            help_text += "โ๏ธ ุฒุจุง ู ุขุฑุงุด: ุขุฑุงุดฺฏุงูโูุงุ ุณุงููโูุง ุฒุจุงุ ุชุชู ู ...\n"
            help_text += "๐ฅ ุฏุฑูุงู ู ุณูุงูุช: ุจูุงุฑุณุชุงูโูุงุ ฺฉููฺฉโูุงุ ุฏุงุฑูุฎุงููโูุง ู ...\n"
            help_text += "โฝ ูุฑุฒุด ู ุณุฑฺฏุฑู: ุจุงุดฺฏุงูโูุงุ ุงุณุชุฎุฑูุงุ ุณููุงูุง ู ...\n"
            help_text += "๐จ ุงูุงูุช ู ุณูุฑ: ูุชูโูุงุ ุขฺุงูุณโูุง ูุณุงูุฑุชุ ูุฑูุฏฺฏุงูโูุง ู ...\n"
            help_text += "๐๏ธ ุฎุฏูุงุช ุนููู ู ุงุฏุงุฑ: ุจุงูฺฉโูุงุ ุงุฏุงุฑุงุช ูพุณุชุ ุดูุฑุฏุงุฑโูุง ู ...\n"
            help_text += "๐ ุฎุฏูุงุช ุดูุฑ ู ุญููโูููู: ูพููพ ุจูุฒูโูุงุ ุชุนูุฑฺฏุงูโูุงุ ุชุงฺฉุณโูุง ู ...\n"
            help_text += "๐ ุขููุฒุด ู ูุฑููฺฏ: ูุฏุงุฑุณุ ุฏุงูุดฺฏุงูโูุงุ ุขููุฒุดฺฏุงูโูุง ู ...\n"
            help_text += "๐ ูุฐูุจ ู ูุนูู: ูุณุงุฌุฏุ ุญุณููโูุงุ ูุฑุงฺฉุฒ ุฎุฑู ู ...\n"
            help_text += "๐ณ ุทุจุนุช ู ุชูุฑุญ ุขุฒุงุฏ: ูพุงุฑฺฉโูุงุ ุจุงุบ ูุญุดโูุงุ ูุณุฑูุง ุทุจุนุชโฺฏุฑุฏ ู ...\n"
            help_text += "๐ผ ฺฉุณุจโูฺฉุงุฑ ู ุญุฑููโุง: ุฏูุงุชุฑ ฺฉุงุฑุ ฺฉุงุฑุฎุงููโูุงุ ุดุฑฺฉุชโูุง ุชุจูุบุงุช ู ...\n"
            help_text += "๐งฐ ุฎุฏูุงุช ุชุฎุตุต ู ูู: ุชุนูุฑฺฏุงูโูุงุ ุฎุฏูุงุช ุจุฑูุ ุฎุฏูุงุช ูุธุงูุช ู ...\n\n"
            help_text += f"{EMOJIS['success']} ูููู ุจุงุดุฏ!"
            bot.send_message(user_id, help_text, reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        
    elif text == "๐ข ฺฏุฒุงุฑุด":
        bot.send_message(user_id, "ูุทูุงู ุงฺฏุฑ ฺฏุฒุงุฑุด ุฏุงุฑุฏ ุจููุณุฏ ุชุง ุจู ุงุฏูู ุงุฑุณุงู ุดูุฏ:", reply_markup=back_button_only())
        user_states[user_id] = "report_message"

        elif text == f"{EMOJIS['admin']} ุจุฎุด ุงุฏูู" and user_id == ADMIN_ID:
            bot.send_message(user_id, f"{EMOJIS['admin']} ุจู ูพูู ุงุฏูู ุฎูุด ุขูุฏุฏ!", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    
    elif state == "report_message":
        if text.strip():
            user_data[user_id] = {"report": text.strip()}
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            keyboard.row("โ ุชุงุฏ ุงุฑุณุงู", f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, "ุขุง ุงุฒ ุงุฑุณุงู ุงู ฺฏุฒุงุฑุด ูุทูุฆู ูุณุชุฏุ", reply_markup=keyboard)
            user_states[user_id] = "report_confirm"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุชู ฺฏุฒุงุฑุด ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")

    elif state == "report_confirm":
        if text == "โ ุชุงุฏ ุงุฑุณุงู":
            report_text = user_data[user_id]['report']
            user = get_user(user_id)
            profile_info = f"ูุงู: {user[1]}\nุณู: {user[2]}\nุฌูุณุช: {user[3]}\nุดูุงุณู: {user[5]}"
            admin_msg = f"๐ข ฺฏุฒุงุฑุด ุฌุฏุฏ ุฏุฑุงูุช ุดุฏ:\n\n{report_text}\n---\n{profile_info}"
            bot.send_message(ADMIN_ID, admin_msg)
            bot.send_message(user_id, f"{EMOJIS['success']} ฺฏุฒุงุฑุด ุดูุง ุจุง ููููุช ุงุฑุณุงู ุดุฏ ู ูพฺฏุฑ ุฎูุงูุฏ ุดุฏ.", reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        elif text == f"{EMOJIS['back']} ุจุฑฺฏุดุช":
            user_states[user_id] = "admin_menu"
    elif text == "๐ ูุฑุงุฑฺฏุฑ ูฺฉุงู ุจุฑุชุฑ":
        keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
        keyboard.row("โฌ๏ธ ุงุถุงูู ฺฉุฑุฏู ุฑุง", "โฌ๏ธ ฺฉู ฺฉุฑุฏู ุฑุง")
        keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
        bot.send_message(user_id, "ูุฏุฑุช ูฺฉุงูโูุง ุจุฑุชุฑ:", reply_markup=keyboard)
        user_states[user_id] = "top_places_menu"

            bot.send_message(user_id, "ุตูุญู ุงุตู:", reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"

    
    elif state == "top_places_menu":
        if text == "โฌ๏ธ ุงุถุงูู ฺฉุฑุฏู ุฑุง":
            bot.send_message(user_id, "ุนููุงู ูฺฉุงู ููุฑุฏ ูุธุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
            user_states[user_id] = "add_vote_place_title"
        elif text == "โฌ๏ธ ฺฉู ฺฉุฑุฏู ุฑุง":
            bot.send_message(user_id, "ุนููุงู ูฺฉุงู ููุฑุฏ ูุธุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
            user_states[user_id] = "remove_vote_place_title"
        elif text == f"{EMOJIS['back']} ุจุฑฺฏุดุช":
            bot.send_message(user_id, "ุจุฎุด ุงุฏูู:", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"

    # ุงุถุงูู ฺฉุฑุฏู ุฑุง
    elif state == "add_vote_place_title":
        user_data[user_id] = {"place_title": text.strip()}
        bot.send_message(user_id, "ุดูุงุณู ุนุฏุฏ ุฑูุฏูู ุตุงุญุจ ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "add_vote_place_owner"

    elif state == "add_vote_place_owner":
        user_data[user_id]["owner_id"] = text.strip()
        bot.send_message(user_id, "ุชุนุฏุงุฏ ุฑุงโูุง ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "add_vote_count"

    elif state == "add_vote_count":
        user_data[user_id]["vote_count"] = int(text.strip())
        bot.send_message(user_id, "ุงูุชุงุฒ ูุฑ ุฑุง ุฑุง ูุงุฑุฏ ฺฉูุฏ (ฐ ุชุง ฑฐ - ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "add_vote_score"

    elif state == "add_vote_score":
        user_data[user_id]["vote_score"] = float(text.strip())
        keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
        keyboard.row("โ ุชุงุฏ", f"{EMOJIS['back']} ุจุฑฺฏุดุช")
        bot.send_message(user_id, "ุขุง ุงุฒ ุงุถุงูู ฺฉุฑุฏู ุงู ุฑุง ูุทูุฆู ูุณุชุฏุ", reply_markup=keyboard)
        user_states[user_id] = "add_vote_confirm"

    elif state == "add_vote_confirm":
        if text == "โ ุชุงุฏ":
            title = user_data[user_id]["place_title"]
            owner = user_data[user_id]["owner_id"]
            count = user_data[user_id]["vote_count"]
            score = user_data[user_id]["vote_score"]
            # ุงูุฌุง ุชุงุจุน update_votes ุจุงุฏ ูพุงุฏู ุดูุฏ
            update_votes(title, owner, count, score, add=True)
            bot.send_message(user_id, f"{EMOJIS['success']} ุฑุงโูุง ุงุถุงูู ุดุฏูุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
        else:
            bot.send_message(user_id, "ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"

    # ฺฉู ฺฉุฑุฏู ุฑุง
    elif state == "remove_vote_place_title":
        user_data[user_id] = {"place_title": text.strip()}
        bot.send_message(user_id, "ุดูุงุณู ุนุฏุฏ ุฑูุฏูู ุตุงุญุจ ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "remove_vote_place_owner"

    elif state == "remove_vote_place_owner":
        user_data[user_id]["owner_id"] = text.strip()
        bot.send_message(user_id, "ุชุนุฏุงุฏ ุฑุงโูุง ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "remove_vote_count"

    elif state == "remove_vote_count":
        user_data[user_id]["vote_count"] = int(text.strip())
        bot.send_message(user_id, "ุงูุชุงุฒ ูุฑ ุฑุง ุฑุง ูุงุฑุฏ ฺฉูุฏ (ฐ ุชุง ฑฐ - ุดูุงุฑู ุจู ุงูฺฏูุณ):")
        user_states[user_id] = "remove_vote_score"

    elif state == "remove_vote_score":
        user_data[user_id]["vote_score"] = float(text.strip())
        keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
        keyboard.row("โ ุชุงุฏ", f"{EMOJIS['back']} ุจุฑฺฏุดุช")
        bot.send_message(user_id, "ุขุง ุงุฒ ฺฉู ฺฉุฑุฏู ุงู ุฑุง ูุทูุฆู ูุณุชุฏุ", reply_markup=keyboard)
        user_states[user_id] = "remove_vote_confirm"

    elif state == "remove_vote_confirm":
        if text == "โ ุชุงุฏ":
            title = user_data[user_id]["place_title"]
            owner = user_data[user_id]["owner_id"]
            count = user_data[user_id]["vote_count"]
            score = user_data[user_id]["vote_score"]
            # ุงูุฌุง ุชุงุจุน update_votes ุจุงุฏ ูพุงุฏู ุดูุฏ
            update_votes(title, owner, count, score, add=False)
            bot.send_message(user_id, f"{EMOJIS['success']} ุฑุงโูุง ฺฉู ุดุฏูุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
        else:
            bot.send_message(user_id, "ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"

    elif state == "profile_menu":
        if text == "ูุดุงูุฏู ูพุฑููุงู":
            user = get_user(user_id)
            if user:
                profile_msg = f"{EMOJIS['profile']} ูพุฑููุงู ุดูุง:\n"
                profile_msg += f"ูุงู: {user[1]}\nุณู: {user[2]}\nุฌูุณุช: {user[3]}\nุงูุชุงุฒ: {user[4]}\nุดูุงุณู: {user[5]}"
                bot.send_message(user_id, profile_msg, reply_markup=profile_menu())
                user_states[user_id] = "profile_menu"
        elif text == "ุชุบุฑ ูุงู":
            bot.send_message(user_id, f"{EMOJIS['edit']} ูุงู ุฌุฏุฏ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "profile_edit_name"
        elif text == "ุชุบุฑ ุณู":
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for i in range(13, 71, 10):
                row = [str(x) for x in range(i, min(i+10, 71))]
                keyboard.row(*row)
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, f"{EMOJIS['edit']} ุณู ุฌุฏุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "profile_edit_age"
        elif text == "ุชุบุฑ ุฌูุณุช":
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            keyboard.row("๐ฆ ูพุณุฑ", "๐ง ุฏุฎุชุฑ", "๐ ุฏฺฏุฑ")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, f"{EMOJIS['edit']} ุฌูุณุช ุฌุฏุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "profile_edit_gender"
    elif state == "profile_edit_name":
        if text.strip():
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE users SET name = ? WHERE user_id = ?", (text, user_id))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ูุงู ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=profile_menu())
            user_states[user_id] = "profile_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")
    elif state == "profile_edit_age":
        try:
            age = int(text)
            if 13 <= age <= 70:
                conn = sqlite3.connect(DB_NAME)
                c = conn.cursor()
                c.execute("UPDATE users SET age = ? WHERE user_id = ?", (age, user_id))
                conn.commit()
                conn.close()
                bot.send_message(user_id, f"{EMOJIS['success']} ุณู ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=profile_menu())
                user_states[user_id] = "profile_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุณู ุจู 13 ุชุง 70 ุจุงุดุฏ!")
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!")
    elif state == "profile_edit_gender":
        if text in ["๐ฆ ูพุณุฑ", "๐ง ุฏุฎุชุฑ", "๐ ุฏฺฏุฑ"]:
            gender = text.split()[1] if " " in text else text
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE users SET gender = ? WHERE user_id = ?", (gender, user_id))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุฌูุณุช ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=profile_menu())
            user_states[user_id] = "profile_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ฺฉ ุงุฒ ฺฏุฒููโูุง ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ!")
    elif state == "place_menu":
        if text == f"{EMOJIS['add']} ุงุถุงูู ฺฉุฑุฏู ูฺฉุงู":
            if user_id == ADMIN_ID:
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                for cat in PLACE_CATEGORIES:
                    keyboard.row(f"๐ {cat}")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
                bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฏุณุชู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
                user_states[user_id] = "place_add_category"
            else:
                bot.send_message(user_id, f"{EMOJIS['info']} ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ูฺฉุงู ู ููุงููฺฏ ุจู ุงุฏูู ฺฏููโููุง ูพุงู ุฏูุฏ: @Sedayegoyom10", reply_markup=get_place_menu())
                user_states[user_id] = "place_menu"
        elif text == f"{EMOJIS['view']} ูุดุงูุฏู ูฺฉุงูโูุง":
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for cat in PLACE_CATEGORIES:
                keyboard.row(f"๐ {cat}")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฏุณุชู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "place_view_category"
        elif text == f"{EMOJIS['view']} ูฺฉุงูโูุง ูู":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT places.*, users.numeric_id FROM places JOIN users ON places.user_id = users.user_id WHERE places.user_id = ? ORDER BY (places.rating_sum * 1.0 / NULLIF(places.rating_count, 0)) DESC, places.place_id DESC", (user_id,))
            places = c.fetchall()
            conn.close()
            if places:
                for place in places:
                    if place[8]:
                        try:
                            bot.send_photo(user_id, place[8])
                        except:
                            pass
                    avg_rating = (place[11] / place[12]) if place[12] > 0 else 0
                    msg = f"{EMOJIS['places']} ูฺฉุงู ุดูุง:\n"
                    msg += f"ุนููุงู: {place[4]}\nุฏุณุชู: {place[2]}\nุฒุฑุฏุณุชู: {place[3] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุชูุถุญุงุช: {place[5]}\n"
                    msg += f"ุขุฏุฑุณ: {place[6]}\n"
                    msg += f"ุชูุงุณ: {place[7] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุดูุช ุตุจุญ: {place[9] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุดูุช ุนุตุฑ: {place[10] or 'ูุดุฎุต ูุดุฏู'}\n"
                    msg += f"ุงูุชุงุฒ: {avg_rating:.1f} ({place[12]} ุฑุง)"
                    # ููุงุด ุดูุงุณู ุนุฏุฏ ูุงูฺฉ ููุท ุจุฑุง ุงุฏูู
                    if user_id == ADMIN_ID:
                        msg += f"\nุดูุงุณู ุนุฏุฏ ูุงูฺฉ: {place[13]}"
                    keyboard = types.InlineKeyboardMarkup()
                    if user_id == ADMIN_ID:
                        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['delete']} ุญุฐู", callback_data=f"delete_place_{place[0]}"))
                        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['edit']} ูุฑุงุด", callback_data=f"edit_place_{place[0]}"))
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['rating']} ุงูุชุงุฒ", callback_data=f"rate_place_{place[0]}"))
                    bot.send_message(user_id, msg, reply_markup=keyboard)
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ูฺฉุงู ูุฏุงุฑุฏ!")
            bot.send_message(user_id, "ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=get_place_menu())
            user_states[user_id] = "place_my_places"
        elif text == f"{EMOJIS['view']} ุฌุณุชุฌู":
            bot.send_message(user_id, f"{EMOJIS['places']} ููุน ุฌุณุชุฌู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=search_type_menu())
            user_states[user_id] = "search_type"
    elif state == "search_type":
        if text == "ูุบุงุฒู ูุง ุขุฏุฑุณ ููุฑุฏ ูุธุฑ":
            bot.send_message(user_id, "ุขุฏุฑุณ ููุฑุฏ ูุธุฑ ุง ูุญุฏูุฏู ุฏูุฎูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "search_by_address"
        elif text == "ุฌุณุชุฌู ูุบุงุฒู ููุฑุฏ ูุธุฑ":
            bot.send_message(user_id, "ูุงู ูฺฉุงู ููุฑุฏ ูุธุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู ุณููพุฑุ ูุงูพุฑ ูุงุฑฺฉุชุ ูพูุดุงฺฉ):", reply_markup=back_button_only())
            user_states[user_id] = "search_by_name"
            user_data[user_id] = {}
    elif state == "search_by_address":
        address_query = text.lower()
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("SELECT places.*, users.numeric_id FROM places JOIN users ON places.user_id = users.user_id WHERE LOWER(address) LIKE ?", (f"%{address_query}%",))
        places = c.fetchall()
        conn.close()
        if places:
            for place in places:
                if place[8]:
                    try:
                        bot.send_photo(user_id, place[8])
                    except:
                        pass
                avg_rating = (place[11] / place[12]) if place[12] > 0 else 0
                msg = f"{EMOJIS['places']} ูฺฉุงู ุงูุช ุดุฏู:\n"
                msg += f"ุนููุงู: {place[4]}\nุฏุณุชู: {place[2]}\nุฒุฑุฏุณุชู: {place[3] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุชูุถุญุงุช: {place[5]}\n"
                msg += f"ุขุฏุฑุณ: {place[6]}\n"
                msg += f"ุชูุงุณ: {place[7] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุดูุช ุตุจุญ: {place[9] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุดูุช ุนุตุฑ: {place[10] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุงูุชุงุฒ: {avg_rating:.1f} ({place[12]} ุฑุง)\n"
                msg += f"ุดูุงุณู ุนุฏุฏ ุตุงุญุจ: {place[13]}"
                keyboard = types.InlineKeyboardMarkup()
                if user_id == ADMIN_ID:
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['delete']} ุญุฐู", callback_data=f"delete_place_{place[0]}"))
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['edit']} ูุฑุงุด", callback_data=f"edit_place_{place[0]}"))
                keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['rating']} ุงูุชุงุฒ", callback_data=f"rate_place_{place[0]}"))
                bot.send_message(user_id, msg, reply_markup=keyboard)
            bot.send_message(user_id, "ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=search_result_menu())
            user_states[user_id] = "place_search_result"
        else:
            bot.send_message(user_id, "ูฺ ูฺฉุงู ุฏุฑ ุงู ูุญุฏูุฏู ุซุจุช ูุดุฏู ุงุณุช!", reply_markup=search_result_menu())
            user_states[user_id] = "place_search_result"
    elif state == "search_by_name":
        if text.strip():
            user_data[user_id]['name_query'] = text.lower().split()
            bot.send_message(user_id, f"{EMOJIS['places']} ุขุฏุฑุณ ููุฑุฏ ูุธุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฌุณุชุฌู ุจุฏูู ุขุฏุฑุณ):", reply_markup=skip_button())
            user_states[user_id] = "search_by_name_address"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")
    elif state == "search_by_name_address":
        name_words = user_data[user_id]['name_query']
        address_query = None if text == "ุฑุฏ ฺฉุฑุฏู" else text.lower()
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        query = "SELECT places.*, users.numeric_id FROM places JOIN users ON places.user_id = users.user_id WHERE 1=1"
        params = []
        if address_query:
            query += " AND LOWER(address) LIKE ?"
            params.append(f"%{address_query}%")
        places = c.execute(query, params).fetchall()
        filtered_places = []
        for place in places:
            title_lower = place[4].lower()
            if any(word in title_lower for word in name_words):
                filtered_places.append(place)
        conn.close()
        if filtered_places:
            for place in filtered_places:
                if place[8]:
                    try:
                        bot.send_photo(user_id, place[8])
                    except:
                        pass
                avg_rating = (place[11] / place[12]) if place[12] > 0 else 0
                msg = f"{EMOJIS['places']} ูฺฉุงู ุงูุช ุดุฏู:\n"
                msg += f"ุนููุงู: {place[4]}\nุฏุณุชู: {place[2]}\nุฒุฑุฏุณุชู: {place[3] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุชูุถุญุงุช: {place[5]}\n"
                msg += f"ุขุฏุฑุณ: {place[6]}\n"
                msg += f"ุชูุงุณ: {place[7] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุดูุช ุตุจุญ: {place[9] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุดูุช ุนุตุฑ: {place[10] or 'ูุดุฎุต ูุดุฏู'}\n"
                msg += f"ุงูุชุงุฒ: {avg_rating:.1f} ({place[12]} ุฑุง)\n"
                msg += f"ุดูุงุณู ุนุฏุฏ ุตุงุญุจ: {place[13]}"
                keyboard = types.InlineKeyboardMarkup()
                if user_id == ADMIN_ID:
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['delete']} ุญุฐู", callback_data=f"delete_place_{place[0]}"))
                    keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['edit']} ูุฑุงุด", callback_data=f"edit_place_{place[0]}"))
                keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['rating']} ุงูุชุงุฒ", callback_data=f"rate_place_{place[0]}"))
                bot.send_message(user_id, msg, reply_markup=keyboard)
            bot.send_message(user_id, "ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=search_result_menu())
            user_states[user_id] = "place_search_result"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูฺฉุงู ุจุง ุงู ูุดุฎุตุงุช ุงูุช ูุดุฏ!", reply_markup=search_result_menu())
            user_states[user_id] = "place_search_result"
    elif state == "place_search_result":
        if text == "ุฌุณุชุฌู ุฏูุจุงุฑู":
            bot.send_message(user_id, f"{EMOJIS['places']} ููุน ุฌุณุชุฌู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=search_type_menu())
            user_states[user_id] = "search_type"
    elif state == "place_add_category":
        if user_id != ADMIN_ID:
            bot.send_message(user_id, f"{EMOJIS['error']} ููุท ุงุฏูู ูโุชูุงูุฏ ูฺฉุงู ุงุถุงูู ฺฉูุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
            return
        if text.startswith("๐"):
            category = text[2:]
            if category in PLACE_CATEGORIES:
                user_data[user_id] = {'category': category}
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                for sub in PLACE_CATEGORIES[category]:
                    keyboard.row(f"๐น {sub}")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
                bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฒุฑุดุงุฎู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
                user_states[user_id] = "place_add_subcategory"
    elif state == "place_add_subcategory":
        if text.startswith("๐น"):
            subcategory = text[2:]
            category = user_data[user_id].get('category', '')
            if subcategory in PLACE_CATEGORIES.get(category, []):
                user_data[user_id]['subcategory'] = subcategory
                bot.send_message(user_id, f"{EMOJIS['places']} ุนููุงู ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
                user_states[user_id] = "place_add_title"
    elif state == "place_add_title":
        if text.strip():
            user_data[user_id]['title'] = text
            bot.send_message(user_id, f"{EMOJIS['places']} ุชูุถุญุงุช ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุญุฏุงูู 10 ฺฉููู):", reply_markup=back_button_only())
            user_states[user_id] = "place_add_description"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุนููุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")
    elif state == "place_add_description":
        words = text.strip().split()
        if len(words) >= 10:
            user_data[user_id]['description'] = text
            bot.send_message(user_id, f"{EMOJIS['places']} ุขุฏุฑุณ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "place_add_address"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุชูุถุญุงุช ุจุงุฏ ุญุฏุงูู 10 ฺฉููู ุจุงุดุฏ! ({len(words)} ฺฉููู ูุงุฑุฏ ฺฉุฑุฏูโุงุฏ)")
    elif state == "place_add_address":
        if text.strip():
            user_data[user_id]['address'] = text
            bot.send_message(user_id, f"{EMOJIS['places']} ุดูุงุฑู ุชูุงุณ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจุงุฏ ุจุง 09 ุดุฑูุน ุดูุฏ ู 11 ุฑูู ุจุงุดุฏ ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
            user_states[user_id] = "place_add_phone"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุขุฏุฑุณ ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!")
    elif state == "place_add_phone":
        if text == "ุฑุฏ ฺฉุฑุฏู":
            user_data[user_id]['phone'] = None
            bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุนฺฉุณ ุจุฑุง ูฺฉุงู ุงุฑุณุงู ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "place_add_photo"
        elif re.match(r'^09\d{9}$', text):
            user_data[user_id]['phone'] = text
            bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุนฺฉุณ ุจุฑุง ูฺฉุงู ุงุฑุณุงู ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "place_add_photo"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุดูุงุฑู ููุจุงู ุจุงุฏ ุจุง 09 ุดุฑูุน ุดูุฏ ู 11 ุฑูู ุจุงุดุฏ ุง 'ุฑุฏ ฺฉุฑุฏู' ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ!")
    elif state == "place_add_photo":
        bot.send_message(user_id, f"{EMOJIS['places']} ุดูุช ุตุจุญ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซุงู: 8:00-12:00 ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
        user_states[user_id] = "place_add_morning_shift"
    elif state == "place_add_morning_shift":
        user_data[user_id]['morning_shift'] = None if text == "ุฑุฏ ฺฉุฑุฏู" else text
        bot.send_message(user_id, f"{EMOJIS['places']} ุดูุช ุนุตุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซุงู: 14:00-20:00 ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
        user_states[user_id] = "place_add_afternoon_shift"
    elif state == "place_add_afternoon_shift":
        user_data[user_id]['afternoon_shift'] = None if text == "ุฑุฏ ฺฉุฑุฏู" else text
        bot.send_message(user_id, f"{EMOJIS['places']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
        user_states[user_id] = "place_add_numeric_id"
    elif state == "place_add_numeric_id":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                user_data[user_id]['numeric_id'] = numeric_id
                target_user_id = target_user[0]
                conn = sqlite3.connect(DB_NAME)
                c = conn.cursor()
                c.execute("INSERT INTO places (user_id, category, subcategory, title, description, address, phone, photo, morning_shift, afternoon_shift) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
                          (target_user_id, user_data[user_id]['category'], user_data[user_id]['subcategory'], user_data[user_id]['title'],
                           user_data[user_id]['description'], user_data[user_id]['address'], user_data[user_id].get('phone'),
                           user_data[user_id].get('photo'), user_data[user_id]['morning_shift'], user_data[user_id]['afternoon_shift']))
                c.execute("UPDATE users SET score = score + 83 WHERE user_id = ?", (target_user_id,))
                place_id = c.lastrowid
                conn.commit()
                conn.close()
                conn = sqlite3.connect(DB_NAME)
                c = conn.cursor()
                c.execute("SELECT user_id FROM users")
                users = c.fetchall()
                conn.close()
                success_count = 0
                for user in users:
                    try:
                        bot.send_message(user[0], f"{EMOJIS['places']} ูฺฉุงู ุฌุฏุฏ ุฏุฑ ุฏุณุชู {user_data[user_id]['category']}ุ ุฒุฑุฏุณุชู {user_data[user_id]['subcategory']}:\nุนููุงู: {user_data[user_id]['title']}")
                        success_count += 1
                    except:
                        pass
                bot.send_message(user_id, f"{EMOJIS['success']} ูฺฉุงู ุจุง ููููุช  ุซุจุช ุดุฏ! ธณ ุงูุชุงุฒ ุจู ฺฉุงุฑุจุฑ ุจุง ุดูุงุณู {numeric_id} ุงุถุงูู ุดุฏ.\nุงุฑุณุงู ุจู {success_count} ฺฉุงุฑุจุฑ.", reply_markup=get_place_menu())
                user_states[user_id] = "place_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุนุฏุฏ ุงูุช ูุดุฏ!", reply_markup=get_place_menu())
                user_states[user_id] = "place_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=back_button_only())
    elif state == "place_view_category":
        if text.startswith("๐"):
            category = text[2:]
            if category in PLACE_CATEGORIES:
                user_data[user_id] = {'category': category}
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                for sub in PLACE_CATEGORIES[category]:
                    keyboard.row(f"๐น {sub}")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
                bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฒุฑุดุงุฎู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
                user_states[user_id] = "place_view_subcategory"
    elif state == "place_view_subcategory":
        if text.startswith("๐น"):
            subcategory = text[2:]
            category = user_data[user_id].get('category', '')
            if subcategory in PLACE_CATEGORIES.get(category, []):
                conn = sqlite3.connect(DB_NAME)
                c = conn.cursor()
                c.execute("SELECT places.*, users.numeric_id FROM places JOIN users ON places.user_id = users.user_id WHERE category = ? AND subcategory = ? ORDER BY (places.rating_sum * 1.0 / NULLIF(places.rating_count, 0)) DESC, places.place_id DESC", (category, subcategory))
                places = c.fetchall()
                conn.close()
                if places:
                    for place in places:
                        if place[8]:
                            try:
                                bot.send_photo(user_id, place[8])
                            except:
                                pass
                        avg_rating = (place[11] / place[12]) if place[12] > 0 else 0
                        msg = f"{EMOJIS['places']} ูฺฉุงู:\n"
                        msg += f"ุนููุงู: {place[4]}\n"
                        msg += f"ุชูุถุญุงุช: {place[5]}\n"
                        msg += f"ุขุฏุฑุณ: {place[6]}\n"
                        msg += f"ุชูุงุณ: {place[7] or 'ูุดุฎุต ูุดุฏู'}\n"
                        msg += f"ุดูุช ุตุจุญ: {place[9] or 'ูุดุฎุต ูุดุฏู'}\n"
                        msg += f"ุดูุช ุนุตุฑ: {place[10] or 'ูุดุฎุต ูุดุฏู'}\n"
                        msg += f"ุงูุชุงุฒ: {avg_rating:.1f} ({place[12]} ุฑุง)"
                        # ููุงุด ุดูุงุณู ุนุฏุฏ ูุงูฺฉ ููุท ุจุฑุง ุงุฏูู
                        if user_id == ADMIN_ID:
                            msg += f"\nุดูุงุณู ุนุฏุฏ ูุงูฺฉ: {place[13]}"
                        keyboard = types.InlineKeyboardMarkup()
                        if user_id == ADMIN_ID:
                            keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['delete']} ุญุฐู", callback_data=f"delete_place_{place[0]}"))
                            keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['edit']} ูุฑุงุด", callback_data=f"edit_place_{place[0]}"))
                        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['rating']} ุงูุชุงุฒ", callback_data=f"rate_place_{place[0]}"))
                        bot.send_message(user_id, msg, reply_markup=keyboard)
                else:
                    bot.send_message(user_id, f"{EMOJIS['error']} ูฺฉุงู ุฏุฑ ุงู ุฏุณุชู ูุฌูุฏ ูุฏุงุฑุฏ!", reply_markup=back_button_only())
                bot.send_message(user_id, "ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=place_view_result_menu())
                user_states[user_id] = "place_view_result"
    elif state == "place_view_result":
        if text == "ูุดุงูุฏู ุฏูุจุงุฑู":
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for cat in PLACE_CATEGORIES:
                keyboard.row(f"๐ {cat}")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
            bot.send_message(user_id, f"{EMOJIS['places']} ฺฉ ุฏุณุชู ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "place_view_category"
        elif text == f"{EMOJIS['back']} ุจุฑฺฏุดุช":
            user_states[user_id] = "admin_menu"
    elif text == "๐ ูุฑุงุฑฺฏุฑ ูฺฉุงู ุจุฑุชุฑ":
        keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
        keyboard.row("โฌ๏ธ ุงุถุงูู ฺฉุฑุฏู ุฑุง", "โฌ๏ธ ฺฉู ฺฉุฑุฏู ุฑุง")
        keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
        bot.send_message(user_id, "ูุฏุฑุช ูฺฉุงูโูุง ุจุฑุชุฑ:", reply_markup=keyboard)
        user_states[user_id] = "top_places_menu"

            bot.send_message(user_id, "ุจุฎุด ูฺฉุงูโูุง:", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
    elif state == "edit_place_menu":
        if text == f"{EMOJIS['edit']} ูุฑุงุด ุนููุงู":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุนููุงู ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "edit_place_title"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุชูุถุญุงุช":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุชูุถุญุงุช ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุญุฏุงูู 10 ฺฉููู):", reply_markup=back_button_only())
            user_states[user_id] = "edit_place_description"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุขุฏุฑุณ":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุขุฏุฑุณ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "edit_place_address"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุชูุงุณ":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุดูุงุฑู ุชูุงุณ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุดูุงุฑู ุจุงุฏ ุจุง 09 ุดุฑูุน ุดูุฏ ู 11 ุฑูู ุจุงุดุฏ ะธะปะธ 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
            user_states[user_id] = "edit_place_phone"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุนฺฉุณ":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุนฺฉุณ ุฌุฏุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "edit_place_photo"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุดูุช ุตุจุญ":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุดูุช ุตุจุญ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซุงู: 8:00-12:00 ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
            user_states[user_id] = "edit_place_morning_shift"
        elif text == f"{EMOJIS['edit']} ูุฑุงุด ุดูุช ุนุตุฑ":
            bot.send_message(user_id, f"{EMOJIS['edit']} ุดูุช ุนุตุฑ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซุงู: 14:00-20:00 ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
            user_states[user_id] = "edit_place_afternoon_shift"
    elif state == "edit_place_title":
        if text.strip():
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE places SET title = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุนููุงู ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุนููุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
    elif state == "edit_place_description":
        words = text.strip().split()
        if len(words) >= 10:
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE places SET description = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุชูุถุญุงุช ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุชูุถุญุงุช ุจุงุฏ ุญุฏุงูู 10 ฺฉููู ุจุงุดุฏ! ({len(words)} ฺฉููู ูุงุฑุฏ ฺฉุฑุฏูโุงุฏ)", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
    elif state == "edit_place_address":
        if text.strip():
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE places SET address = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุขุฏุฑุณ ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุขุฏุฑุณ ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
    elif state == "edit_place_phone":
        if text == "ุฑุฏ ฺฉุฑุฏู":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE places SET phone = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (None, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุดูุงุฑู ุชูุงุณ ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
        elif re.match(r'^09\d{9}$', text):
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE places SET phone = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุดูุงุฑู ุชูุงุณ ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
            user_states[user_id] = "edit_place_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุดูุงุฑู ููุจุงู ุจุงุฏ ุจุง 09 ุดุฑูุน ุดูุฏ ู 11 ุฑูู ุจุงุดุฏ ุง 'ุฑุฏ ฺฉุฑุฏู' ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
    elif state == "edit_place_morning_shift":
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("UPDATE places SET morning_shift = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", 
                  (None if text == "ุฑุฏ ฺฉุฑุฏู" else text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
        conn.commit()
        conn.close()
        bot.send_message(user_id, f"{EMOJIS['success']} ุดูุช ุตุจุญ ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
        user_states[user_id] = "edit_place_menu"
    elif state == "edit_place_afternoon_shift":
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("UPDATE places SET afternoon_shift = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", 
                  (None if text == "ุฑุฏ ฺฉุฑุฏู" else text, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
        conn.commit()
        conn.close()
        bot.send_message(user_id, f"{EMOJIS['success']} ุดูุช ุนุตุฑ ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
        user_states[user_id] = "edit_place_menu"
    elif state == "admin_menu":
        if text == "๐ฅ ฺฉุงุฑุจุฑุงู ูุนุงู":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT COUNT(*) FROM users")
            total_users = c.fetchone()[0]
            conn.close()
            msg = f"{EMOJIS['info']} ุชุนุฏุงุฏ ฺฉู ฺฉุงุฑุจุฑุงู ูุนุงู: {total_users}"
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            keyboard.row("๐ฆ ููุงุด ฺฉุงุฑุจุฑุงู ูพุณุฑ", "๐ง ููุงุด ฺฉุงุฑุจุฑุงู ุฏุฎุชุฑ")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
            bot.send_message(user_id, msg, reply_markup=keyboard)
            user_states[user_id] = "admin_view_gender"
        elif text == f"{EMOJIS['news']} ุงุฑุณุงู ุฎุจุฑ":
            bot.send_message(user_id, f"{EMOJIS['news']} ุจุฎุด ุงุฑุณุงู ุฎุจุฑ:", reply_markup=admin_news_menu())
            user_states[user_id] = "admin_news_menu"
        elif text == "๐ก๏ธ ูุฏุฑ ูฺฉุงูโูุง":
            bot.send_message(user_id, f"{EMOJIS['info']} ุนููุงู ูฺฉุงู ุฑุง ุจุฑุง ุญุฐู ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_delete_place_title"
        elif text == "๐ซ ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ูุณุฏูุฏ ฺฉุฑุฏู ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_block_user"
        elif text == "๐ ุฑูุน ูุณุฏูุฏุช":
            bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ุฑูุน ูุณุฏูุฏุช ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_unblock_user"
        elif text == f"{EMOJIS['score']} ุงูุชุงุฒ ฺฉุงุฑุจุฑุงู":
            bot.send_message(user_id, f"{EMOJIS['score']} ุจุฎุด ุงูุชุงุฒ ฺฉุงุฑุจุฑุงู:", reply_markup=admin_score_menu())
            user_states[user_id] = "admin_score_menu"
    elif state == "admin_score_menu":
        if text == f"{EMOJIS['add_score']} ุงุถุงูู ฺฉุฑุฏู ุงูุชุงุฒ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงูุชุงุฒ ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_add_score_numeric_id"
        elif text == f"{EMOJIS['remove_score']} ฺฉู ฺฉุฑุฏู ุงูุชุงุฒ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ฺฉู ฺฉุฑุฏู ุงูุชุงุฒ ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_remove_score_numeric_id"
    elif state == "admin_add_score_numeric_id":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                user_data[user_id] = {
                    'target_numeric_id': numeric_id,
                    'target_user_id': target_user[0],
                    'target_name': target_user[1],
                    'target_score': target_user[4]
                }
                bot.send_message(user_id, f"{EMOJIS['info']} ฺูุฏ ุงูุชุงุฒ ูโุฎูุงูุฏ ุจู ุงู ฺฉุงุฑุจุฑ ุงุถุงูู ฺฉูุฏุ", reply_markup=admin_sub_menu())
                user_states[user_id] = "admin_add_score_amount"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุนุฏุฏ ุงูุช ูุดุฏ!", reply_markup=admin_score_menu())
                user_states[user_id] = "admin_score_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_add_score_amount":
        try:
            score_amount = int(text)
            if score_amount > 0:
                user_data[user_id]['score_amount'] = score_amount
                
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                keyboard.row("ุจูู", "ุฎุฑ")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                
                msg = f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ {score_amount} ุงูุชุงุฒ ุจู ฺฉุงุฑุจุฑ ุฒุฑ ุงุถุงูู ฺฉูุฏุ\n\n"
                msg += f"๐ค ูุงู: {user_data[user_id]['target_name']}\n"
                msg += f"๐ ุงูุชุงุฒ ูุนู: {user_data[user_id]['target_score']}\n"
                msg += f"โ ุงูุชุงุฒ ุฌุฏุฏ: {user_data[user_id]['target_score'] + score_amount}"
                
                bot.send_message(user_id, msg, reply_markup=keyboard)
                user_states[user_id] = "admin_add_score_confirm"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุชุนุฏุงุฏ ุงูุชุงุฒ ุจุงุฏ ุจุดุชุฑ ุงุฒ ุตูุฑ ุจุงุดุฏ!", reply_markup=admin_sub_menu())
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_add_score_confirm":
        if text == "ุจูู":
            target_user_id = user_data[user_id]['target_user_id']
            score_amount = user_data[user_id]['score_amount']
            
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE users SET score = score + ? WHERE user_id = ?", (score_amount, target_user_id))
            conn.commit()
            conn.close()
            
            bot.send_message(user_id, f"{EMOJIS['success']} {score_amount} ุงูุชุงุฒ ุจุง ููููุช ุจู ฺฉุงุฑุจุฑ ุงุถุงูู ุดุฏ!", reply_markup=admin_menu())
            
            # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ
            try:
                bot.send_message(target_user_id, f"{EMOJIS['success']} ุงุฏูู {score_amount} ุงูุชุงุฒ ุจู ุดูุง ุงุถุงูู ฺฉุฑุฏ! ๐\nุงูุชุงุฒ ุฌุฏุฏ ุดูุง: {user_data[user_id]['target_score'] + score_amount}")
            except:
                pass
            
            user_states[user_id] = "admin_menu"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุนููุงุช ูุบู ุดุฏ.", reply_markup=admin_score_menu())
            user_states[user_id] = "admin_score_menu"
    elif state == "admin_remove_score_numeric_id":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                user_data[user_id] = {
                    'target_numeric_id': numeric_id,
                    'target_user_id': target_user[0],
                    'target_name': target_user[1],
                    'target_score': target_user[4]
                }
                bot.send_message(user_id, f"{EMOJIS['info']} ฺูุฏ ุงูุชุงุฒ ูโุฎูุงูุฏ ุงุฒ ุงู ฺฉุงุฑุจุฑ ฺฉู ฺฉูุฏุ", reply_markup=admin_sub_menu())
                user_states[user_id] = "admin_remove_score_amount"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุนุฏุฏ ุงูุช ูุดุฏ!", reply_markup=admin_score_menu())
                user_states[user_id] = "admin_score_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_remove_score_amount":
        try:
            score_amount = int(text)
            if score_amount > 0:
                if score_amount <= user_data[user_id]['target_score']:
                    user_data[user_id]['score_amount'] = score_amount
                    
                    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                    keyboard.row("ุจูู", "ุฎุฑ")
                    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                    
                    msg = f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ {score_amount} ุงูุชุงุฒ ุงุฒ ฺฉุงุฑุจุฑ ุฒุฑ ฺฉู ฺฉูุฏุ\n\n"
                    msg += f"๐ค ูุงู: {user_data[user_id]['target_name']}\n"
                    msg += f"๐ ุงูุชุงุฒ ูุนู: {user_data[user_id]['target_score']}\n"
                    msg += f"โ ุงูุชุงุฒ ุฌุฏุฏ: {user_data[user_id]['target_score'] - score_amount}"
                    
                    bot.send_message(user_id, msg, reply_markup=keyboard)
                    user_states[user_id] = "admin_remove_score_confirm"
                else:
                    bot.send_message(user_id, f"{EMOJIS['error']} ุชุนุฏุงุฏ ุงูุชุงุฒ ุจุฑุง ฺฉู ฺฉุฑุฏู ุจุดุชุฑ ุงุฒ ุงูุชุงุฒ ูุนู ฺฉุงุฑุจุฑ ุงุณุช!", reply_markup=admin_sub_menu())
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุชุนุฏุงุฏ ุงูุชุงุฒ ุจุงุฏ ุจุดุชุฑ ุงุฒ ุตูุฑ ุจุงุดุฏ!", reply_markup=admin_sub_menu())
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_remove_score_confirm":
        if text == "ุจูู":
            target_user_id = user_data[user_id]['target_user_id']
            score_amount = user_data[user_id]['score_amount']
            
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("UPDATE users SET score = score - ? WHERE user_id = ?", (score_amount, target_user_id))
            conn.commit()
            conn.close()
            
            bot.send_message(user_id, f"{EMOJIS['success']} {score_amount} ุงูุชุงุฒ ุจุง ููููุช ุงุฒ ฺฉุงุฑุจุฑ ฺฉู ุดุฏ!", reply_markup=admin_menu())
            
            # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ
            try:
                bot.send_message(target_user_id, f"{EMOJIS['warning']} ุงุฏูู {score_amount} ุงูุชุงุฒ ุงุฒ ุดูุง ฺฉู ฺฉุฑุฏ! โ๏ธ\nุงูุชุงุฒ ุฌุฏุฏ ุดูุง: {user_data[user_id]['target_score'] - score_amount}")
            except:
                pass
            
            user_states[user_id] = "admin_menu"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุนููุงุช ูุบู ุดุฏ.", reply_markup=admin_score_menu())
            user_states[user_id] = "admin_score_menu"
    elif state == "admin_news_menu":
        if text == f"{EMOJIS['group']} ุงุฑุณุงู ุฎุจุฑ ฺฏุฑูู":
            bot.send_message(user_id, f"{EMOJIS['news']} ูุชู ุฎุจุฑ ฺฏุฑูู ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_news_content"
        elif text == f"{EMOJIS['user']} ุงุฑุณุงู ุฎุจุฑ ุจู ฺฉุงุฑุจุฑ":
            bot.send_message(user_id, f"{EMOJIS['news']} ูุชู ุฎุจุฑ ุฑุง ุจุฑุง ฺฉุงุฑุจุฑ ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_news_user_content"
    elif state == "admin_news_user_content":
        if text.strip():
            user_data[user_id] = {'news_user_content': text}
            bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ููุฑุฏ ูุธุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
            user_states[user_id] = "admin_news_user_numeric_id"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุชู ุฎุจุฑ ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_news_user_numeric_id":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                user_data[user_id]['target_user_numeric_id'] = numeric_id
                user_data[user_id]['target_user_id'] = target_user[0]
                user_data[user_id]['target_user_name'] = target_user[1]
                user_data[user_id]['target_user_age'] = target_user[2]
                user_data[user_id]['target_user_gender'] = target_user[3]
                
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                keyboard.row("ุจูู", "ุฎุฑ")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                
                msg = f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงู ุฎุจุฑ ุฑุง ุจุฑุง ฺฉุงุฑุจุฑ ุฒุฑ ุงุฑุณุงู ฺฉูุฏุ\n\n"
                msg += f"๐ค ูุงู: {target_user[1]}\n"
                msg += f"๐ ุณู: {target_user[2]}\n"
                msg += f"๐ซ ุฌูุณุช: {target_user[3]}\n\n"
                msg += f"๐ ุฎุจุฑ:\n{user_data[user_id]['news_user_content']}"
                
                bot.send_message(user_id, msg, reply_markup=keyboard)
                user_states[user_id] = "admin_news_user_confirm"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุนุฏุฏ ุงูุช ูุดุฏ!", reply_markup=admin_news_menu())
                user_states[user_id] = "admin_news_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_news_user_confirm":
        if text == "ุจูู":
            news_content = user_data[user_id]['news_user_content']
            target_user_id = user_data[user_id]['target_user_id']
            
            try:
                bot.send_message(target_user_id, f"{EMOJIS['news']} ุฎุจุฑ ูฺู ุจุฑุง ุดูุง:\n\n{news_content}")
                bot.send_message(user_id, f"{EMOJIS['success']} ุฎุจุฑ ุจุง ููููุช ุจุฑุง ฺฉุงุฑุจุฑ ุงุฑุณุงู ุดุฏ!", reply_markup=admin_menu())
            except Exception as e:
                bot.send_message(user_id, f"{EMOJIS['error']} ุฎุทุง ุฏุฑ ุงุฑุณุงู ุฎุจุฑ: {str(e)}", reply_markup=admin_menu())
            
            user_states[user_id] = "admin_menu"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุงุฑุณุงู ุฎุจุฑ ูุบู ุดุฏ.", reply_markup=admin_news_menu())
            user_states[user_id] = "admin_news_menu"
    elif state == "admin_view_gender":
        if text == "๐ฆ ููุงุด ฺฉุงุฑุจุฑุงู ูพุณุฑ":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT user_id, name, age, score, numeric_id FROM users WHERE gender = 'ูพุณุฑ'")
            users = c.fetchall()
            conn.close()
            if users:
                msg = f"{EMOJIS['info']} ฺฉุงุฑุจุฑุงู ูพุณุฑ:\n\n"
                msg += "\n".join([f"ูุงู: {u[1]}\nุณู: {u[2]}\nุงูุชุงุฒ: {u[3]}\nุดูุงุณู ุนุฏุฏ: {u[4]}\nุขุฏ ุชูฺฏุฑุงู: {u[0]}\n-------------------" for u in users])
            else:
                msg = f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ูพุณุฑ ุงูุช ูุดุฏ!"
            bot.send_message(user_id, msg, reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
        elif text == "๐ง ููุงุด ฺฉุงุฑุจุฑุงู ุฏุฎุชุฑ":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT user_id, name, age, score, numeric_id FROM users WHERE gender = 'ุฏุฎุชุฑ'")
            users = c.fetchall()
            conn.close()
            if users:
                msg = f"{EMOJIS['info']} ฺฉุงุฑุจุฑุงู ุฏุฎุชุฑ:\n\n"
                msg += "\n".join([f"ูุงู: {u[1]}\nุณู: {u[2]}\nุงูุชุงุฒ: {u[3]}\nุดูุงุณู ุนุฏุฏ: {u[4]}\nุขุฏ ุชูฺฏุฑุงู: {u[0]}\n-------------------" for u in users])
            else:
                msg = f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุฏุฎุชุฑ ุงูุช ูุดุฏ!"
            bot.send_message(user_id, msg, reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "admin_block_user":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                telegram_id = target_user[0]
                username = target_user[1]
                user_data[user_id] = {'target_telegram_id': telegram_id, 'target_numeric_id': numeric_id}
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                keyboard.row("ุจูู", "ุฎุฑ")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                bot.send_message(user_id, f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ฺฉุงุฑุจุฑ {username} ุฑุง ูุณุฏูุฏ ฺฉูุฏุ", reply_markup=keyboard)
                user_states[user_id] = "admin_confirm_block"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุงูุช ูุดุฏ!", reply_markup=admin_menu())
                user_states[user_id] = "admin_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_confirm_block":
        if text == "ุจูู":
            target_telegram_id = user_data[user_id]['target_telegram_id']
            block_user(target_telegram_id)
            bot.send_message(user_id, f"{EMOJIS['success']} ฺฉุงุฑุจุฑ ูุณุฏูุฏ ุดุฏ!", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
            try:
                bot.send_message(target_telegram_id, f"{EMOJIS['error']} ุดูุง ุจู ุฏูู ููุถ ููุงูู ุงุฒ ุทุฑู ุงุฏูู ูุณุฏูุฏ ุดุฏู ุงุฏโุจุฑุง ุฑูุน ูุณุฏูุฏุช ุจุงุฏ ูุฒูู ุง ุงูุฏฺฉ ุจูพุฑุฏุงุฒุฏ โผ๏ธ ุจุฑุง ููุงููฺฏ ุจู ุงุฏ ุงุฏูู ูพุงู ุฏูุฏ: @Sedayegoyom10")
            except:
                pass
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุนููุงุช ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "admin_unblock_user":
        try:
            numeric_id = int(text)
            target_user = get_user_by_numeric_id(numeric_id)
            if target_user:
                telegram_id = target_user[0]
                username = target_user[1]
                user_data[user_id] = {'target_telegram_id': telegram_id, 'target_numeric_id': numeric_id}
                
                if is_user_blocked(telegram_id):
                    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                    keyboard.row("ุจูู", "ุฎุฑ")
                    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                    bot.send_message(user_id, f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ฺฉุงุฑุจุฑ {username} ุฑุง ุงุฒ ูุณุฏูุฏุช ุฎุงุฑุฌ ฺฉูุฏุ", reply_markup=keyboard)
                    user_states[user_id] = "admin_confirm_unblock"
                else:
                    bot.send_message(user_id, f"{EMOJIS['error']} ุงู ฺฉุงุฑุจุฑ ูุณุฏูุฏ ูุณุชโ", reply_markup=admin_menu())
                    user_states[user_id] = "admin_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุงูุช ูุดุฏ!", reply_markup=admin_menu())
                user_states[user_id] = "admin_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_confirm_unblock":
        if text == "ุจูู":
            target_telegram_id = user_data[user_id]['target_telegram_id']
            unblock_user(target_telegram_id)
            bot.send_message(user_id, f"{EMOJIS['success']} ฺฉุงุฑุจุฑ ุงุฒ ูุณุฏูุฏุช ุฎุงุฑุฌ ุดุฏ!", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
            try:
                bot.send_message(target_telegram_id, f"{EMOJIS['success']} ุดูุง ุฑูุน ูุณุฏูุฏ ุดุฏุฏ ู ุฏฺฏุฑ ูุชูุงูุฏ ุงุฒ ูุงุจูุชโูุง ุฑุจุงุช ุงุณุชูุงุฏู ฺฉูุฏ๐ฅ")
            except:
                pass
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุนููุงุช ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "admin_news_content":
        if text.strip():
            user_data[user_id] = {'news_content': text}
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            keyboard.row("ุจูู", "ุฎุฑ")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
            bot.send_message(user_id, f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงู ุฎุจุฑ ุฑุง ุงุฑุณุงู ฺฉูุฏุ\n\n{text}", reply_markup=keyboard)
            user_states[user_id] = "admin_news_confirm"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุชู ุฎุจุฑ ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_news_confirm":
        if text == "ุจูู":
            news_content = user_data[user_id]['news_content']
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("INSERT INTO news (content) VALUES (?)", (news_content,))
            c.execute("SELECT user_id FROM users")
            users = c.fetchall()
            conn.commit()
            conn.close()
            success_count = 0
            for user in users:
                try:
                    bot.send_message(user[0], f"{EMOJIS['news']} ุฎุจุฑ ุฌุฏุฏ:\n{news_content}")
                    success_count += 1
                except:
                    pass
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            keyboard.row(f"{EMOJIS['delete']} ุญุฐู ุฎุจุฑ", f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
            msg = f"{EMOJIS['success']} ุฎุจุฑ ุจุง ููููุช ุจู {success_count} ฺฉุงุฑุจุฑ ุงุฑุณุงู ุดุฏ!"
            bot.send_message(user_id, msg, reply_markup=keyboard)
            user_states[user_id] = "admin_news_sent"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุงุฑุณุงู ุฎุจุฑ ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "admin_news_sent":
        if text == f"{EMOJIS['delete']} ุญุฐู ุฎุจุฑ":
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("DELETE FROM news WHERE news_id = (SELECT MAX(news_id) FROM news)")
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ุฎุจุฑ ุญุฐู ุดุฏ!", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
        elif text == f"{EMOJIS['back']} ุจุฑฺฏุดุช":
            user_states[user_id] = "admin_menu"
    elif text == "๐ ูุฑุงุฑฺฏุฑ ูฺฉุงู ุจุฑุชุฑ":
        keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
        keyboard.row("โฌ๏ธ ุงุถุงูู ฺฉุฑุฏู ุฑุง", "โฌ๏ธ ฺฉู ฺฉุฑุฏู ุฑุง")
        keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
        bot.send_message(user_id, "ูุฏุฑุช ูฺฉุงูโูุง ุจุฑุชุฑ:", reply_markup=keyboard)
        user_states[user_id] = "top_places_menu"

            bot.send_message(user_id, f"{EMOJIS['admin']} ูพูู ุงุฏูู:", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "admin_delete_place_title":
        if text.strip():
            user_data[user_id] = {'delete_place_title': text}
            keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
            for cat in PLACE_CATEGORIES:
                keyboard.row(f"๐ {cat}")
            keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
            bot.send_message(user_id, f"{EMOJIS['places']} ุฏุณุชู ูฺฉุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
            user_states[user_id] = "admin_delete_place_category"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุนููุงู ูฺฉุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_delete_place_category":
        if text.startswith("๐"):
            category = text[2:]
            if category in PLACE_CATEGORIES:
                user_data[user_id]['delete_place_category'] = category
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                for sub in PLACE_CATEGORIES[category]:
                    keyboard.row(f"๐น {sub}")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                bot.send_message(user_id, f"{EMOJIS['places']} ุฒุฑุฏุณุชู ูฺฉุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:", reply_markup=keyboard)
                user_states[user_id] = "admin_delete_place_subcategory"
    elif state == "admin_delete_place_subcategory":
        if text.startswith("๐น"):
            subcategory = text[2:]
            category = user_data[user_id].get('delete_place_category', '')
            if subcategory in PLACE_CATEGORIES.get(category, []):
                user_data[user_id]['delete_place_subcategory'] = subcategory
                bot.send_message(user_id, f"{EMOJIS['info']} ุดูุงุณู ุนุฏุฏ ฺฉุงุฑุจุฑ ูุงูฺฉ ูฺฉุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ:", reply_markup=admin_sub_menu())
                user_states[user_id] = "admin_delete_place_user_id"
    elif state == "admin_delete_place_user_id":
        try:
            numeric_id = int(text)
            user_data[user_id]['delete_place_numeric_id'] = numeric_id
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("SELECT user_id FROM users WHERE numeric_id = ?", (numeric_id,))
            user_result = c.fetchone()
            if user_result:
                user_db_id = user_result[0]
                title = user_data[user_id]['delete_place_title']
                category = user_data[user_id]['delete_place_category']
                subcategory = user_data[user_id]['delete_place_subcategory']
                c.execute("SELECT place_id FROM places WHERE user_id = ? AND title = ? AND category = ? AND subcategory = ?",
                          (user_db_id, title, category, subcategory))
                place_result = c.fetchone()
                if place_result:
                    user_data[user_id]['delete_place_id'] = place_result[0]
                    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                    keyboard.row("ุจูู", "ุฎุฑ")
                    keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช", "ุจุฑฺฏุดุช ุจู ุงุฏูู")
                    bot.send_message(user_id, f"{EMOJIS['info']} ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงู ูฺฉุงู ุฑุง ุญุฐู ฺฉูุฏุ\nุนููุงู: {title}", reply_markup=keyboard)
                    user_states[user_id] = "admin_delete_place_confirm"
                else:
                    bot.send_message(user_id, f"{EMOJIS['error']} ูฺฉุงู ุจุง ุงู ูุดุฎุตุงุช ุงูุช ูุดุฏ!", reply_markup=admin_menu())
                    user_states[user_id] = "admin_menu"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ฺฉุงุฑุจุฑ ุจุง ุงู ุดูุงุณู ุนุฏุฏ ุงูุช ูุดุฏ!", reply_markup=admin_menu())
                user_states[user_id] = "admin_menu"
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุดูุงุณู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=admin_sub_menu())
    elif state == "admin_delete_place_confirm":
        if text == "ุจูู":
            place_id = user_data[user_id]['delete_place_id']
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            c.execute("DELETE FROM places WHERE place_id = ?", (place_id,))
            c.execute("DELETE FROM place_ratings WHERE place_id = ?", (place_id,))
            conn.commit()
            conn.close()
            bot.send_message(user_id, f"{EMOJIS['success']} ูฺฉุงู ุจุง ููููุช ุญุฐู ุดุฏ!", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุญุฐู ูฺฉุงู ูุบู ุดุฏ.", reply_markup=admin_menu())
            user_states[user_id] = "admin_menu"
    elif state == "place_rate":
        try:
            rating = int(text)
            if 0 <= rating <= 10:
                user_data[user_id]['rating'] = rating
                keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
                keyboard.row("ุจูู", "ุฎุฑ")
                keyboard.row(f"{EMOJIS['back']} ุจุฑฺฏุดุช")
                bot.send_message(user_id, f"{EMOJIS['rating']} ุขุง ุงูุชุงุฒ {rating} ุจุฑุง ุงู ูฺฉุงู ุตุญุญ ุงุณุชุ", reply_markup=keyboard)
                user_states[user_id] = "place_rate_confirm"
            else:
                bot.send_message(user_id, f"{EMOJIS['error']} ุงูุชุงุฒ ุจุงุฏ ุจู 0 ุชุง 10 ุจุงุดุฏ!", reply_markup=back_button_only())
        except ValueError:
            bot.send_message(user_id, f"{EMOJIS['error']} ูุทูุงู ุนุฏุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ!", reply_markup=back_button_only())
    elif state == "place_rate_confirm":
        if text == "ุจูู":
            place_id = user_data[user_id]['place_id']
            rating = user_data[user_id]['rating']
            conn = sqlite3.connect(DB_NAME)
            c = conn.cursor()
            # ุซุจุช ุงูุชุงุฒ
            c.execute("INSERT OR REPLACE INTO place_ratings (place_id, user_id, rating) VALUES (?, ?, ?)", (place_id, user_id, rating))
            c.execute("SELECT rating_sum, rating_count, user_id FROM places WHERE place_id = ?", (place_id,))
            current = c.fetchone()
            rating_sum = current[0] + rating if current else rating
            rating_count = current[1] + 1 if current else 1
            owner_id = current[2]
            c.execute("UPDATE places SET rating_sum = ?, rating_count = ? WHERE place_id = ?", (rating_sum, rating_count, place_id))
            # ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
            c.execute("SELECT name, age, gender FROM users WHERE user_id = ?", (user_id,))
            user_info = c.fetchone()
            conn.commit()
            conn.close()
            avg_rating = rating_sum / rating_count
            # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ
            bot.send_message(user_id, f"{EMOJIS['success']} ุงูุชุงุฒ ุดูุง ({rating}) ุซุจุช ุดุฏ! ูุงูฺฏู ุงูุชุงุฒ: {avg_rating:.1f}", reply_markup=get_place_menu())
            # ุงุฑุณุงู ูพุงู ุจู ุตุงุญุจ ูฺฉุงู
            if owner_id:
                try:
                    bot.send_message(owner_id, f"{EMOJIS['rating']} ฺฉุงุฑุจุฑ ุฌุฏุฏ ุจู ูฺฉุงู ุดูุง ุงูุชุงุฒ ุฏุงุฏ:\n"
                                              f"ูุงู: {user_info[0]}\nุณู: {user_info[1]}\nุฌูุณุช: {user_info[2]}\nุงูุชุงุฒ: {rating}")
                except:
                    pass
            user_states[user_id] = "place_menu"
        elif text == "ุฎุฑ":
            bot.send_message(user_id, f"{EMOJIS['info']} ุงูุชุงุฒุฏู ูุบู ุดุฏ. ูุทูุงู ุงูุชุงุฒ ุฌุฏุฏ ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "place_rate"

# ูุฏุฑุช ุนฺฉุณโูุง
@bot.message_handler(content_types=['photo'])
def handle_photo(message):
    user_id = message.from_user.id
    if is_user_blocked(user_id):
        bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ุจู ุฏูู ููุถ ููุงูู ุงุฒ ุทุฑู ุงุฏูู ูุณุฏูุฏ ุดุฏู ุงุฏโุจุฑุง ุฑูุน ูุณุฏูุฏุช ุจุงุฏ ูุฒูู ุง ุงูุฏฺฉ ุจูพุฑุฏุงุฒุฏ โผ๏ธ ุจุฑุง ููุงููฺฏ ุจู ุงุฏ ุงุฏูู ูพุงู ุฏูุฏ: @Sedayegoyom10")
        return
    state = user_states.get(user_id, "")
    if state == "place_add_photo":
        if user_id != ADMIN_ID:
            bot.send_message(user_id, f"{EMOJIS['error']} ููุท ุงุฏูู ูโุชูุงูุฏ ูฺฉุงู ุงุถุงูู ฺฉูุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
            return
        user_data[user_id]['photo'] = message.photo[-1].file_id
        bot.send_message(user_id, f"{EMOJIS['places']} ุดูุช ุตุจุญ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซุงู: 8:00-12:00 ุง 'ุฑุฏ ฺฉุฑุฏู' ุจุฑุง ุฎุงู ฺฉุฑุฏู):", reply_markup=skip_button())
        user_states[user_id] = "place_add_morning_shift"
    elif state == "edit_place_photo":
        photo_id = message.photo[-1].file_id
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("UPDATE places SET photo = ? WHERE place_id = ? AND (user_id = ? OR ? = ?)", (photo_id, user_data[user_id]['edit_place_id'], user_id, user_id, ADMIN_ID))
        conn.commit()
        conn.close()
        bot.send_message(user_id, f"{EMOJIS['success']} ุนฺฉุณ ูฺฉุงู ุจูโุฑูุฒุฑุณุงู ุดุฏ!", reply_markup=edit_place_menu(user_data[user_id]['edit_place_id']))
        user_states[user_id] = "edit_place_menu"

# ูุฏุฑุช ุฏฺฉููโูุง ุงููุงู
@bot.callback_query_handler(func=lambda call: True)
def callback_query(call):
    user_id = call.from_user.id
    if is_user_blocked(user_id):
        bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ุจู ุฏูู ููุถ ููุงูู ุงุฒ ุทุฑู ุงุฏูู ูุณุฏูุฏ ุดุฏู ุงุฏโุจุฑุง ุฑูุน ูุณุฏูุฏุช ุจุงุฏ ูุฒูู ุง ุงูุฏฺฉ ุจูพุฑุฏุงุฒุฏ โผ๏ธ ุจุฑุง ููุงููฺฏ ุจู ุงุฏ ุงุฏูู ูพุงู ุฏูุฏ: @Sedayegoyom10")
        return
    data = call.data
    if data == "accept_terms":
        user = get_user(user_id)
        if user:
            bot.send_message(user_id, f"{EMOJIS['success']} ุฎูุด ุจุฑฺฏุดุช! ๐", reply_markup=main_menu(user_id))
            user_states[user_id] = "main_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['profile']} ุณูุงู! ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
            user_states[user_id] = "awaiting_name"
            user_data[user_id] = {}
    elif data == "decline_terms":
        keyboard = types.InlineKeyboardMarkup()
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['info']} ุฏุฑุฎูุงุณุช ุฏูุจุงุฑู", callback_data="retry_terms"))
        bot.send_message(user_id, f"{EMOJIS['error']} ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุจุงุฏ ููุงูู ุฑุง ุจูพุฐุฑุฏ. ุฏุฑ ุตูุฑุช ุนุฏู ูพุฐุฑุดุ ูุงุฏุฑ ุจู ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุช ูุฎูุงูุฏ ุจูุฏ.", reply_markup=keyboard)
    elif data == "retry_terms":
        keyboard = types.InlineKeyboardMarkup()
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['success']} ูพุฐุฑูุชู", callback_data="accept_terms"))
        keyboard.add(types.InlineKeyboardButton(f"{EMOJIS['error']} ููพุฐุฑูุชู", callback_data="decline_terms"))
        bot.send_message(user_id, WELCOME_MESSAGE, parse_mode="Markdown", reply_markup=keyboard)
        user_states[user_id] = "awaiting_terms"
    elif data.startswith("delete_place"):
        place_id = int(data.split("_")[2])
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("SELECT user_id FROM places WHERE place_id = ?", (place_id,))
        place = c.fetchone()
        if place and (place[0] == user_id or user_id == ADMIN_ID):
            c.execute("DELETE FROM places WHERE place_id = ?", (place_id,))
            c.execute("DELETE FROM place_ratings WHERE place_id = ?", (place_id,))
            conn.commit()
            bot.send_message(user_id, f"{EMOJIS['success']} ูฺฉุงู ุญุฐู ุดุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
        else:
            bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ูุฌุงุฒ ุจู ุญุฐู ุงู ูฺฉุงู ูุณุชุฏ!", reply_markup=get_place_menu())
        conn.close()
    elif data.startswith("edit_place"):
        place_id = int(data.split("_")[2])
        user_data[user_id] = {'edit_place_id': place_id}
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("SELECT * FROM places WHERE place_id = ? AND (user_id = ? OR ? = ?)", (place_id, user_id, user_id, ADMIN_ID))
        place = c.fetchone()
        conn.close()
        if place:
            keyboard = edit_place_menu(place_id)
            msg = f"{EMOJIS['edit']} ฺฉุฏุงู ุจุฎุด ุฑุง ูโุฎูุงูุฏ ูุฑุงุด ฺฉูุฏุ"
            bot.send_message(user_id, msg, reply_markup=keyboard)
            user_states[user_id] = "edit_place_menu"
    elif data.startswith("rate_place"):
        place_id = int(data.split("_")[2])
        conn = sqlite3.connect(DB_NAME)
        c = conn.cursor()
        c.execute("SELECT rating FROM place_ratings WHERE place_id = ? AND user_id = ?", (place_id, user_id))
        existing_rating = c.fetchone()
        conn.close()
        if existing_rating:
            bot.send_message(user_id, f"{EMOJIS['error']} ุดูุง ูุจูุงู ุจู ุงู ูฺฉุงู ุงูุชุงุฒ {existing_rating[0]} ุฏุงุฏูโุงุฏ!", reply_markup=get_place_menu())
            user_states[user_id] = "place_menu"
        else:
            user_data[user_id] = {'place_id': place_id}
            bot.send_message(user_id, f"{EMOJIS['rating']} ุงูุชุงุฒ ุจู 0 ุชุง 10 ุจุฑุง ุงู ูฺฉุงู ูุงุฑุฏ ฺฉูุฏ:", reply_markup=back_button_only())
            user_states[user_id] = "place_rate"

# ุงุฌุฑุง ุฑุจุงุช ุฏุฑ ุญุงูุช ูุจ ููฺฉ
if __name__ == "__main__":
    app.run(host="0.0.0.0", port=PORT)